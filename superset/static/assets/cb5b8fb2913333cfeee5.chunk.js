/*! For license information please see cb5b8fb2913333cfeee5.chunk.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[53,13],{3538:function(t,e,i){var n;!function(o,s,r){if(o){for(var a,l={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},h={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},c={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},u={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},p=1;p<20;++p)l[111+p]="f"+p;for(p=0;p<=9;++p)l[p+96]=p.toString();y.prototype.bind=function(t,e,i){return t=t instanceof Array?t:[t],this._bindMultiple.call(this,t,e,i),this},y.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},y.prototype.trigger=function(t,e){return this._directMap[t+":"+e]&&this._directMap[t+":"+e]({},t),this},y.prototype.reset=function(){return this._callbacks={},this._directMap={},this},y.prototype.stopCallback=function(t,e){return!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&(!function t(e,i){return null!==e&&e!==s&&(e===i||t(e.parentNode,i))}(e,this.target)&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable))},y.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},y.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(l[e]=t[e]);a=null},y.init=function(){var t=y(s);for(var e in t)"_"!==e.charAt(0)&&(y[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},y.init(),o.Mousetrap=y,t.exports&&(t.exports=y),void 0===(n=function(){return y}.call(e,i,e,t))||(t.exports=n)}function d(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)}function f(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return l[t.which]?l[t.which]:h[t.which]?h[t.which]:String.fromCharCode(t.which).toLowerCase()}function v(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function g(t,e,i){return i||(i=function(){if(!a)for(var t in a={},l)t>95&&t<112||l.hasOwnProperty(t)&&(a[l[t]]=t);return a}()[t]?"keydown":"keypress"),"keypress"==i&&e.length&&(i="keydown"),i}function m(t,e){var i,n,o,s=[];for(i=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),o=0;o<i.length;++o)n=i[o],u[n]&&(n=u[n]),e&&"keypress"!=e&&c[n]&&(n=c[n],s.push("shift")),v(n)&&s.push(n);return{key:n,modifiers:s,action:e=g(n,s,e)}}function y(t){var e=this;if(t=t||s,!(e instanceof y))return new y(t);e.target=t,e._callbacks={},e._directMap={};var i,n={},o=!1,r=!1,a=!1;function l(t){t=t||{};var e,i=!1;for(e in n)t[e]?i=!0:n[e]=0;i||(a=!1)}function h(t,i,o,s,r,a){var l,h,c,u,p=[],d=o.type;if(!e._callbacks[t])return[];for("keyup"==d&&v(t)&&(i=[t]),l=0;l<e._callbacks[t].length;++l)if(h=e._callbacks[t][l],(s||!h.seq||n[h.seq]==h.level)&&d==h.action&&("keypress"==d&&!o.metaKey&&!o.ctrlKey||(c=i,u=h.modifiers,c.sort().join(",")===u.sort().join(",")))){var f=!s&&h.combo==r,g=s&&h.seq==s&&h.level==a;(f||g)&&e._callbacks[t].splice(l,1),p.push(h)}return p}function c(t,i,n,o){e.stopCallback(i,i.target||i.srcElement,n,o)||!1===t(i,n)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(i),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(i))}function u(t){"number"!=typeof t.which&&(t.which=t.keyCode);var i=f(t);i&&("keyup"!=t.type||o!==i?e.handleKey(i,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):o=!1)}function p(t,e,s,r){function h(e){return function(){a=e,++n[t],clearTimeout(i),i=setTimeout(l,1e3)}}function u(e){c(s,e,t),"keyup"!==r&&(o=f(e)),setTimeout(l,10)}n[t]=0;for(var p=0;p<e.length;++p){var d=p+1===e.length?u:h(r||m(e[p+1]).action);g(e[p],d,r,t,p)}}function g(t,i,n,o,s){e._directMap[t+":"+n]=i;var r,a=(t=t.replace(/\s+/g," ")).split(" ");a.length>1?p(t,a,i,n):(r=m(t,n),e._callbacks[r.key]=e._callbacks[r.key]||[],h(r.key,r.modifiers,{type:r.action},o,t,s),e._callbacks[r.key][o?"unshift":"push"]({callback:i,modifiers:r.modifiers,action:r.action,seq:o,level:s,combo:t}))}e._handleKey=function(t,e,i){var n,o=h(t,e,i),s={},u=0,p=!1;for(n=0;n<o.length;++n)o[n].seq&&(u=Math.max(u,o[n].level));for(n=0;n<o.length;++n)if(o[n].seq){if(o[n].level!=u)continue;p=!0,s[o[n].seq]=1,c(o[n].callback,i,o[n].combo,o[n].seq)}else p||c(o[n].callback,i,o[n].combo);var d="keypress"==i.type&&r;i.type!=a||v(t)||d||l(s),r=p&&"keydown"==i.type},e._bindMultiple=function(t,e,i){for(var n=0;n<t.length;++n)g(t[n],e,i)},d(t,"keypress",u),d(t,"keydown",u),d(t,"keyup",u)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},4302:function(t,e,i){"use strict";i.d(e,"a",(function(){return F}));var n=i(20),o=i(14),s=i(23),r=i(25),a=i(4331);function l(t,e){var i=a.c([],e,t);return a.b(i,i,1/i[3]),i}var h=i(4304),c=i(4292),u=i(4329);function p(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}var d=Math.PI,f=d/4,v=d/180,g=180/d;function m(t){return Math.pow(2,t)}function y(t){var e=Object(o.a)(t,2),i=e[0],n=e[1];p(Number.isFinite(i)),p(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");var s=n*v;return[512*(i*v+d)/(2*d),512*(d+Math.log(Math.tan(f+.5*s)))/(2*d)]}function b(t){var e=Object(o.a)(t,2),i=e[0],n=e[1],s=i/512*(2*d)-d,r=2*(Math.atan(Math.exp(n/512*(2*d)-d))-f);return[s*g,r*g]}function x(t){var e=t.latitude,i=t.longitude,n=t.highPrecision,o=void 0!==n&&n;p(Number.isFinite(e)&&Number.isFinite(i));var s={},r=Math.cos(e*v),a=512/360/r,l=512/4003e4/r;if(s.unitsPerMeter=[l,l,l],s.metersPerUnit=[1/l,1/l,1/l],s.unitsPerDegree=[512/360,a,l],s.degreesPerUnit=[.703125,1/a,1/l],o){var h=v*Math.tan(e*v)/r,c=512/360*h/2,u=512/4003e4*h,d=u/a*l;s.unitsPerDegree2=[0,c,u],s.unitsPerMeter2=[d,0,d]}return s}function _(t){var e=t.height,i=t.pitch,n=t.bearing,o=t.altitude,s=t.scale,r=t.center,a=void 0===r?null:r,l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return h.o(l,l,[0,0,-o]),h.k(l,l,-i*v),h.m(l,l,n*v),s/=e,h.n(l,l,[s,s,s]),a&&h.o(l,l,u.d([],a)),l}function P(t){var e=t.width,i=t.height,n=t.pitch,o=function(t){var e=t.width,i=t.height,n=t.altitude,o=void 0===n?1.5:n,s=t.pitch,r=void 0===s?0:s,a=t.nearZMultiplier,l=void 0===a?1:a,h=t.farZMultiplier,c=void 0===h?1:h,u=r*v,p=Math.atan(.5/o),d=Math.sin(p)*o/Math.sin(Math.min(Math.max(Math.PI/2-u-p,.01),Math.PI-.01));return{fov:2*p,aspect:e/i,focalDistance:o,near:l,far:(Math.sin(u)*d+o)*c}}({width:e,height:i,altitude:t.altitude,pitch:n,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),s=o.fov,r=o.aspect,a=o.near,l=o.far;return h.i([],s,r,a,l)}function w(t,e){var i=Object(o.a)(t,3),n=i[0],s=i[1],r=i[2],a=void 0===r?0:r;return p(Number.isFinite(n)&&Number.isFinite(s)&&Number.isFinite(a)),l(e,[n,s,a,1])}function k(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Object(o.a)(t,3),s=n[0],r=n[1],a=n[2];if(p(Number.isFinite(s)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(a)){var h=l(e,[s,r,a,1]);return h}var u=l(e,[s,r,0,1]),d=l(e,[s,r,1,1]),f=u[2],v=d[2],g=f===v?0:((i||0)-f)/(v-f);return c.d([],u,d,g)}function C(t){var e=t.width,i=t.height,n=t.bounds,s=t.minExtent,r=void 0===s?0:s,a=t.maxZoom,l=void 0===a?24:a,h=t.padding,c=void 0===h?0:h,u=t.offset,d=void 0===u?[0,0]:u,f=Object(o.a)(n,2),v=Object(o.a)(f[0],2),g=v[0],m=v[1],y=Object(o.a)(f[1],2),b=y[0],x=y[1];if(Number.isFinite(c)){c={top:c,bottom:c,left:c,right:c}}else p(Number.isFinite(c.top)&&Number.isFinite(c.bottom)&&Number.isFinite(c.left)&&Number.isFinite(c.right));var _=new S({width:e,height:i,longitude:0,latitude:0,zoom:0}),P=_.project([g,x]),w=_.project([b,m]),k=[Math.max(Math.abs(w[0]-P[0]),r),Math.max(Math.abs(w[1]-P[1]),r)],C=[e-c.left-c.right-2*Math.abs(d[0]),i-c.top-c.bottom-2*Math.abs(d[1])];p(C[0]>0&&C[1]>0);var L=C[0]/k[0],E=C[1]/k[1],M=(c.right-c.left)/2/L,A=(c.bottom-c.top)/2/E,j=[(w[0]+P[0])/2+M,(w[1]+P[1])/2+A],O=_.unproject(j),T=Math.min(l,_.zoom+Math.log2(Math.abs(Math.min(L,E))));return p(Number.isFinite(T)),{longitude:O[0],latitude:O[1],zoom:T}}var L=Math.PI/180;function E(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t.width,s=t.height,r=t.unproject,a={targetZ:n},l=r([0,s],a),h=r([o,s],a),c=Math.atan(.5/t.altitude),u=(90-t.pitch)*L;return c>u-.01?(e=M(t,0,n),i=M(t,o,n)):(e=r([0,0],a),i=r([o,0],a)),[l,h,i,e]}function M(t,e,i){var n=t.pixelUnprojectionMatrix,o=l(n,[e,0,1,1]),s=l(n,[e,t.height,1,1]),r=(i*t.distanceScales.unitsPerMeter[2]-o[2])/(s[2]-o[2]),a=b(c.d([],o,s,r));return a[2]=i,a}var S=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1},i=e.width,n=e.height,o=e.latitude,r=void 0===o?0:o,a=e.longitude,l=void 0===a?0:a,h=e.zoom,c=void 0===h?0:h,u=e.pitch,p=void 0===u?0:u,d=e.bearing,f=void 0===d?0:d,v=e.altitude,g=void 0===v?1.5:v,b=e.nearZMultiplier,w=void 0===b?.02:b,k=e.farZMultiplier,C=void 0===k?1.01:k;Object(s.a)(this,t),i=i||1,n=n||1;var L=m(c);g=Math.max(.75,g);var E=y([l,r]);E[2]=0,this.projectionMatrix=P({width:i,height:n,pitch:p,altitude:g,nearZMultiplier:w,farZMultiplier:C}),this.viewMatrix=_({height:n,scale:L,center:E,pitch:p,bearing:f,altitude:g}),this.width=i,this.height=n,this.scale=L,this.latitude=r,this.longitude=l,this.zoom=c,this.pitch=p,this.bearing=f,this.altitude=g,this.center=E,this.distanceScales=x(this),this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}return Object(r.a)(t,[{key:"_initMatrices",value:function(){var t=this.width,e=this.height,i=this.projectionMatrix,n=this.viewMatrix,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];h.g(o,o,i),h.g(o,o,n),this.viewProjectionMatrix=o;var s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];h.n(s,s,[t/2,-e/2,1]),h.o(s,s,[1,-1,0]),h.g(s,s,o);var r=h.e([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s);if(!r)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=s,this.pixelUnprojectionMatrix=r}},{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&h.b(e.projectionMatrix,this.projectionMatrix)&&h.b(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.topLeft,n=void 0===i||i,s=this.projectPosition(t),r=w(s,this.pixelProjectionMatrix),a=Object(o.a)(r,2),l=a[0],h=a[1],c=n?h:this.height-h;return 2===t.length?[l,c]:[l,c,r[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.topLeft,n=void 0===i||i,s=e.targetZ,r=void 0===s?void 0:s,a=Object(o.a)(t,3),l=a[0],h=a[1],c=a[2],u=n?h:this.height-h,p=r&&r*this.distanceScales.unitsPerMeter[2],d=k([l,u,c],this.pixelUnprojectionMatrix,p),f=this.unprojectPosition(d),v=Object(o.a)(f,3),g=v[0],m=v[1],y=v[2];return Number.isFinite(c)?[g,m,y]:Number.isFinite(r)?[g,m,r]:[g,m]}},{key:"projectPosition",value:function(t){var e=y(t),i=Object(o.a)(e,2);return[i[0],i[1],(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:"unprojectPosition",value:function(t){var e=b(t),i=Object(o.a)(e,2);return[i[0],i[1],(t[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:"projectFlat",value:function(t){return y(t)}},{key:"unprojectFlat",value:function(t){return b(t)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,i=k(t.pos,this.pixelUnprojectionMatrix),n=y(e),o=c.a([],n,c.e([],i));return b(c.a([],this.center,o))}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,i=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:i})}},{key:"fitBounds",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.width,o=this.height,s=C(Object.assign({width:n,height:o,bounds:e},i)),r=s.longitude,a=s.latitude,l=s.zoom;return new t({width:n,height:o,longitude:r,latitude:a,zoom:l})}},{key:"getBounds",value:function(t){var e=this.getBoundingRegion(t),i=Math.min.apply(Math,Object(n.a)(e.map((function(t){return t[0]})))),o=Math.max.apply(Math,Object(n.a)(e.map((function(t){return t[0]}))));return[[i,Math.min.apply(Math,Object(n.a)(e.map((function(t){return t[1]}))))],[o,Math.max.apply(Math,Object(n.a)(e.map((function(t){return t[1]}))))]]}},{key:"getBoundingRegion",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return E(this,t.z||0)}}]),t}();var A=i(586);const j=[-90,90],O=[-180,180];function T(t,e,i){let[n,o]=t,[s,r]=e;return void 0===i&&(i=.25),n<o?[n,o]:[Math.max(s,n-i),Math.min(r,o+i)]}function N(){return(N=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function F(t,e){let{points:i,width:n,height:o,minExtent:s,maxZoom:r,offset:a,padding:l=20}=e;const{bearing:h,pitch:c}=t,u=function(t){const e=T(Object(A.extent)(t,t=>t[1]),j),i=T(Object(A.extent)(t,t=>t[0]),O);return[[i[0],e[0]],[i[1],e[1]]]}(i);try{return N({},C({bounds:u,width:n,height:o,minExtent:s,maxZoom:r,offset:a,padding:l}),{bearing:h,pitch:c})}catch(t){console.error("Could not fit viewport",t)}return t}},4314:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(13),o=i.n(n);const s=[1,0,1,0,0,0,0];function r(t,e){const i=parseInt(o()(e).format("x"),10);return parseInt(o()(e).add(t).format("x"),10)-i}function a(t,e){const i=o()(Math.min(...t)),n=o()(Math.max(...t));let a,l,h;if(e.includes("/")){const t=e.split("/",2);t[0].endsWith("Z")?(l=o()(t[0]),a=o.a.duration(t[1])):(l=o()(t[1]),a=o.a.duration(t[0]))}else a=o.a.duration(e),l=function(t,e){const i=o()(t).subtract(e),n=t.toArray(),r=i.toArray(),a=n.map((t,e)=>r[e]!==t).indexOf(!0),l=n.map((t,e)=>{if(e===a){const i=t-r[e];return t-(t-s[e])%i}return e<a||-1===a?t:s[e]});return o()(l)}(i,a);const c=i.valueOf();for(h=l.clone();h.valueOf()<c;)h.add(a);for(;h.valueOf()>c;)h.subtract(a);let u;const p=n.valueOf();for(u=l.clone();u.valueOf()>p;)u.subtract(a);for(;u.valueOf()<p;)u.add(a);const d=null!=e?[h,h.clone().add(a)]:[h,u],f=t.every(t=>null===t);return{start:parseInt(h.format("x"),10),end:parseInt(u.format("x"),10),getStep:r.bind(this,a),values:d.map(t=>parseInt(t.format("x"),10)),disabled:f}}},4317:function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var n=i(0),o=i.n(n),s=i(5),r=i.n(s),a=i(4316),l=i(3538),h=i.n(l),c=i(18),u=i(4321),p=i.n(u);i(4323),i(4324);function d(t){return o.a.createElement("span",{className:"BootstrapSliderWrapper"},o.a.createElement(p.a,t))}i(4325);const f={start:r.a.number.isRequired,step:r.a.number.isRequired,end:r.a.number.isRequired,values:r.a.array.isRequired,onChange:r.a.func,loopDuration:r.a.number,maxFrames:r.a.number,orientation:r.a.oneOf(["horizontal","vertical"]),reversed:r.a.bool,disabled:r.a.bool,range:r.a.bool};class v extends o.a.PureComponent{constructor(t){super(t),this.state={intervalId:null};const e=t.end-t.start,i=Math.min(t.maxFrames,e/t.step),n=e/i;this.intervalMilliseconds=t.loopDuration/i,this.increment=n<t.step?t.step:n-n%t.step,this.onChange=this.onChange.bind(this),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.stepBackward=this.stepBackward.bind(this),this.stepForward=this.stepForward.bind(this),this.getPlayClass=this.getPlayClass.bind(this),this.formatter=this.formatter.bind(this)}componentDidMount(){h.a.bind(["space"],this.play)}componentWillUnmount(){h.a.unbind(["space"])}onChange(t){this.props.onChange(t.target.value),null!=this.state.intervalId&&this.pause()}getPlayClass(){return null==this.state.intervalId?"fa fa-play fa-lg slider-button":"fa fa-pause fa-lg slider-button"}play(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{const t=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:t})}}pause(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}stepForward(){const{start:t,end:e,step:i,values:n,disabled:o}=this.props;if(o)return;const s=(Array.isArray(n)?n:[n,n+i]).map(t=>t+this.increment),r=s[1]>e?s[0]-t:0;this.props.onChange(s.map(t=>t-r))}stepBackward(){const{start:t,end:e,step:i,values:n,disabled:o}=this.props;if(o)return;const s=(Array.isArray(n)?n:[n,n+i]).map(t=>t-this.increment),r=s[0]<t?e-s[1]:0;this.props.onChange(s.map(t=>t+r))}formatter(t){if(this.props.disabled)return Object(c.e)("Data has no time steps");let e=t;return Array.isArray(t)?t[0]===t[1]&&(e=[t[0]]):e=[t],e.map(t=>new Date(t).toUTCString()).join(" : ")}render(){const{start:t,end:e,step:i,orientation:n,reversed:s,disabled:r,range:a,values:l}=this.props;return o.a.createElement("div",{className:"play-slider"},o.a.createElement("div",{className:"play-slider-controls padded"},o.a.createElement("i",{className:"fa fa-step-backward fa-lg slider-button ",onClick:this.stepBackward}),o.a.createElement("i",{className:this.getPlayClass(),onClick:this.play}),o.a.createElement("i",{className:"fa fa-step-forward fa-lg slider-button ",onClick:this.stepForward})),o.a.createElement("div",{className:"play-slider-scrobbler padded"},o.a.createElement(d,{value:a?l:l[0],range:a,formatter:this.formatter,change:this.onChange,min:t,max:e,step:i,orientation:n,reversed:s,disabled:r?"disabled":"enabled"})))}}function g(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}v.propTypes=f,v.defaultProps={onChange:()=>{},loopDuration:15e3,maxFrames:100,orientation:"horizontal",reversed:!1,disabled:!1,range:!0};const m={getLayers:r.a.func.isRequired,start:r.a.number.isRequired,end:r.a.number.isRequired,getStep:r.a.func,values:r.a.array.isRequired,aggregation:r.a.bool,disabled:r.a.bool,viewport:r.a.object.isRequired,children:r.a.node,mapStyle:r.a.string,mapboxApiAccessToken:r.a.string.isRequired,setControlValue:r.a.func,onValuesChange:r.a.func,width:r.a.number.isRequired,height:r.a.number.isRequired};class y extends o.a.PureComponent{constructor(){super(...arguments),g(this,"containerRef",o.a.createRef()),g(this,"setTooltip",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)})}render(){const{start:t,end:e,getStep:i,disabled:n,aggregation:s,children:r,getLayers:l,values:h,onValuesChange:c,viewport:u,setControlValue:p,mapStyle:d,mapboxApiAccessToken:f,height:g,width:m}=this.props,y=l(h);return o.a.createElement("div",null,o.a.createElement(a.a,{ref:this.containerRef,viewport:u,layers:y,setControlValue:p,mapStyle:d,mapboxApiAccessToken:f,bottomMargin:n?0:20,width:m,height:g}),!n&&o.a.createElement(v,{start:t,end:e,step:i(t),values:h,range:!s,onChange:c}),r)}}y.propTypes=m,y.defaultProps={aggregation:!1,disabled:!1,mapStyle:"light",setControlValue:()=>{},onValuesChange:()=>{}}},4321:function(t,e,i){var n,o,s;o=[e,i(133),i(339),i(439),i(422),i(423),i(0),i(5),i(4322)],void 0===(s="function"==typeof(n=function(t,e,i,n,o,s,r,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReactBootstrapSlider=void 0;var h=m(e),c=m(i),u=m(n),p=m(o),d=m(s),f=m(r),v=m(a),g=m(l);function m(t){return t&&t.__esModule?t:{default:t}}var y=t.ReactBootstrapSlider=function(t){function e(){var t,i,n,o;(0,c.default)(this,e);for(var s=arguments.length,r=Array(s),a=0;a<s;a++)r[a]=arguments[a];return i=n=(0,p.default)(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(r))),n.checkAndDoDisabled=function(){var t="disabled"!==n.props.disabled,e=n.mySlider.isEnabled();t?e||n.mySlider.enable():e&&n.mySlider.disable()},n.updateSliderValues=function(){void 0===n.props.min||void 0===n.mySlider.min&&void 0===n.mySlider.options.min||n.mySlider.setAttribute("min",n.props.min),void 0===n.props.max||void 0===n.mySlider.max&&void 0===n.mySlider.options.max||n.mySlider.setAttribute("max",n.props.max),void 0===n.props.step||void 0===n.mySlider.step&&void 0===n.mySlider.options.step||n.mySlider.setAttribute("step",n.props.step),n.mySlider.setValue(n.props.value),n.checkAndDoDisabled()},o=i,(0,p.default)(n,o)}return(0,d.default)(e,t),(0,u.default)(e,[{key:"componentDidMount",value:function(){var t=this,e=(0,h.default)({},this.props,{tooltip:this.props.tooltip||"show"});if(this.mySlider=new g.default(this.node,e),this.props.change||this.props.handleChange){var i=this.props.change||this.props.handleChange;this.mySlider.on("change",(function(t){var e={target:{}};e.target.value=t.newValue,i(e)}))}this.props.slideStop&&this.mySlider.on("slideStop",(function(e){var i={target:{}};i.target.value=e,t.props.slideStop(i)})),this.checkAndDoDisabled()}},{key:"componentDidUpdate",value:function(){this.updateSliderValues()}},{key:"componentWillUnmount",value:function(){this.mySlider.destroy()}},{key:"render",value:function(){var t=this;return f.default.createElement("div",{ref:function(e){return t.node=e}})}}]),e}(f.default.Component);y.propTypes={min:v.default.number,max:v.default.number,step:v.default.number,value:v.default.oneOfType([v.default.number,v.default.arrayOf(v.default.number.isRequired).isRequired]).isRequired,disabled:v.default.string,tooltip:v.default.string,change:v.default.func,handleChange:v.default.func,slideStop:v.default.func,labelledby:v.default.oneOfType([v.default.string,v.default.arrayOf(v.default.string)])},t.default=y})?n.apply(e,o):n)||(t.exports=s)},4322:function(t,e,i){"use strict";var n,o,s,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a="object"===("undefined"==typeof window?"undefined":r(window));o=[i(140)],void 0===(s="function"==typeof(n=function(t){var e;return a&&!window.console&&(window.console={}),a&&!window.console.log&&(window.console.log=function(){}),a&&!window.console.warn&&(window.console.warn=function(){}),function(t){var e=Array.prototype.slice;function i(){}!function(t){if(t){var n="undefined"==typeof console?i:function(t){console.error(t)};t.bridget=function(i,o){!function(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}(o),function(i,o){t.fn[i]=function(s){if("string"==typeof s){for(var r=e.call(arguments,1),a=0,l=this.length;a<l;a++){var h=this[a],c=t.data(h,i);if(c)if(t.isFunction(c[s])&&"_"!==s.charAt(0)){var u=c[s].apply(c,r);if(void 0!==u&&u!==c)return u}else n("no such method '"+s+"' for "+i+" instance");else n("cannot call methods on "+i+" prior to initialization; attempted to call '"+s+"'")}return this}var p=this.map((function(){var e=t.data(this,i);return e?(e.option(s),e._init()):(e=new o(this,s),t.data(this,i,e)),t(this)}));return!p||p.length>1?p:p[0]}}(i,o)},t.bridget}}(t)}(t),function(t){var i=function(t){return"Invalid input value '"+t+"' passed in"},n={linear:{toValue:function(t){var e=t/100*(this.options.max-this.options.min),i=!0;if(this.options.ticks_positions.length>0){for(var n,o,s,r=0,a=1;a<this.options.ticks_positions.length;a++)if(t<=this.options.ticks_positions[a]){n=this.options.ticks[a-1],s=this.options.ticks_positions[a-1],o=this.options.ticks[a],r=this.options.ticks_positions[a];break}e=n+(t-s)/(r-s)*(o-n),i=!1}var l=(i?this.options.min:0)+Math.round(e/this.options.step)*this.options.step;return l<this.options.min?this.options.min:l>this.options.max?this.options.max:l},toPercentage:function(t){if(this.options.max===this.options.min)return 0;if(this.options.ticks_positions.length>0){for(var e,i,n,o=0,s=0;s<this.options.ticks.length;s++)if(t<=this.options.ticks[s]){e=s>0?this.options.ticks[s-1]:0,n=s>0?this.options.ticks_positions[s-1]:0,i=this.options.ticks[s],o=this.options.ticks_positions[s];break}if(s>0)return n+(t-e)/(i-e)*(o-n)}return 100*(t-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(t){var e=0===this.options.min?0:Math.log(this.options.min),i=Math.log(this.options.max),n=Math.exp(e+(i-e)*t/100);return Math.round(n)===this.options.max?this.options.max:(n=this.options.min+Math.round((n-this.options.min)/this.options.step)*this.options.step)<this.options.min?this.options.min:n>this.options.max?this.options.max:n},toPercentage:function(t){if(this.options.max===this.options.min)return 0;var e=Math.log(this.options.max),i=0===this.options.min?0:Math.log(this.options.min);return 100*((0===t?0:Math.log(t))-i)/(e-i)}}};function o(e,i){this._state={value:null,enabled:null,offset:null,size:null,percentage:null,inDrag:!1,over:!1},this.ticksCallbackMap={},this.handleCallbackMap={},"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e),i=i||{};for(var o=Object.keys(this.defaultOptions),s=0;s<o.length;s++){var r=o[s],a=i[r];a=null!==(a=void 0!==a?a:l(this.element,r))?a:this.defaultOptions[r],this.options||(this.options={}),this.options[r]=a}function l(t,e){var i="data-slider-"+e.replace(/_/g,"-"),n=t.getAttribute(i);try{return JSON.parse(n)}catch(t){return n}}"auto"===this.options.rtl&&(this.options.rtl="rtl"===window.getComputedStyle(this.element).direction),"vertical"!==this.options.orientation||"top"!==this.options.tooltip_position&&"bottom"!==this.options.tooltip_position?"horizontal"!==this.options.orientation||"left"!==this.options.tooltip_position&&"right"!==this.options.tooltip_position||(this.options.tooltip_position="top"):this.options.rtl?this.options.tooltip_position="left":this.options.tooltip_position="right";var h,c,u,p,d,f=this.element.style.width,v=!1,g=this.element.parentNode;if(this.sliderElem)v=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var m=document.createElement("div");m.className="slider-track",(c=document.createElement("div")).className="slider-track-low",(h=document.createElement("div")).className="slider-selection",(u=document.createElement("div")).className="slider-track-high",(p=document.createElement("div")).className="slider-handle min-slider-handle",p.setAttribute("role","slider"),p.setAttribute("aria-valuemin",this.options.min),p.setAttribute("aria-valuemax",this.options.max),(d=document.createElement("div")).className="slider-handle max-slider-handle",d.setAttribute("role","slider"),d.setAttribute("aria-valuemin",this.options.min),d.setAttribute("aria-valuemax",this.options.max),m.appendChild(c),m.appendChild(h),m.appendChild(u),this.rangeHighlightElements=[];var y=this.options.rangeHighlights;if(Array.isArray(y)&&y.length>0)for(var b=0;b<y.length;b++){var x=document.createElement("div"),_=y[b].class||"";x.className="slider-rangeHighlight slider-selection "+_,this.rangeHighlightElements.push(x),m.appendChild(x)}var P=Array.isArray(this.options.labelledby);if(P&&this.options.labelledby[0]&&p.setAttribute("aria-labelledby",this.options.labelledby[0]),P&&this.options.labelledby[1]&&d.setAttribute("aria-labelledby",this.options.labelledby[1]),!P&&this.options.labelledby&&(p.setAttribute("aria-labelledby",this.options.labelledby),d.setAttribute("aria-labelledby",this.options.labelledby)),this.ticks=[],Array.isArray(this.options.ticks)&&this.options.ticks.length>0){for(this.ticksContainer=document.createElement("div"),this.ticksContainer.className="slider-tick-container",s=0;s<this.options.ticks.length;s++){var w=document.createElement("div");if(w.className="slider-tick",this.options.ticks_tooltip){var k=this._addTickListener(),C=k.addMouseEnter(this,w,s),L=k.addMouseLeave(this,w);this.ticksCallbackMap[s]={mouseEnter:C,mouseLeave:L}}this.ticks.push(w),this.ticksContainer.appendChild(w)}h.className+=" tick-slider-selection"}if(this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&this.options.ticks_labels.length>0)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",s=0;s<this.options.ticks_labels.length;s++){var E=document.createElement("div"),M=0===this.options.ticks_positions.length,S=this.options.reversed&&M?this.options.ticks_labels.length-(s+1):s;E.className="slider-tick-label",E.innerHTML=this.options.ticks_labels[S],this.tickLabels.push(E),this.tickLabelContainer.appendChild(E)}var A=function(t){var e=document.createElement("div");e.className="tooltip-arrow";var i=document.createElement("div");i.className="tooltip-inner",t.appendChild(e),t.appendChild(i)},j=document.createElement("div");j.className="tooltip tooltip-main",j.setAttribute("role","presentation"),A(j);var O=document.createElement("div");O.className="tooltip tooltip-min",O.setAttribute("role","presentation"),A(O);var T=document.createElement("div");T.className="tooltip tooltip-max",T.setAttribute("role","presentation"),A(T),this.sliderElem.appendChild(m),this.sliderElem.appendChild(j),this.sliderElem.appendChild(O),this.sliderElem.appendChild(T),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),this.ticksContainer&&this.sliderElem.appendChild(this.ticksContainer),this.sliderElem.appendChild(p),this.sliderElem.appendChild(d),g.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(t&&(this.$element=t(this.element),this.$sliderElem=t(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.touchX=0,this.touchY=0,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),n[this.options.scale]&&(this.options.scale=n[this.options.scale]),!0===v&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.sliderElem,"slider-rtl"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","right","top","width","height"].forEach((function(t){this._removeProperty(this.trackLow,t),this._removeProperty(this.trackSelection,t),this._removeProperty(this.trackHigh,t)}),this),[this.handle1,this.handle2].forEach((function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top")}),this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach((function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top"),this._removeProperty(t,"margin-left"),this._removeProperty(t,"margin-right"),this._removeProperty(t,"margin-top"),this._removeClass(t,"right"),this._removeClass(t,"left"),this._removeClass(t,"top")}),this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=f,this.options.orientation="horizontal",this.options.rtl?this.stylePos="right":this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth"),this.options.rtl&&this._addClass(this.sliderElem,"slider-rtl"),this._setTooltipPosition(),Array.isArray(this.options.ticks)&&this.options.ticks.length>0&&(this.options.max=Math.max.apply(Math,this.options.ticks),this.options.min=Math.min.apply(Math,this.options.ticks)),Array.isArray(this.options.value)?(this.options.range=!0,this._state.value=this.options.value):this.options.range?this._state.value=[this.options.value,this.options.max]:this._state.value=this.options.value,this.trackLow=c||this.trackLow,this.trackSelection=h||this.trackSelection,this.trackHigh=u||this.trackHigh,"none"===this.options.selection?(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")):"after"!==this.options.selection&&"before"!==this.options.selection||(this._removeClass(this.trackLow,"hide"),this._removeClass(this.trackSelection,"hide"),this._removeClass(this.trackHigh,"hide")),this.handle1=p||this.handle1,this.handle2=d||this.handle2,!0===v)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),s=0;s<this.ticks.length;s++)this._removeClass(this.ticks[s],"round triangle hide");if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),s=0;s<this.ticks.length;s++)this._addClass(this.ticks[s],this.options.handle);if(this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this.setValue(this._state.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchstart=this._touchstart.bind(this),this.touchmove=this._touchmove.bind(this),this.touchCapable){var N=!1;try{var F=Object.defineProperty({},"passive",{get:function(){N=!0}});window.addEventListener("test",null,F)}catch(t){}var z=!!N&&{passive:!0};this.sliderElem.addEventListener("touchstart",this.touchstart,z),this.sliderElem.addEventListener("touchmove",this.touchmove,z)}if(this.sliderElem.addEventListener("mousedown",this.mousedown,!1),this.resize=this._resize.bind(this),window.addEventListener("resize",this.resize,!1),"hide"===this.options.tooltip)this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide");else if("always"===this.options.tooltip)this._showTooltip(),this._alwaysShowTooltip=!0;else{if(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.options.ticks_tooltip){var I=this._addTickListener(),D=I.addMouseEnter(this,this.handle1),V=I.addMouseLeave(this,this.handle1);this.handleCallbackMap.handle1={mouseEnter:D,mouseLeave:V},D=I.addMouseEnter(this,this.handle2),V=I.addMouseLeave(this,this.handle2),this.handleCallbackMap.handle2={mouseEnter:D,mouseLeave:V}}else this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1);this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)}this.options.enabled?this.enable():this.disable()}if((e=function(t,e){return o.call(this,t,e),this}).prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,rtl:"auto",enabled:!0,formatter:function(t){return Array.isArray(t)?t[0]+" : "+t[1]:t},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,ticks_tooltip:!1,scale:"linear",focus:!1,tooltip_position:null,labelledby:null,rangeHighlights:[]},getElement:function(){return this.sliderElem},getValue:function(){return this.options.range?this._state.value:this._state.value[0]},setValue:function(t,e,i){t||(t=0);var n=this.getValue();this._state.value=this._validateInputValue(t);var o=this._applyPrecision.bind(this);this.options.range?(this._state.value[0]=o(this._state.value[0]),this._state.value[1]=o(this._state.value[1]),this._state.value[0]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[0])),this._state.value[1]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[1]))):(this._state.value=o(this._state.value),this._state.value=[Math.max(this.options.min,Math.min(this.options.max,this._state.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this._state.value[1]=this.options.max:this._state.value[1]=this.options.min),this.options.max>this.options.min?this._state.percentage=[this._toPercentage(this._state.value[0]),this._toPercentage(this._state.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this._state.percentage=[0,0,100],this._layout();var s=this.options.range?this._state.value:this._state.value[0];return this._setDataVal(s),!0===e&&this._trigger("slide",s),n!==s&&!0===i&&this._trigger("change",{oldValue:n,newValue:s}),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),t&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this._state.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this._state.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this._state.enabled?this.disable():this.enable(),this},isEnabled:function(){return this._state.enabled},on:function(t,e){return this._bindNonQueryEventHandler(t,e),this},off:function(e,i){t?(this.$element.off(e,i),this.$sliderElem.off(e,i)):this._unbindNonQueryEventHandler(e,i)},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(){return this._removeSliderEventHandlers(),o.call(this,this.element,this.options),t&&t.data(this.element,"slider",this),this},relayout:function(){return this._resize(),this._layout(),this},_removeSliderEventHandlers:function(){if(this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.options.ticks_tooltip){for(var t=this.ticksContainer.getElementsByClassName("slider-tick"),e=0;e<t.length;e++)t[e].removeEventListener("mouseenter",this.ticksCallbackMap[e].mouseEnter,!1),t[e].removeEventListener("mouseleave",this.ticksCallbackMap[e].mouseLeave,!1);this.handle1.removeEventListener("mouseenter",this.handleCallbackMap.handle1.mouseEnter,!1),this.handle2.removeEventListener("mouseenter",this.handleCallbackMap.handle2.mouseEnter,!1),this.handle1.removeEventListener("mouseleave",this.handleCallbackMap.handle1.mouseLeave,!1),this.handle2.removeEventListener("mouseleave",this.handleCallbackMap.handle2.mouseLeave,!1)}this.handleCallbackMap=null,this.ticksCallbackMap=null,this.showTooltip&&(this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle2.removeEventListener("focus",this.showTooltip,!1)),this.hideTooltip&&(this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("blur",this.hideTooltip,!1)),this.showTooltip&&this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.hideTooltip&&this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.touchstart,!1),this.sliderElem.removeEventListener("touchmove",this.touchmove,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("resize",this.resize,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_unbindNonQueryEventHandler:function(t,e){var i=this.eventToCallbackMap[t];if(void 0!==i)for(var n=0;n<i.length;n++)if(i[n]===e){i.splice(n,1);break}},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var i=t[e];delete this.eventToCallbackMap[i]}},_showTooltip:function(){!1===this.options.tooltip_split?(this._addClass(this.tooltip,"in"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in"),this.tooltip.style.display="none"),this._state.over=!0},_hideTooltip:function(){!1===this._state.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this._state.over=!1},_setToolTipOnMouseOver:function(t){var e=this.options.formatter(t?t.value[0]:this._state.value[0]),i=n(t||this._state,this.options.reversed);function n(t,e){return e?[100-t.percentage[0],this.options.range?100-t.percentage[1]:t.percentage[1]]:[t.percentage[0],t.percentage[1]]}this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=i[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px")},_addTickListener:function(){return{addMouseEnter:function(t,e,i){var n=function(){var e=t._state,n=i>=0?i:this.attributes["aria-valuenow"].value,o=parseInt(n,10);e.value[0]=o,e.percentage[0]=t.options.ticks_positions[o],t._setToolTipOnMouseOver(e),t._showTooltip()};return e.addEventListener("mouseenter",n,!1),n},addMouseLeave:function(t,e){var i=function(){t._hideTooltip()};return e.addEventListener("mouseleave",i,!1),i}}},_layout:function(){var t,e;if(t=this.options.reversed?[100-this._state.percentage[0],this.options.range?100-this._state.percentage[1]:this._state.percentage[1]]:[this._state.percentage[0],this._state.percentage[1]],this.handle1.style[this.stylePos]=t[0]+"%",this.handle1.setAttribute("aria-valuenow",this._state.value[0]),isNaN(this.options.formatter(this._state.value[0]))&&this.handle1.setAttribute("aria-valuetext",this.options.formatter(this._state.value[0])),this.handle2.style[this.stylePos]=t[1]+"%",this.handle2.setAttribute("aria-valuenow",this._state.value[1]),isNaN(this.options.formatter(this._state.value[1]))&&this.handle2.setAttribute("aria-valuetext",this.options.formatter(this._state.value[1])),this.rangeHighlightElements.length>0&&Array.isArray(this.options.rangeHighlights)&&this.options.rangeHighlights.length>0)for(var i=0;i<this.options.rangeHighlights.length;i++){var n=this._toPercentage(this.options.rangeHighlights[i].start),o=this._toPercentage(this.options.rangeHighlights[i].end);if(this.options.reversed){var s=100-o;o=100-n,n=s}var r=this._createHighlightRange(n,o);r?"vertical"===this.options.orientation?(this.rangeHighlightElements[i].style.top=r.start+"%",this.rangeHighlightElements[i].style.height=r.size+"%"):(this.options.rtl?this.rangeHighlightElements[i].style.right=r.start+"%":this.rangeHighlightElements[i].style.left=r.start+"%",this.rangeHighlightElements[i].style.width=r.size+"%"):this.rangeHighlightElements[i].style.display="none"}if(Array.isArray(this.options.ticks)&&this.options.ticks.length>0){var a,l="vertical"===this.options.orientation?"height":"width";a="vertical"===this.options.orientation?"marginTop":this.options.rtl?"marginRight":"marginLeft";var h=this._state.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var c=0;if(0===this.options.ticks_positions.length)"vertical"!==this.options.orientation&&(this.tickLabelContainer.style[a]=-h/2+"px"),c=this.tickLabelContainer.offsetHeight;else for(u=0;u<this.tickLabelContainer.childNodes.length;u++)this.tickLabelContainer.childNodes[u].offsetHeight>c&&(c=this.tickLabelContainer.childNodes[u].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=c+"px")}for(var u=0;u<this.options.ticks.length;u++){var p=this.options.ticks_positions[u]||this._toPercentage(this.options.ticks[u]);this.options.reversed&&(p=100-p),this.ticks[u].style[this.stylePos]=p+"%",this._removeClass(this.ticks[u],"in-selection"),this.options.range?p>=t[0]&&p<=t[1]&&this._addClass(this.ticks[u],"in-selection"):"after"===this.options.selection&&p>=t[0]?this._addClass(this.ticks[u],"in-selection"):"before"===this.options.selection&&p<=t[0]&&this._addClass(this.ticks[u],"in-selection"),this.tickLabels[u]&&(this.tickLabels[u].style[l]=h+"px","vertical"!==this.options.orientation&&void 0!==this.options.ticks_positions[u]?(this.tickLabels[u].style.position="absolute",this.tickLabels[u].style[this.stylePos]=p+"%",this.tickLabels[u].style[a]=-h/2+"px"):"vertical"===this.options.orientation&&(this.options.rtl?this.tickLabels[u].style.marginRight=this.sliderElem.offsetWidth+"px":this.tickLabels[u].style.marginLeft=this.sliderElem.offsetWidth+"px",this.tickLabelContainer.style[a]=this.sliderElem.offsetWidth/2*-1+"px"))}}if(this.options.range){e=this.options.formatter(this._state.value),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=(t[1]+t[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px");var d=this.options.formatter(this._state.value[0]);this._setText(this.tooltipInner_min,d);var f=this.options.formatter(this._state.value[1]);this._setText(this.tooltipInner_max,f),this.tooltip_min.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-"+this.stylePos,-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-"+this.stylePos,-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-"+this.stylePos,-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-"+this.stylePos,-this.tooltip_max.offsetWidth/2+"px")}else e=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px");if("vertical"===this.options.orientation)this.trackLow.style.top="0",this.trackLow.style.height=Math.min(t[0],t[1])+"%",this.trackSelection.style.top=Math.min(t[0],t[1])+"%",this.trackSelection.style.height=Math.abs(t[0]-t[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";else{"right"===this.stylePos?this.trackLow.style.right="0":this.trackLow.style.left="0",this.trackLow.style.width=Math.min(t[0],t[1])+"%","right"===this.stylePos?this.trackSelection.style.right=Math.min(t[0],t[1])+"%":this.trackSelection.style.left=Math.min(t[0],t[1])+"%",this.trackSelection.style.width=Math.abs(t[0]-t[1])+"%","right"===this.stylePos?this.trackHigh.style.left="0":this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";var v=this.tooltip_min.getBoundingClientRect(),g=this.tooltip_max.getBoundingClientRect();"bottom"===this.options.tooltip_position?v.right>g.left?(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="",this.tooltip_max.style.bottom="22px"):(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top=this.tooltip_min.style.top,this.tooltip_max.style.bottom=""):v.right>g.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=this.tooltip_min.style.top)}},_createHighlightRange:function(t,e){return this._isHighlightRange(t,e)?t>e?{start:e,size:t-e}:{start:t,size:e-t}:null},_isHighlightRange:function(t,e){return 0<=t&&t<=100&&0<=e&&e<=100},_resize:function(t){this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this._layout()},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this._state.enabled)return!1;this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos];var e=this._getPercentage(t);if(this.options.range){var i=Math.abs(this._state.percentage[0]-e),n=Math.abs(this._state.percentage[1]-e);this._state.dragged=i<n?0:1,this._adjustPercentageForRangeSliders(e)}else this._state.dragged=0;this._state.percentage[this._state.dragged]=e,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!0;var o=this._calculateValue();return this._trigger("slideStart",o),this._setDataVal(o),this.setValue(o,!1,!0),t.returnValue=!1,this.options.focus&&this._triggerFocusOnHandle(this._state.dragged),!0},_touchstart:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0];this.touchX=e.pageX,this.touchY=e.pageY}else this._mousedown(t)},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this._state.enabled)return!1;var i;switch(e.keyCode){case 37:case 40:i=-1;break;case 39:case 38:i=1}if(i){if(this.options.natural_arrow_keys){var n="vertical"===this.options.orientation&&!this.options.reversed,o="horizontal"===this.options.orientation&&this.options.reversed;(n||o)&&(i=-i)}var s=this._state.value[t]+i*this.options.step,r=s/this.options.max*100;return this._state.keyCtrl=t,this.options.range&&(this._adjustPercentageForRangeSliders(r),s=[this._state.keyCtrl?this._state.value[0]:s,this._state.keyCtrl?s:this._state.value[1]]),this._trigger("slideStart",s),this._setDataVal(s),this.setValue(s,!0,!0),this._setDataVal(s),this._trigger("slideStop",s),this._layout(),this._pauseEvent(e),delete this._state.keyCtrl,!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this._state.enabled)return!1;var e=this._getPercentage(t);this._adjustPercentageForRangeSliders(e),this._state.percentage[this._state.dragged]=e,this._layout();var i=this._calculateValue(!0);return this.setValue(i,!0,!0),!1},_touchmove:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0],i=e.pageX-this.touchX,n=e.pageY-this.touchY;this._state.inDrag||("vertical"===this.options.orientation&&i<=5&&i>=-5&&(n>=15||n<=-15)?this._mousedown(t):n<=5&&n>=-5&&(i>=15||i<=-15)&&this._mousedown(t))}},_adjustPercentageForRangeSliders:function(t){if(this.options.range){var e=this._getNumDigitsAfterDecimalPlace(t);e=e?e-1:0;var i=this._applyToFixedAndParseFloat(t,e);0===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[1],e)<i?(this._state.percentage[0]=this._state.percentage[1],this._state.dragged=1):1===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[0],e)>i?(this._state.percentage[1]=this._state.percentage[0],this._state.dragged=0):0===this._state.keyCtrl&&this._state.value[1]/this.options.max*100<t?(this._state.percentage[0]=this._state.percentage[1],this._state.keyCtrl=1,this.handle2.focus()):1===this._state.keyCtrl&&this._state.value[0]/this.options.max*100>t&&(this._state.percentage[1]=this._state.percentage[0],this._state.keyCtrl=0,this.handle1.focus())}},_mouseup:function(){if(!this._state.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!1,!1===this._state.over&&this._hideTooltip();var t=this._calculateValue(!0);return this._layout(),this._setDataVal(t),this._trigger("slideStop",t),!1},_calculateValue:function(t){var e;if(this.options.range?(e=[this.options.min,this.options.max],0!==this._state.percentage[0]&&(e[0]=this._toValue(this._state.percentage[0]),e[0]=this._applyPrecision(e[0])),100!==this._state.percentage[1]&&(e[1]=this._toValue(this._state.percentage[1]),e[1]=this._applyPrecision(e[1]))):(e=this._toValue(this._state.percentage[0]),e=parseFloat(e),e=this._applyPrecision(e)),t){for(var i=[e,1/0],n=0;n<this.options.ticks.length;n++){var o=Math.abs(this.options.ticks[n]-e);o<=i[1]&&(i=[this.options.ticks[n],o])}if(i[1]<=this.options.ticks_snap_bounds)return i[0]}return e},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){var i=t.toFixed(e);return parseFloat(i)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type||(t=t.touches[0]);var e=t[this.mousePos]-this._state.offset[this.stylePos];"right"===this.stylePos&&(e=-e);var i=e/this._state.size*100;return i=Math.round(i/this._state.percentage[2])*this._state.percentage[2],this.options.reversed&&(i=100-i),Math.max(0,Math.min(100,i))},_validateInputValue:function(t){if(isNaN(+t)){if(Array.isArray(t))return this._validateArray(t),t;throw new Error(i(t))}return+t},_validateArray:function(t){for(var e=0;e<t.length;e++){var n=t[e];if("number"!=typeof n)throw new Error(i(n))}},_setDataVal:function(t){this.element.setAttribute("data-value",t),this.element.setAttribute("value",t),this.element.value=t},_trigger:function(e,i){i=i||0===i?i:void 0;var n=this.eventToCallbackMap[e];if(n&&n.length)for(var o=0;o<n.length;o++)(0,n[o])(i);t&&this._triggerJQueryEvent(e,i)},_triggerJQueryEvent:function(t,e){var i={type:t,value:e};this.$element.trigger(i),this.$sliderElem.trigger(i)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.textContent?t.textContent=e:void 0!==t.innerText&&(t.innerText=e)},_removeClass:function(t,e){for(var i=e.split(" "),n=t.className,o=0;o<i.length;o++){var s=i[o],r=new RegExp("(?:\\s|^)"+s+"(?:\\s|$)");n=n.replace(r," ")}t.className=n.trim()},_addClass:function(t,e){for(var i=e.split(" "),n=t.className,o=0;o<i.length;o++){var s=i[o];new RegExp("(?:\\s|^)"+s+"(?:\\s|$)").test(n)||(n+=" "+s)}t.className=n.trim()},_offsetLeft:function(t){return t.getBoundingClientRect().left},_offsetRight:function(t){return t.getBoundingClientRect().right},_offsetTop:function(t){for(var e=t.offsetTop;(t=t.offsetParent)&&!isNaN(t.offsetTop);)e+=t.offsetTop,"BODY"!==t.tagName&&(e-=t.scrollTop);return e},_offset:function(t){return{left:this._offsetLeft(t),right:this._offsetRight(t),top:this._offsetTop(t)}},_css:function(e,i,n){if(t)t.style(e,i,n);else{var o=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(t,e){return e.toUpperCase()}));e.style[o]=n}},_toValue:function(t){return this.options.scale.toValue.apply(this,[t])},_toPercentage:function(t){return this.options.scale.toPercentage.apply(this,[t])},_setTooltipPosition:function(){var t=[this.tooltip,this.tooltip_min,this.tooltip_max];if("vertical"===this.options.orientation){var e,i="left"===(e=this.options.tooltip_position?this.options.tooltip_position:this.options.rtl?"left":"right")?"right":"left";t.forEach(function(t){this._addClass(t,e),t.style[i]="100%"}.bind(this))}else"bottom"===this.options.tooltip_position?t.forEach(function(t){this._addClass(t,"bottom"),t.style.top="22px"}.bind(this)):t.forEach(function(t){this._addClass(t,"top"),t.style.top=-this.tooltip.outerHeight-14+"px"}.bind(this))}},t&&t.fn){var s=void 0;t.fn.slider?(a&&window.console.warn("bootstrap-slider.js - WARNING: $.fn.slider namespace is already bound. Use the $.fn.bootstrapSlider namespace instead."),s="bootstrapSlider"):(t.bridget("slider",e),s="slider"),t.bridget("bootstrapSlider",e),t((function(){t("input[data-provide=slider]")[s]()}))}}(t),e})?n.apply(e,o):n)||(t.exports=s)},4323:function(t,e,i){},4324:function(t,e,i){},4325:function(t,e,i){},4330:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n=i(0),o=i.n(n),s=i(5),r=i.n(s),a=i(446);i(4332);const l={categories:r.a.object,toggleCategory:r.a.func,showSingleCategory:r.a.func,format:r.a.string,position:r.a.oneOf([null,"tl","tr","bl","br"])};class h extends o.a.PureComponent{format(t){if(!this.props.format)return t;const e=parseFloat(t);return Object(a.b)(this.props.format,e)}formatCategoryLabel(t){if(!this.props.format)return t;if(t.includes(" - ")){const e=t.split(" - ");return this.format(e[0])+" - "+this.format(e[1])}return this.format(t)}render(){if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;const t=Object.entries(this.props.categories).map(t=>{let[e,i]=t;const n={color:"rgba("+i.color.join(", ")+")"},s=i.enabled?"◼":"◻";return o.a.createElement("li",{key:e},o.a.createElement("a",{href:"#",onClick:()=>this.props.toggleCategory(e),onDoubleClick:()=>this.props.showSingleCategory(e)},o.a.createElement("span",{style:n},s)," ",this.formatCategoryLabel(e)))}),e={position:"absolute",["t"===this.props.position.charAt(0)?"top":"bottom"]:"0px",["r"===this.props.position.charAt(1)?"right":"left"]:"10px"};return o.a.createElement("div",{className:"legend",style:e},o.a.createElement("ul",{className:"categories"},t))}}h.propTypes=l,h.defaultProps={categories:{},toggleCategory:()=>{},showSingleCategory:()=>{},format:null,position:"tr"}},4332:function(t,e,i){},4369:function(t,e,i){"use strict";i.d(e,"b",(function(){return d})),i.d(e,"c",(function(){return f})),i.d(e,"a",(function(){return v}));var n=i(4412),o=i.n(n);function s(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function r(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function a(t){var e=t[0],i=t[t.length-1];return e[0]===i[0]&&e[1]===i[1]&&e[2]===i[2]}function l(t,e,i,n){for(var o=0;o<e;o++)if(t[i+o]!==t[n-e+o])return!1;return!0}function h(t,e,i,n){for(var o=e,s=i.length,r=0;r<s;r++)for(var l=0;l<n;l++)t[o++]=i[r][l]||0;if(!a(i))for(var h=0;h<n;h++)t[o++]=i[0][h]||0;return o}function c(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0,r=(s=s||i.length)-o;if(r<=0)return e;for(var a=e,h=0;h<r;h++)t[a++]=i[o+h];if(!l(i,n,o,s))for(var c=0;c<n;c++)t[a++]=i[o+c];return a}function u(t){return(a(t)?0:1)+t.length}function p(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0;return i>=(n=n||t.length)?0:(l(t,e,i,n)?0:1)+(n-i)/e}function d(t,e){if(s(t),t.positions){var i=t,n=i.positions,o=i.holeIndices;if(o){for(var a=0,l=0;l<=o.length;l++)a+=p(t.positions,e,o[l-1],o[l]);return a}t=n}if(Number.isFinite(t[0]))return p(t,e);if(!r(t)){var h=0,c=!0,d=!1,f=void 0;try{for(var v,g=t[Symbol.iterator]();!(c=(v=g.next()).done);c=!0){h+=u(v.value)}}catch(t){d=!0,f=t}finally{try{c||null==g.return||g.return()}finally{if(d)throw f}}return h}return u(t)}function f(t,e,i){s(t),i=i||d(t,e);var n=new Float64Array(i*e),o=[];if(t.positions){var a=t,l=a.positions,u=a.holeIndices;if(u){for(var p=0,f=0;f<=u.length;f++)p=c(n,p,l,e,u[f-1],u[f]),o.push(p);return o.pop(),{positions:n,holeIndices:o}}t=l}if(Number.isFinite(t[0]))return c(n,0,t,e),{positions:n,holeIndices:null};if(!r(t)){var v=0,g=!0,m=!1,y=void 0;try{for(var b,x=t[Symbol.iterator]();!(g=(b=x.next()).done);g=!0){v=h(n,v,b.value,e),o.push(v)}}catch(t){m=!0,y=t}finally{try{g||null==x.return||x.return()}finally{if(m)throw y}}return o.pop(),{positions:n,holeIndices:o}}return h(n,0,t,e),{positions:n,holeIndices:null}}function v(t,e){var i=null;return t.holeIndices&&(i=t.holeIndices.map((function(t){return t/e}))),o()(t.positions,i,e)}},4381:function(t,e,i){"use strict";i.r(e),i.d(e,"scaleBand",(function(){return c})),i.d(e,"scalePoint",(function(){return u})),i.d(e,"scaleIdentity",(function(){return L})),i.d(e,"scaleLinear",(function(){return C})),i.d(e,"scaleLog",(function(){return N})),i.d(e,"scaleOrdinal",(function(){return h})),i.d(e,"scaleImplicit",(function(){return l})),i.d(e,"scalePow",(function(){return z})),i.d(e,"scaleSqrt",(function(){return I})),i.d(e,"scaleQuantile",(function(){return D})),i.d(e,"scaleQuantize",(function(){return V})),i.d(e,"scaleThreshold",(function(){return R})),i.d(e,"scaleTime",(function(){return U})),i.d(e,"scaleUtc",(function(){return J})),i.d(e,"scaleSequential",(function(){return G})),i.d(e,"scaleDiverging",(function(){return X}));var n=i(586),o=i(1416),s=Array.prototype,r=s.map,a=s.slice,l={name:"implicit"};function h(t){var e=Object(o.a)(),i=[],n=l;function s(o){var s=o+"",r=e.get(s);if(!r){if(n!==l)return n;e.set(s,r=i.push(o))}return t[(r-1)%t.length]}return t=null==t?[]:a.call(t),s.domain=function(t){if(!arguments.length)return i.slice();i=[],e=Object(o.a)();for(var n,r,a=-1,l=t.length;++a<l;)e.has(r=(n=t[a])+"")||e.set(r,i.push(n));return s},s.range=function(e){return arguments.length?(t=a.call(e),s):t.slice()},s.unknown=function(t){return arguments.length?(n=t,s):n},s.copy=function(){return h().domain(i).range(t).unknown(n)},s}function c(){var t,e,i=h().unknown(void 0),o=i.domain,s=i.range,r=[0,1],a=!1,l=0,u=0,p=.5;function d(){var i=o().length,h=r[1]<r[0],c=r[h-0],d=r[1-h];t=(d-c)/Math.max(1,i-l+2*u),a&&(t=Math.floor(t)),c+=(d-c-t*(i-l))*p,e=t*(1-l),a&&(c=Math.round(c),e=Math.round(e));var f=Object(n.range)(i).map((function(e){return c+t*e}));return s(h?f.reverse():f)}return delete i.unknown,i.domain=function(t){return arguments.length?(o(t),d()):o()},i.range=function(t){return arguments.length?(r=[+t[0],+t[1]],d()):r.slice()},i.rangeRound=function(t){return r=[+t[0],+t[1]],a=!0,d()},i.bandwidth=function(){return e},i.step=function(){return t},i.round=function(t){return arguments.length?(a=!!t,d()):a},i.padding=function(t){return arguments.length?(l=u=Math.max(0,Math.min(1,t)),d()):l},i.paddingInner=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),d()):l},i.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),d()):u},i.align=function(t){return arguments.length?(p=Math.max(0,Math.min(1,t)),d()):p},i.copy=function(){return c().domain(o()).range(r).round(a).paddingInner(l).paddingOuter(u).align(p)},d()}function u(){return function t(e){var i=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t(i())},e}(c().paddingInner(1))}var p=i(101),d=i(236),f=i(742),v=function(t){return function(){return t}},g=function(t){return+t},m=[0,1];function y(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:v(e)}function b(t,e,i,n){var o=t[0],s=t[1],r=e[0],a=e[1];return s<o?(o=i(s,o),r=n(a,r)):(o=i(o,s),r=n(r,a)),function(t){return r(o(t))}}function x(t,e,i,o){var s=Math.min(t.length,e.length)-1,r=new Array(s),a=new Array(s),l=-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<s;)r[l]=i(t[l],t[l+1]),a[l]=o(e[l],e[l+1]);return function(e){var i=Object(n.bisect)(t,e,1,s)-1;return a[i](r[i](e))}}function _(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function P(t,e){var i,n,o,s=m,l=m,h=d.a,c=!1;function u(){return i=Math.min(s.length,l.length)>2?x:b,n=o=null,p}function p(e){return(n||(n=i(s,l,c?function(t){return function(e,i){var n=t(e=+e,i=+i);return function(t){return t<=e?0:t>=i?1:n(t)}}}(t):t,h)))(+e)}return p.invert=function(t){return(o||(o=i(l,s,y,c?function(t){return function(e,i){var n=t(e=+e,i=+i);return function(t){return t<=0?e:t>=1?i:n(t)}}}(e):e)))(+t)},p.domain=function(t){return arguments.length?(s=r.call(t,g),u()):s.slice()},p.range=function(t){return arguments.length?(l=a.call(t),u()):l.slice()},p.rangeRound=function(t){return l=a.call(t),h=f.a,u()},p.clamp=function(t){return arguments.length?(c=!!t,u()):c},p.interpolate=function(t){return arguments.length?(h=t,u()):h},u()}var w=i(73);function k(t){var e=t.domain;return t.ticks=function(t){var i=e();return Object(n.ticks)(i[0],i[i.length-1],null==t?10:t)},t.tickFormat=function(t,i){return function(t,e,i){var o,s=t[0],r=t[t.length-1],a=Object(n.tickStep)(s,r,null==e?10:e);switch((i=Object(w.d)(null==i?",f":i)).type){case"s":var l=Math.max(Math.abs(s),Math.abs(r));return null!=i.precision||isNaN(o=Object(w.f)(a,l))||(i.precision=o),Object(w.c)(i,l);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(o=Object(w.g)(a,Math.max(Math.abs(s),Math.abs(r))))||(i.precision=o-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(o=Object(w.e)(a))||(i.precision=o-2*("%"===i.type))}return Object(w.a)(i)}(e(),t,i)},t.nice=function(i){null==i&&(i=10);var o,s=e(),r=0,a=s.length-1,l=s[r],h=s[a];return h<l&&(o=l,l=h,h=o,o=r,r=a,a=o),(o=Object(n.tickIncrement)(l,h,i))>0?(l=Math.floor(l/o)*o,h=Math.ceil(h/o)*o,o=Object(n.tickIncrement)(l,h,i)):o<0&&(l=Math.ceil(l*o)/o,h=Math.floor(h*o)/o,o=Object(n.tickIncrement)(l,h,i)),o>0?(s[r]=Math.floor(l/o)*o,s[a]=Math.ceil(h/o)*o,e(s)):o<0&&(s[r]=Math.ceil(l*o)/o,s[a]=Math.floor(h*o)/o,e(s)),t},t}function C(){var t=P(y,p.a);return t.copy=function(){return _(t,C())},k(t)}function L(){var t=[0,1];function e(t){return+t}return e.invert=e,e.domain=e.range=function(i){return arguments.length?(t=r.call(i,g),e):t.slice()},e.copy=function(){return L().domain(t)},k(e)}var E=function(t,e){var i,n=0,o=(t=t.slice()).length-1,s=t[n],r=t[o];return r<s&&(i=n,n=o,o=i,i=s,s=r,r=i),t[n]=e.floor(s),t[o]=e.ceil(r),t};function M(t,e){return(e=Math.log(e/t))?function(i){return Math.log(i/t)/e}:v(e)}function S(t,e){return t<0?function(i){return-Math.pow(-e,i)*Math.pow(-t,1-i)}:function(i){return Math.pow(e,i)*Math.pow(t,1-i)}}function A(t){return isFinite(t)?+("1e"+t):t<0?0:t}function j(t){return 10===t?A:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function O(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function T(t){return function(e){return-t(-e)}}function N(){var t=P(M,S).domain([1,10]),e=t.domain,i=10,o=O(10),s=j(10);function r(){return o=O(i),s=j(i),e()[0]<0&&(o=T(o),s=T(s)),t}return t.base=function(t){return arguments.length?(i=+t,r()):i},t.domain=function(t){return arguments.length?(e(t),r()):e()},t.ticks=function(t){var r,a=e(),l=a[0],h=a[a.length-1];(r=h<l)&&(d=l,l=h,h=d);var c,u,p,d=o(l),f=o(h),v=null==t?10:+t,g=[];if(!(i%1)&&f-d<v){if(d=Math.round(d)-1,f=Math.round(f)+1,l>0){for(;d<f;++d)for(u=1,c=s(d);u<i;++u)if(!((p=c*u)<l)){if(p>h)break;g.push(p)}}else for(;d<f;++d)for(u=i-1,c=s(d);u>=1;--u)if(!((p=c*u)<l)){if(p>h)break;g.push(p)}}else g=Object(n.ticks)(d,f,Math.min(f-d,v)).map(s);return r?g.reverse():g},t.tickFormat=function(e,n){if(null==n&&(n=10===i?".0e":","),"function"!=typeof n&&(n=Object(w.a)(n)),e===1/0)return n;null==e&&(e=10);var r=Math.max(1,i*e/t.ticks().length);return function(t){var e=t/s(Math.round(o(t)));return e*i<i-.5&&(e*=i),e<=r?n(t):""}},t.nice=function(){return e(E(e(),{floor:function(t){return s(Math.floor(o(t)))},ceil:function(t){return s(Math.ceil(o(t)))}}))},t.copy=function(){return _(t,N().base(i))},t}function F(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function z(){var t=1,e=P((function(e,i){return(i=F(i,t)-(e=F(e,t)))?function(n){return(F(n,t)-e)/i}:v(i)}),(function(e,i){return i=F(i,t)-(e=F(e,t)),function(n){return F(e+i*n,1/t)}})),i=e.domain;return e.exponent=function(e){return arguments.length?(t=+e,i(i())):t},e.copy=function(){return _(e,z().exponent(t))},k(e)}function I(){return z().exponent(.5)}function D(){var t=[],e=[],i=[];function o(){var o=0,r=Math.max(1,e.length);for(i=new Array(r-1);++o<r;)i[o-1]=Object(n.quantile)(t,o/r);return s}function s(t){if(!isNaN(t=+t))return e[Object(n.bisect)(i,t)]}return s.invertExtent=function(n){var o=e.indexOf(n);return o<0?[NaN,NaN]:[o>0?i[o-1]:t[0],o<i.length?i[o]:t[t.length-1]]},s.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var i,s=0,r=e.length;s<r;++s)null==(i=e[s])||isNaN(i=+i)||t.push(i);return t.sort(n.ascending),o()},s.range=function(t){return arguments.length?(e=a.call(t),o()):e.slice()},s.quantiles=function(){return i.slice()},s.copy=function(){return D().domain(t).range(e)},s}function V(){var t=0,e=1,i=1,o=[.5],s=[0,1];function r(t){if(t<=t)return s[Object(n.bisect)(o,t,0,i)]}function l(){var n=-1;for(o=new Array(i);++n<i;)o[n]=((n+1)*e-(n-i)*t)/(i+1);return r}return r.domain=function(i){return arguments.length?(t=+i[0],e=+i[1],l()):[t,e]},r.range=function(t){return arguments.length?(i=(s=a.call(t)).length-1,l()):s.slice()},r.invertExtent=function(n){var r=s.indexOf(n);return r<0?[NaN,NaN]:r<1?[t,o[0]]:r>=i?[o[i-1],e]:[o[r-1],o[r]]},r.copy=function(){return V().domain([t,e]).range(s)},k(r)}function R(){var t=[.5],e=[0,1],i=1;function o(o){if(o<=o)return e[Object(n.bisect)(t,o,0,i)]}return o.domain=function(n){return arguments.length?(t=a.call(n),i=Math.min(t.length,e.length-1),o):t.slice()},o.range=function(n){return arguments.length?(e=a.call(n),i=Math.min(t.length,e.length-1),o):e.slice()},o.invertExtent=function(i){var n=e.indexOf(i);return[t[n-1],t[n]]},o.copy=function(){return R().domain(t).range(e)},o}var B=i(16),H=i(821);function Z(t){return new Date(t)}function q(t){return t instanceof Date?+t:+new Date(+t)}function W(t,e,i,o,s,a,l,h,c){var u=P(y,p.a),d=u.invert,f=u.domain,v=c(".%L"),g=c(":%S"),m=c("%I:%M"),b=c("%I %p"),x=c("%a %d"),w=c("%b %d"),k=c("%B"),C=c("%Y"),L=[[l,1,1e3],[l,5,5e3],[l,15,15e3],[l,30,3e4],[a,1,6e4],[a,5,3e5],[a,15,9e5],[a,30,18e5],[s,1,36e5],[s,3,108e5],[s,6,216e5],[s,12,432e5],[o,1,864e5],[o,2,1728e5],[i,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function M(n){return(l(n)<n?v:a(n)<n?g:s(n)<n?m:o(n)<n?b:e(n)<n?i(n)<n?x:w:t(n)<n?k:C)(n)}function S(e,i,o,s){if(null==e&&(e=10),"number"==typeof e){var r=Math.abs(o-i)/e,a=Object(n.bisector)((function(t){return t[2]})).right(L,r);a===L.length?(s=Object(n.tickStep)(i/31536e6,o/31536e6,e),e=t):a?(s=(a=L[r/L[a-1][2]<L[a][2]/r?a-1:a])[1],e=a[0]):(s=Math.max(Object(n.tickStep)(i,o,e),1),e=h)}return null==s?e:e.every(s)}return u.invert=function(t){return new Date(d(t))},u.domain=function(t){return arguments.length?f(r.call(t,q)):f().map(Z)},u.ticks=function(t,e){var i,n=f(),o=n[0],s=n[n.length-1],r=s<o;return r&&(i=o,o=s,s=i),i=(i=S(t,o,s,e))?i.range(o,s+1):[],r?i.reverse():i},u.tickFormat=function(t,e){return null==e?M:c(e)},u.nice=function(t,e){var i=f();return(t=S(t,i[0],i[i.length-1],e))?f(E(i,t)):u},u.copy=function(){return _(u,W(t,e,i,o,s,a,l,h,c))},u}var U=function(){return W(B.o,B.g,B.n,B.a,B.c,B.e,B.i,B.d,H.a).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},J=function(){return W(B.D,B.v,B.C,B.p,B.r,B.t,B.x,B.s,H.b).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])};function G(t){var e=0,i=1,n=1,o=!1;function s(i){var s=(i-e)*n;return t(o?Math.max(0,Math.min(1,s)):s)}return s.domain=function(t){return arguments.length?(e=+t[0],i=+t[1],n=e===i?0:1/(i-e),s):[e,i]},s.clamp=function(t){return arguments.length?(o=!!t,s):o},s.interpolator=function(e){return arguments.length?(t=e,s):t},s.copy=function(){return G(t).domain([e,i]).clamp(o)},k(s)}function X(t){var e=0,i=.5,n=1,o=1,s=1,r=!1;function a(e){var n=.5+((e=+e)-i)*(e<i?o:s);return t(r?Math.max(0,Math.min(1,n)):n)}return a.domain=function(t){return arguments.length?(e=+t[0],i=+t[1],n=+t[2],o=e===i?0:.5/(i-e),s=i===n?0:.5/(n-i),a):[e,i,n]},a.clamp=function(t){return arguments.length?(r=!!t,a):r},a.interpolator=function(e){return arguments.length?(t=e,a):t},a.copy=function(){return X(t).domain([e,i,n]).clamp(r)},k(a)}},4382:function(t,e,i){"use strict";i.d(e,"a",(function(){return _}));var n=i(23),o=i(25),s=i(299),r=i(107),a=i(338),l=i(30),h=i(4366),c=i(4711),u=i(4498),p=i(4289),d=i(5268),f=p.a.Tesselator,v=d.a.fp64LowPart,g=function(t){function e(t){var i=t.data,o=t.getGeometry,a=t.positionFormat,l=t.fp64;return Object(n.a)(this,e),Object(s.a)(this,Object(r.a)(e).call(this,{data:i,getGeometry:o,fp64:l,positionFormat:a,attributes:{startPositions:{size:3},endPositions:{size:3},leftPositions:{size:3},rightPositions:{size:3},startEndPositions64XyLow:{size:4,fp64Only:!0},neighborPositions64XyLow:{size:4,fp64Only:!0}}}))}return Object(l.a)(e,t),Object(o.a)(e,[{key:"get",value:function(t){return this.attributes[t]}},{key:"getGeometrySize",value:function(t){return Math.max(0,this.getPathLength(t)-1)}},{key:"updateGeometryAttributes",value:function(t,e){var i=this.attributes,n=i.startPositions,o=i.endPositions,s=i.leftPositions,r=i.rightPositions,a=i.startEndPositions64XyLow,l=i.neighborPositions64XyLow,h=this.fp64,c=e.geometrySize+1;if(!(c<2))for(var u,p=this.isClosed(t),d=this.getPointOnPath(t,0),f=this.getPointOnPath(t,1),g=p?this.getPointOnPath(t,c-2):d,m=e.vertexStart,y=1;y<c;m++,y++)u=y+1<c?this.getPointOnPath(t,y+1):p?this.getPointOnPath(t,1):f,n[3*m]=d[0],n[3*m+1]=d[1],n[3*m+2]=d[2]||0,o[3*m]=f[0],o[3*m+1]=f[1],o[3*m+2]=f[2]||0,s[3*m]=g[0],s[3*m+1]=g[1],s[3*m+2]=g[2]||0,r[3*m]=u[0],r[3*m+1]=u[1],r[3*m+2]=u[2]||0,h&&(a[4*m]=v(d[0]),a[4*m+1]=v(d[1]),a[4*m+2]=v(f[0]),a[4*m+3]=v(f[1]),l[4*m]=v(g[0]),l[4*m+1]=v(g[1]),l[4*m+2]=v(u[0]),l[4*m+3]=v(u[1])),g=d,d=f,f=u}},{key:"getPathLength",value:function(t){return Number.isFinite(t[0])?t.length/this.positionSize:t.length}},{key:"getPointOnPath",value:function(t,e){if(Number.isFinite(t[0])){var i=this.positionSize;return[t[e*i],t[e*i+1],3===i?t[e*i+2]:0]}return t[e]}},{key:"isClosed",value:function(t){var e=this.getPathLength(t),i=this.getPointOnPath(t,0),n=this.getPointOnPath(t,e-1);return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]}}]),e}(f),m="#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float jointType;\nuniform float miterLimit;\nuniform float alignMode;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nfloat mod2(float a, float b) {\n  return a - floor(a / b) * b;\n}\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\nbool dash_isFragInGap() {\n  float solidLength = vDashArray.x;\n  float gapLength = vDashArray.y;\n\n  float unitLength = solidLength + gapLength;\n\n  if (unitLength == 0.0) {\n    return false;\n  }\n\n  unitLength = mix(\n    unitLength,\n    vPathLength / round(vPathLength / unitLength),\n    alignMode\n  );\n\n  float offset = alignMode * solidLength / 2.0;\n\n  return gapLength > 0.0 &&\n    vPathPosition.y >= 0.0 &&\n    vPathPosition.y <= vPathLength &&\n    mod2(vPathPosition.y + offset, unitLength) > solidLength;\n}\n\nvoid main(void) {\n  if (jointType > 0.0 && vMiterLength > 0.0 && length(vCornerOffset) > 1.0) {\n    discard;\n  }\n  if (jointType == 0.0 && vMiterLength > miterLimit) {\n    discard;\n  }\n  if (vColor.a == 0.0 || dash_isFragInGap()) {\n    discard;\n  }\n  gl_FragColor = vColor;\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",y=[0,0,0,255],b={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},rounded:!1,miterLimit:{type:"number",min:0,value:4},fp64:!1,dashJustified:!1,billboard:!1,getPath:{type:"accessor",value:function(t){return t.path}},getColor:{type:"accessor",value:y},getWidth:{type:"accessor",value:1},getDashArray:{type:"accessor",value:[0,0]}},x={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},_=function(t){function e(){return Object(n.a)(this,e),Object(s.a)(this,Object(r.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(o.a)(e,[{key:"getShaders",value:function(){return this.use64bitProjection()?{vs:"\n#define SHADER_NAME path-layer-vertex-shader-64\n\nattribute vec3 positions;\n\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec4 instanceStartEndPositions64xyLow;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec4 instanceNeighborPositions64xyLow;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec2 instanceDashArrays;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\nvec3 lineJoin(vec2 prevPoint64[2], vec2 currPoint64[2], vec2 nextPoint64[2]) {\n\n  float widthPixels = clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0;\n  float width = project_pixel_size(widthPixels);\n\n  vec2 deltaA64[2];\n  vec2 deltaB64[2];\n\n  vec2_sub_fp64(currPoint64, prevPoint64, deltaA64);\n  vec2_sub_fp64(nextPoint64, currPoint64, deltaB64);\n\n  vec2 lengthA64 = vec2_length_fp64(deltaA64);\n  vec2 lengthB64 = vec2_length_fp64(deltaB64);\n\n  vec2 deltaA = vec2(deltaA64[0].x, deltaA64[1].x);\n  vec2 deltaB = vec2(deltaB64[0].x, deltaB64[1].x);\n\n  float lenA = lengthA64.x;\n  float lenB = lengthB64.x;\n\n  vec2 offsetVec;\n  float offsetScale;\n  float offsetDirection;\n  lenA = lenA / width > EPSILON ? lenA : 0.0;\n  lenB = lenB / width > EPSILON ? lenB : 0.0;\n  vec2 dirA = lenA > 0. ? deltaA / lenA : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? deltaB / lenB : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = vec2(dirA + dirB);\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 perp = mix(perpB, perpA, positions.x);\n  float L = mix(lenB, lenA, positions.x);\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\n  float cornerPosition = mix(\n    flipIfTrue(turnsRight == (positions.y > 0.0)),\n    0.0,\n    positions.z\n  );\n\n  offsetScale = 1.0 / max(sinHalfA, EPSILON);\n  cornerPosition *= float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) / width * cosHalfA);\n  offsetScale = mix(\n    offsetScale,\n    min(offsetScale, L / width / max(cosHalfA, EPSILON)),\n    float(cornerPosition < 0.0)\n  );\n\n  vMiterLength = mix(\n    offsetScale * cornerPosition,\n    mix(offsetScale, 0.0, cornerPosition),\n    step(0.0, cornerPosition)\n  ) - sinHalfA * jointType;\n  offsetDirection = mix(\n    positions.y,\n    mix(\n      flipIfTrue(turnsRight),\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\n      cornerPosition\n    ),\n    step(0.0, cornerPosition)\n  );\n  offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\n  float isStartCap = step(lenA, 1.0e-5);\n  float isEndCap = step(lenB, 1.0e-5);\n  float isCap = max(isStartCap, isEndCap);\n  cornerPosition = isCap * (1.0 - positions.z);\n  offsetVec = mix(offsetVec, mix(dirB, perpB, cornerPosition), isStartCap);\n  offsetVec = mix(offsetVec, mix(dirA, perpA, cornerPosition), isEndCap);\n  offsetScale = mix(\n    offsetScale,\n    mix(4.0 * jointType, 1.0, cornerPosition),\n    isCap\n  );\n  vMiterLength = mix(vMiterLength, 1.0 - cornerPosition, isCap);\n\n  offsetDirection = mix(\n    offsetDirection,\n    mix(flipIfTrue(isStartCap > 0.), positions.y, cornerPosition),\n    isCap\n  );\n\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\n  vDashArray = instanceDashArrays;\n  vPathLength = L / width;\n  float isEnd = positions.x;\n  vec2 offsetFromStartOfPath = mix(vCornerOffset, vCornerOffset + deltaA / width, isEnd);\n  vec2 dir = mix(dirB, dirA, isEnd);\n  vPathPosition = vec2(\n    positions.y + positions.z * offsetDirection,\n    dot(offsetFromStartOfPath, dir)\n  );\n\n  return vec3(vCornerOffset * width, 0.0);\n}\n\nvoid main() {\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n  picking_setPickingColor(instancePickingColors);\n\n  float isEnd = positions.x;\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\n  vec2 projected_curr_position[2];\n  project_position_fp64(currPosition.xy, currPosition64xyLow, projected_curr_position);\n  float projected_curr_position_z = project_size(currPosition.z);\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec2 prevPosition64xyLow = mix(instanceNeighborPositions64xyLow.xy, instanceStartEndPositions64xyLow.xy, isEnd);\n\n  vec2 projected_prev_position[2];\n  project_position_fp64(prevPosition.xy, prevPosition64xyLow, projected_prev_position);\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec2 nextPosition64xyLow = mix(instanceStartEndPositions64xyLow.zw, instanceNeighborPositions64xyLow.zw, isEnd);\n\n  vec2 projected_next_position[2];\n  project_position_fp64(nextPosition.xy, nextPosition64xyLow, projected_next_position);\n\n  vec3 pos = lineJoin(projected_prev_position, projected_curr_position, projected_next_position);\n  vec2 vertex_pos_modelspace[4];\n\n  vertex_pos_modelspace[0] = sum_fp64(vec2(pos.x, 0.0), projected_curr_position[0]);\n  vertex_pos_modelspace[1] = sum_fp64(vec2(pos.y, 0.0), projected_curr_position[1]);\n  vertex_pos_modelspace[2] = vec2(pos.z + projected_curr_position_z, 0.0);\n  vertex_pos_modelspace[3] = vec2(1.0, 0.0);\n\n  gl_Position = project_common_position_to_clipspace_fp64(vertex_pos_modelspace);\n}\n",fs:m,modules:["project64","picking"]}:{vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec4 instanceStartEndPositions64xyLow;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec4 instanceNeighborPositions64xyLow;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec2 instanceDashArrays;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float miterLimit;\nuniform bool billboard;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vDashArray;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  float relativePosition, bool isEnd, bool isJoint,\n  vec2 width\n) {\n  vec2 deltaA = (currPoint.xy - prevPoint.xy) / width;\n  vec2 deltaB = (nextPoint.xy - currPoint.xy) / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n  lenA = lenA > EPSILON ? lenA : 0.0;\n  lenB = lenB > EPSILON ? lenB : 0.0;\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = vec2(dirA + dirB);\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n\n  bool turnsRight = dirA.x * dirB.y > dirA.y * dirB.x;\n\n  float offsetScale = 1.0 / max(sinHalfA, EPSILON);\n\n  float cornerPosition = isJoint ?\n    0.0 :\n    flipIfTrue(turnsRight == (relativePosition > 0.0));\n  cornerPosition *=\n    float(cornerPosition <= 0.0 || sinHalfA < min(lenA, lenB) * cosHalfA);\n  if (cornerPosition < 0.0) {\n    offsetScale = min(offsetScale, L / max(cosHalfA, EPSILON));\n  }\n\n  vMiterLength = cornerPosition >= 0.0 ?\n    mix(offsetScale, 0.0, cornerPosition) :\n    offsetScale * cornerPosition;\n  vMiterLength -= sinHalfA * jointType;\n\n  float offsetDirection = mix(\n    positions.y,\n    mix(\n      flipIfTrue(turnsRight),\n      positions.y * flipIfTrue(turnsRight == (positions.x == 1.)),\n      cornerPosition\n    ),\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec, -tangent, step(0.5, cornerPosition));\n  offsetScale = mix(offsetScale, 1.0 / max(cosHalfA, 0.001), step(0.5, cornerPosition));\n  bool isStartCap = step(0.0, -lenA) > 0.5;\n  bool isEndCap = step(0.0, -lenB) > 0.5;\n  bool isCap = isStartCap || isEndCap;\n  cornerPosition = isCap ? (1.0 - positions.z) : 0.;\n  if (isStartCap) {\n    offsetVec = mix(dirB, perpB, cornerPosition);\n  }\n  if (isEndCap) {\n    offsetVec = mix(dirA, perpA, cornerPosition);\n  }\n  if (isCap) {\n    offsetScale = mix(4.0 * jointType, 1.0, cornerPosition);\n    vMiterLength = 1.0 - cornerPosition;\n    offsetDirection = mix(flipIfTrue(isStartCap), positions.y, cornerPosition);\n  }\n\n  vCornerOffset = offsetVec * offsetDirection * offsetScale;\n  vDashArray = instanceDashArrays;\n  vPathLength = L;\n  vec2 offsetFromStartOfPath = vCornerOffset;\n  if (isEnd) {\n    offsetFromStartOfPath += deltaA;\n  }\n  vec2 dir = isEnd ? dirA : dirB;\n  vPathPosition = vec2(\n    positions.y + positions.z * offsetDirection,\n    dot(offsetFromStartOfPath, dir)\n  );\n\n  return currPoint + vec3(vCornerOffset * width, 0.0);\n}\nvec3 lineJoin(vec3 prevPoint, vec3 currPoint, vec3 nextPoint) {\n\n  float relativePosition = positions.y;\n  bool isEnd = positions.x > EPSILON;\n  bool isJoint = positions.z > EPSILON;\n\n  vec2 widthPixels = vec2(clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0);\n\n  return lineJoin(\n    prevPoint, currPoint, nextPoint,\n    relativePosition, isEnd, isJoint,\n    billboard ? project_pixel_size_to_clipspace(widthPixels) : project_pixel_size(widthPixels)\n  );\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity) / 255.;\n  picking_setPickingColor(instancePickingColors);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec2 prevPosition64xyLow = mix(instanceNeighborPositions64xyLow.xy, instanceStartEndPositions64xyLow.xy, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec2 currPosition64xyLow = mix(instanceStartEndPositions64xyLow.xy, instanceStartEndPositions64xyLow.zw, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec2 nextPosition64xyLow = mix(instanceStartEndPositions64xyLow.zw, instanceNeighborPositions64xyLow.zw, isEnd);\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64xyLow, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64xyLow, ZERO_OFFSET);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64xyLow, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64xyLow);\n    currPosition = project_position(currPosition, currPosition64xyLow);\n    nextPosition = project_position(nextPosition, nextPosition64xyLow);\n\n    vec3 pos = lineJoin(prevPosition, currPosition, nextPosition);\n    gl_Position = project_common_position_to_clipspace(vec4(pos, 1.0));\n  }\n}\n",fs:m,modules:["project32","picking"]}}},{key:"initializeState",value:function(){var t=this;this.getAttributeManager().addInstanced({instanceStartPositions:{size:3,transition:x,accessor:"getPath",update:this.calculateStartPositions,noAlloc:!0},instanceEndPositions:{size:3,transition:x,accessor:"getPath",update:this.calculateEndPositions,noAlloc:!0},instanceStartEndPositions64xyLow:{size:4,update:this.calculateInstanceStartEndPositions64xyLow,noAlloc:!0},instanceLeftPositions:{size:3,accessor:"getPath",update:this.calculateLeftPositions,noAlloc:!0},instanceRightPositions:{size:3,accessor:"getPath",update:this.calculateRightPositions,noAlloc:!0},instanceNeighborPositions64xyLow:{size:4,update:this.calculateInstanceNeighborPositions64xyLow,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:x,defaultValue:1},instanceDashArrays:{size:2,accessor:"getDashArray"},instanceColors:{size:4,type:5121,accessor:"getColor",transition:x,defaultValue:y},instancePickingColors:{size:3,type:5121,accessor:function(e,i){var n=i.index,o=i.target;return t.encodePickingColor(n,o)}}}),this.setState({pathTesselator:new g({})})}},{key:"updateState",value:function(t){var i=t.oldProps,n=t.props,o=t.changeFlags;Object(a.a)(Object(r.a)(e.prototype),"updateState",this).call(this,{props:n,oldProps:i,changeFlags:o});var s=this.getAttributeManager();if(o.dataChanged||n.fp64!==i.fp64||o.updateTriggersChanged&&(o.updateTriggersChanged.all||o.updateTriggersChanged.getPath)){var l=this.state.pathTesselator;l.updateGeometry({data:n.data,getGeometry:n.getPath,positionFormat:n.positionFormat,fp64:this.use64bitPositions()}),this.setState({numInstances:l.instanceCount,bufferLayout:l.bufferLayout}),s.invalidateAll()}if(n.fp64!==i.fp64){var h=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(h)}),s.invalidateAll()}}},{key:"draw",value:function(t){var e=t.uniforms,i=this.context.viewport,n=this.props,o=n.rounded,s=n.billboard,r=n.miterLimit,a=n.widthUnits,l=n.widthScale,h=n.widthMinPixels,c=n.widthMaxPixels,u=n.dashJustified,p="pixels"===a?i.distanceScales.metersPerPixel[2]:1;this.state.model.setUniforms(Object.assign({},e,{jointType:Number(o),billboard:s,alignMode:Number(u),widthScale:l*p,miterLimit:r,widthMinPixels:h,widthMaxPixels:c})).draw()}},{key:"_getModel",value:function(t){return new c.a(t,Object.assign({},this.getShaders(),{id:this.props.id,geometry:new u.a({drawMode:4,attributes:{indices:new Uint16Array([0,2,1,1,2,4,1,4,3,3,4,5]),positions:new Float32Array([0,0,1,0,-1,0,0,1,0,1,-1,0,1,1,0,1,0,1])}}),isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"calculateStartPositions",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("startPositions")}},{key:"calculateEndPositions",value:function(t){var e=this.state.pathTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("endPositions")}},{key:"calculateInstanceStartEndPositions64xyLow",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.pathTesselator.get("startEndPositions64XyLow"):new Float32Array(4)}},{key:"calculateLeftPositions",value:function(t){var e=this.state.pathTesselator;t.value=e.get("leftPositions")}},{key:"calculateRightPositions",value:function(t){var e=this.state.pathTesselator;t.value=e.get("rightPositions")}},{key:"calculateInstanceNeighborPositions64xyLow",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.pathTesselator.get("neighborPositions64XyLow"):new Float32Array(4)}},{key:"clearPickingColor",value:function(t){for(var e=this.decodePickingColor(t),i=this.state.pathTesselator.bufferLayout,n=i[e],o=0,s=0;s<e;s++)o+=i[s];var r=this.getAttributeManager().attributes.instancePickingColors,a=r.value,l=o+n;a.fill(0,3*o,3*l),r.update({value:a})}}]),e}(h.a);_.layerName="PathLayer",_.defaultProps=b},4388:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n=i(23),o=i(25),s=i(299),r=i(107),a=i(338),l=i(30),h=i(4366),c=i(4305),u=i(4350),p=function(t){function e(){return Object(n.a)(this,e),Object(s.a)(this,Object(r.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(o.a)(e,[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(t){Object(a.a)(Object(r.a)(e.prototype),"setState",this).call(this,t),this.setLayerNeedsUpdate()}},{key:"getPickingInfo",value:function(t){return t.info}},{key:"renderLayers",value:function(){return null}},{key:"shouldRenderSubLayer",value:function(t,e){var i=this.props._subLayerProps;return e&&e.length||i&&i[t]}},{key:"getSubLayerClass",value:function(t,e){var i=this.props._subLayerProps;return i&&i[t]&&i[t].type||e}},{key:"getSubLayerProps",value:function(t){var e=this.props,i=e.opacity,n=e.pickable,o=e.visible,s=e.parameters,r=e.getPolygonOffset,a=e.highlightedObjectIndex,l=e.autoHighlight,h=e.highlightColor,c=e.coordinateSystem,u=e.coordinateOrigin,p=e.wrapLongitude,d=e.positionFormat,f=e.modelMatrix,v=e._subLayerProps,g={opacity:i,pickable:n,visible:o,parameters:s,getPolygonOffset:r,highlightedObjectIndex:a,autoHighlight:l,highlightColor:h,coordinateSystem:c,coordinateOrigin:u,wrapLongitude:p,positionFormat:d,modelMatrix:f};if(t){var m=v&&v[t.id],y=m&&m.updateTriggers;Object.assign(g,t,m,{id:"".concat(this.props.id,"-").concat(t.id),updateTriggers:Object.assign({all:this.props.updateTriggers.all},t.updateTriggers,y)})}return g}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var t=this.internalState.subLayers;t&&!this.needsUpdate()?c.a.log(3,"Composite layer reused subLayers ".concat(this),this.internalState.subLayers)():(t=this.renderLayers(),t=Object(u.b)(t,{filter:Boolean}),this.internalState.subLayers=t,c.a.log(2,"Composite layer rendered new subLayers ".concat(this),t)());var e=!0,i=!1,n=void 0;try{for(var o,s=t[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){o.value.parent=this}}catch(t){i=!0,n=t}finally{try{e||null==s.return||s.return()}finally{if(i)throw n}}}},{key:"isComposite",get:function(){return!0}}]),e}(h.a);p.layerName="CompositeLayer"},4403:function(t,e,i){"use strict";i.d(e,"a",(function(){return M}));var n=i(23),o=i(25),s=i(299),r=i(107),a=i(338),l=i(30),h=i(4366),c=i(4475),u=i(5216),p=i(4765),d=i(4711),f=i(4498),v=i(4369),g=i(4289),m=i(5268),y=g.a.Tesselator,b=m.a.fp64LowPart,x=function(t){function e(t){var i=t.data,o=t.getGeometry,a=t.fp64,l=t.positionFormat,h=t.IndexType,c=void 0===h?Uint32Array:h;return Object(n.a)(this,e),Object(s.a)(this,Object(r.a)(e).call(this,{data:i,getGeometry:o,fp64:a,positionFormat:l,attributes:{positions:{size:3},positions64xyLow:{size:2,fp64Only:!0},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:c,size:1}}}))}return Object(l.a)(e,t),Object(o.a)(e,[{key:"get",value:function(t){return"indices"===t?this.attributes.indices.subarray(0,this.vertexCount):this.attributes[t]}},{key:"getGeometrySize",value:function(t){return v.b(t,this.positionSize)}},{key:"updateGeometryAttributes",value:function(t,e){t=v.c(t,this.positionSize,e.geometrySize),this._updateIndices(t,e),this._updatePositions(t,e)}},{key:"_updateIndices",value:function(t,e){var i=e.geometryIndex,n=e.vertexStart,o=e.indexStart,s=this.attributes,r=this.indexLayout,a=this.typedArrayManager,l=s.indices,h=l.length,c=o,u=v.a(t,this.positionSize);h<c+u.length&&(h=2*(c+u.length),l=a.allocate(l,h,{type:l.constructor,size:1,copy:!0}));for(var p=0;p<u.length;p++)l[c++]=u[p]+n;r[i]=u.length,s.indices=l}},{key:"_updatePositions",value:function(t,e){for(var i=e.vertexStart,n=e.geometrySize,o=this.attributes,s=o.positions,r=o.positions64xyLow,a=o.vertexValid,l=this.fp64,h=this.positionSize,c=i,u=t.positions,p=t.holeIndices,d=0;d<n;d++){var f=u[d*h],v=u[d*h+1],g=h>2?u[d*h+2]:0;s[3*c]=f,s[3*c+1]=v,s[3*c+2]=g,l&&(r[2*c]=b(f),r[2*c+1]=b(v)),a[c]=1,c++}if(p)for(var m=0;m<p.length;m++)a[i+p[m]/h-1]=0;a[i+n-1]=0}}]),e}(y),_="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying float isValid;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec2 positions64xyLow;\n  vec2 nextPositions64xyLow;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNG_LAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_AUTO_OFFSET) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n  vec3 pos;\n  vec2 pos64xyLow;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64xyLow = mix(props.positions64xyLow, props.nextPositions64xyLow, vertexPositions.x);\n  isValid = vertexValid;\n#else\n  pos = props.positions;\n  pos64xyLow = props.positions64xyLow;\n  isValid = 1.0;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n\n  vec4 position_commonspace;\n  gl_Position = project_position_to_clipspace(pos, pos64xyLow, vec3(0.), position_commonspace);\n\n  if (extruded) {\n#ifdef IS_SIDE_VERTEX\n    normal = vec3(props.positions.y - props.nextPositions.y, props.nextPositions.x - props.positions.x, 0.0);\n    normal = project_offset_normal(normal);\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity) / 255.0;\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity) / 255.0;\n  }\n  picking_setPickingColor(props.pickingColors);\n}\n",P="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec2 positions64xyLow;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(_,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64xyLow = positions64xyLow;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),w="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec2 instancePositions64xyLow;\nattribute vec3 nextPositions;\nattribute vec2 nextPositions64xyLow;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(_,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = instancePositions;\n  props.positions64xyLow = instancePositions64xyLow;\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n  props.nextPositions = nextPositions;\n  props.nextPositions64xyLow = nextPositions64xyLow;\n\n  calculatePosition(props);\n}\n"),k=[0,0,0,255],C=new c.a,L={filled:!0,extruded:!1,wireframe:!1,fp64:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:function(t){return t.polygon}},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:k},getLineColor:{type:"accessor",value:k},material:C},E={enter:function(t,e){return e.length?e.subarray(e.length-t.length):t}},M=function(t){function e(){return Object(n.a)(this,e),Object(s.a)(this,Object(r.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(o.a)(e,[{key:"getShaders",value:function(t){return{vs:t,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying float isValid;\n\nvoid main(void) {\n  if (isValid < 0.5) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",defines:{},modules:[this.use64bitProjection()?"project64":"project32","gouraud-lighting","picking"]}}},{key:"initializeState",value:function(){var t=this,e=this.context.gl;this.setState({numInstances:0,polygonTesselator:new x({IndexType:!e||Object(u.b)(e,p.a.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});var i=this.getAttributeManager();i.remove(["instancePickingColors"]),i.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:!0},positions:{size:3,transition:E,accessor:"getPolygon",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{positions:{offset:0,divisor:0},instancePositions:{offset:0,divisor:1},nextPositions:{offset:12,divisor:1}}},positions64xyLow:{size:2,update:this.calculatePositionsLow,noAlloc:!0,shaderAttributes:{positions64xyLow:{offset:0,divisor:0},instancePositions64xyLow:{offset:0,divisor:1},nextPositions64xyLow:{offset:8,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:!0},elevations:{size:1,transition:E,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:4,type:5121,transition:E,accessor:"getFillColor",defaultValue:k,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:4,type:5121,transition:E,accessor:"getLineColor",defaultValue:k,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:function(e,i){var n=i.index,o=i.target;return t.encodePickingColor(n,o)},shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}},{key:"draw",value:function(t){var e=t.uniforms,i=this.props,n=i.extruded,o=i.filled,s=i.wireframe,r=i.elevationScale,a=this.state,l=a.topModel,h=a.sideModel,c=a.polygonTesselator,u=Object.assign({},e,{extruded:Boolean(n),elevationScale:r});h&&(h.setInstanceCount(c.instanceCount-1),h.setUniforms(u),s&&(h.setDrawMode(3),h.setUniforms({isWireframe:!0}).draw()),o&&(h.setDrawMode(6),h.setUniforms({isWireframe:!1}).draw())),l&&(l.setVertexCount(c.get("indices").length),l.setUniforms(u).draw())}},{key:"updateState",value:function(t){Object(a.a)(Object(r.a)(e.prototype),"updateState",this).call(this,t),this.updateGeometry(t);var i=t.props,n=t.oldProps,o=this.getAttributeManager();(i.fp64!==n.fp64||i.filled!==n.filled||i.extruded!==n.extruded)&&(this.state.models&&this.state.models.forEach((function(t){return t.delete()})),this.setState(this._getModels(this.context.gl)),o.invalidateAll())}},{key:"updateGeometry",value:function(t){var e=t.props,i=t.oldProps,n=t.changeFlags;if(n.dataChanged||e.fp64!==i.fp64||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){var o=this.state.polygonTesselator;o.updateGeometry({data:e.data,getGeometry:e.getPolygon,positionFormat:e.positionFormat,fp64:this.use64bitPositions()}),this.setState({numInstances:o.instanceCount,bufferLayout:o.bufferLayout}),this.getAttributeManager().invalidateAll()}}},{key:"_getModels",value:function(t){var e,i,n=this.props,o=n.id,s=n.filled,r=n.extruded;if(s){var a=this.getShaders(P);a.defines.NON_INSTANCED_MODEL=1,e=new d.a(t,Object.assign({},a,{id:"".concat(o,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0,shaderCache:this.context.shaderCache}))}return r&&((i=new d.a(t,Object.assign({},this.getShaders(w),{id:"".concat(o,"-side"),geometry:new f.a({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,1,0,1,0,0,1,0])}}}),instanceCount:0,isInstanced:1,shaderCache:this.context.shaderCache}))).userData.excludeAttributes={indices:!0}),{models:[i,e].filter(Boolean),topModel:e,sideModel:i}}},{key:"calculateIndices",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.indexLayout,t.value=e.get("indices")}},{key:"calculatePositions",value:function(t){var e=this.state.polygonTesselator;t.bufferLayout=e.bufferLayout,t.value=e.get("positions")}},{key:"calculatePositionsLow",value:function(t){var e=this.use64bitPositions();t.constant=!e,t.value=e?this.state.polygonTesselator.get("positions64xyLow"):new Float32Array(2)}},{key:"calculateVertexValid",value:function(t){t.value=this.state.polygonTesselator.get("vertexValid")}},{key:"clearPickingColor",value:function(t){for(var e=this.decodePickingColor(t),i=this.state.polygonTesselator.bufferLayout,n=i[e],o=0,s=0;s<e;s++)o+=i[s];var r=this.getAttributeManager().attributes.pickingColors,a=r.value,l=o+n;a.fill(0,3*o,3*l),r.update({value:a})}}]),e}(h.a);M.layerName="SolidPolygonLayer",M.defaultProps=L},4412:function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n,a,l,h,c,d,f,g=e&&e.length,m=g?e[0]*i:t.length,y=o(t,0,m,i,!0),b=[];if(!y||y.next===y.prev)return b;if(g&&(y=function(t,e,i,n){var r,a,l,h,c,d=[];for(r=0,a=e.length;r<a;r++)l=e[r]*n,h=r<a-1?e[r+1]*n:t.length,(c=o(t,l,h,n,!1))===c.next&&(c.steiner=!0),d.push(v(c));for(d.sort(u),r=0;r<d.length;r++)p(d[r],i),i=s(i,i.next);return i}(t,e,y,i)),t.length>80*i){n=l=t[0],a=h=t[1];for(var x=i;x<m;x+=i)(c=t[x])<n&&(n=c),(d=t[x+1])<a&&(a=d),c>l&&(l=c),d>h&&(h=d);f=0!==(f=Math.max(l-n,h-a))?1/f:0}return r(y,b,i,n,a,f),b}function o(t,e,i,n,o){var s,r;if(o===M(t,e,i,n)>0)for(s=e;s<i;s+=n)r=C(s,t[s],t[s+1],r);else for(s=i-n;s>=e;s-=n)r=C(s,t[s],t[s+1],r);return r&&b(r,r.next)&&(L(r),r=r.next),r}function s(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!b(n,n.next)&&0!==y(n.prev,n,n.next))n=n.next;else{if(L(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function r(t,e,i,n,o,u,p){if(t){!p&&u&&function(t,e,i,n){var o=t;do{null===o.z&&(o.z=f(o.x,o.y,e,i,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,i,n,o,s,r,a,l,h=1;do{for(i=t,t=null,s=null,r=0;i;){for(r++,n=i,a=0,e=0;e<h&&(a++,n=n.nextZ);e++);for(l=h;a>0||l>0&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(o=i,i=i.nextZ,a--):(o=n,n=n.nextZ,l--),s?s.nextZ=o:t=o,o.prevZ=s,s=o;i=n}s.nextZ=null,h*=2}while(r>1)}(o)}(t,n,o,u);for(var d,v,g=t;t.prev!==t.next;)if(d=t.prev,v=t.next,u?l(t,n,o,u):a(t))e.push(d.i/i),e.push(t.i/i),e.push(v.i/i),L(t),t=v.next,g=v.next;else if((t=v)===g){p?1===p?r(t=h(s(t),e,i),e,i,n,o,u,2):2===p&&c(t,e,i,n,o,u):r(s(t),e,i,n,o,u,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(y(e,i,n)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(g(e.x,e.y,i.x,i.y,n.x,n.y,o.x,o.y)&&y(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function l(t,e,i,n){var o=t.prev,s=t,r=t.next;if(y(o,s,r)>=0)return!1;for(var a=o.x<s.x?o.x<r.x?o.x:r.x:s.x<r.x?s.x:r.x,l=o.y<s.y?o.y<r.y?o.y:r.y:s.y<r.y?s.y:r.y,h=o.x>s.x?o.x>r.x?o.x:r.x:s.x>r.x?s.x:r.x,c=o.y>s.y?o.y>r.y?o.y:r.y:s.y>r.y?s.y:r.y,u=f(a,l,e,i,n),p=f(h,c,e,i,n),d=t.prevZ,v=t.nextZ;d&&d.z>=u&&v&&v.z<=p;){if(d!==t.prev&&d!==t.next&&g(o.x,o.y,s.x,s.y,r.x,r.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==t.prev&&v!==t.next&&g(o.x,o.y,s.x,s.y,r.x,r.y,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=u;){if(d!==t.prev&&d!==t.next&&g(o.x,o.y,s.x,s.y,r.x,r.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=p;){if(v!==t.prev&&v!==t.next&&g(o.x,o.y,s.x,s.y,r.x,r.y,v.x,v.y)&&y(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function h(t,e,i){var n=t;do{var o=n.prev,r=n.next.next;!b(o,r)&&x(o,n,n.next,r)&&w(o,r)&&w(r,o)&&(e.push(o.i/i),e.push(n.i/i),e.push(r.i/i),L(n),L(n.next),n=t=r),n=n.next}while(n!==t);return s(n)}function c(t,e,i,n,o,a){var l=t;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&m(l,h)){var c=k(l,h);return l=s(l,l.next),c=s(c,c.next),r(l,e,i,n,o,a),void r(c,e,i,n,o,a)}h=h.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function p(t,e){if(e=function(t,e){var i,n=e,o=t.x,s=t.y,r=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=o&&a>r){if(r=a,a===o){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(o===r)return i;var l,h=i,c=i.x,u=i.y,p=1/0;n=i;do{o>=n.x&&n.x>=c&&o!==n.x&&g(s<u?o:r,s,c,u,s<u?r:o,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(o-n.x),w(n,t)&&(l<p||l===p&&(n.x>i.x||n.x===i.x&&d(i,n)))&&(i=n,p=l)),n=n.next}while(n!==h);return i}(t,e)){var i=k(e,t);s(e,e.next),s(i,i.next)}}function d(t,e){return y(t.prev,t,e.prev)<0&&y(e.next,t,t.next)<0}function f(t,e,i,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function g(t,e,i,n,o,s,r,a){return(o-r)*(e-a)-(t-r)*(s-a)>=0&&(t-r)*(n-a)-(i-r)*(e-a)>=0&&(i-r)*(s-a)-(o-r)*(n-a)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&x(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var i=t,n=!1,o=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&o<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(y(t.prev,t,e.prev)||y(t,e.prev,e))||b(t,e)&&y(t.prev,t,t.next)>0&&y(e.prev,e,e.next)>0)}function y(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,i,n){var o=P(y(t,e,i)),s=P(y(t,e,n)),r=P(y(i,n,t)),a=P(y(i,n,e));return o!==s&&r!==a||(!(0!==o||!_(t,i,e))||(!(0!==s||!_(t,n,e))||(!(0!==r||!_(i,t,n))||!(0!==a||!_(i,e,n)))))}function _(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function P(t){return t>0?1:t<0?-1:0}function w(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function k(t,e){var i=new E(t.i,t.x,t.y),n=new E(e.i,e.x,e.y),o=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=o,o.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function C(t,e,i,n){var o=new E(t,e,i);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function L(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function E(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function M(t,e,i,n){for(var o=0,s=e,r=i-n;s<i;s+=n)o+=(t[r]-t[s])*(t[s+1]+t[r+1]),r=s;return o}t.exports=n,t.exports.default=n,n.deviation=function(t,e,i,n){var o=e&&e.length,s=o?e[0]*i:t.length,r=Math.abs(M(t,0,s,i));if(o)for(var a=0,l=e.length;a<l;a++){var h=e[a]*i,c=a<l-1?e[a+1]*i:t.length;r-=Math.abs(M(t,h,c,i))}var u=0;for(a=0;a<n.length;a+=3){var p=n[a]*i,d=n[a+1]*i,f=n[a+2]*i;u+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===r&&0===u?0:Math.abs((u-r)/r)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var s=0;s<t[o].length;s++)for(var r=0;r<e;r++)i.vertices.push(t[o][s][r]);o>0&&(n+=t[o-1].length,i.holes.push(n))}return i}},4475:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var n=i(23),o=i(299),s=i(107),r=i(22),a=i(30),l={ambient:.35,diffuse:.6,shininess:32,specularColor:[30,30,30]},h=function(t){function e(t){var i;return Object(n.a)(this,e),i=Object(o.a)(this,Object(s.a)(e).call(this,t)),t=Object.assign({},l,t),Object.assign(Object(r.a)(i),t),i}return Object(a.a)(e,t),e}((function t(){Object(n.a)(this,t)}))},4719:function(t,e,i){"use strict";i.r(e),i.d(e,"getLayer",(function(){return D}));var n=i(0),o=i.n(n),s=i(5),r=i.n(s),a=i(23),l=i(25),h=i(299),c=i(107),u=i(30),p=i(4475),d=i(4438),f=i(4388),v=i(4403),g=i(4382),m=i(4369),y=new p.a,b={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,lineDashJustified:!1,fp64:!1,getPolygon:{type:"accessor",value:function(t){return t.polygon}},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1},getLineDashArray:{type:"accessor",value:[0,0]},getElevation:{type:"accessor",value:1e3},material:y},x=function(t){function e(){return Object(a.a)(this,e),Object(h.a)(this,Object(c.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(l.a)(e,[{key:"initializeState",value:function(){this.state={paths:[]}}},{key:"updateState",value:function(t){t.oldProps;var e=t.props,i=t.changeFlags;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon))&&(this.state.paths=this._getPaths(e))}},{key:"getPickingInfo",value:function(t){var e=t.info;return Object.assign(e,{object:e.object&&e.object.object||e.object})}},{key:"_getPaths",value:function(t){var e=t.data,i=t.getPolygon,n=[],o="XY"===t.positionFormat?2:3,s=Object(d.a)(e),r=s.iterable,a=s.objectInfo,l=!0,h=!1,c=void 0;try{for(var u,p=r[Symbol.iterator]();!(l=(u=p.next()).done);l=!0){var f=u.value;a.index++;var v=m.c(i(f,a),o),g=v.positions,y=v.holeIndices;if(y)for(var b=0;b<=y.length;b++){var x=g.subarray(y[b-1]||0,y[b]||g.length);n.push({path:x,object:f})}else n.push({path:g,object:f})}}catch(t){h=!0,c=t}finally{try{l||null==p.return||p.return()}finally{if(h)throw c}}return n}},{key:"_getAccessor",value:function(t){return"function"==typeof t?function(e){return t(e.object)}:t}},{key:"renderLayers",value:function(){var t=this.props,e=t.data,i=t.stroked,n=t.filled,o=t.extruded,s=t.wireframe,r=t.elevationScale,a=t.transitions,l=this.props,h=l.lineWidthUnits,c=l.lineWidthScale,u=l.lineWidthMinPixels,p=l.lineWidthMaxPixels,d=l.lineJointRounded,f=l.lineMiterLimit,m=l.lineDashJustified,y=l.fp64,b=this.props,x=b.getFillColor,_=b.getLineColor,P=b.getLineWidth,w=b.getLineDashArray,k=b.getElevation,C=b.getPolygon,L=b.updateTriggers,E=b.material,M=this.state.paths,S=this.getSubLayerClass("fill",v.a),A=this.getSubLayerClass("stroke",g.a),j=this.shouldRenderSubLayer("fill",M)&&new S({extruded:o,elevationScale:r,fp64:y,filled:n,wireframe:s,getElevation:k,getFillColor:x,getLineColor:_,material:E,transitions:a},this.getSubLayerProps({id:"fill",updateTriggers:{getPolygon:L.getPolygon,getElevation:L.getElevation,getFillColor:L.getFillColor,getLineColor:L.getLineColor}}),{data:e,getPolygon:C});return[!o&&j,!o&&i&&this.shouldRenderSubLayer("stroke",M)&&new A({fp64:y,widthUnits:h,widthScale:c,widthMinPixels:u,widthMaxPixels:p,rounded:d,miterLimit:f,dashJustified:m,transitions:a&&{getWidth:a.getLineWidth,getColor:a.getLineColor,getPath:a.getPolygon},getColor:this._getAccessor(_),getWidth:this._getAccessor(P),getDashArray:this._getAccessor(w)},this.getSubLayerProps({id:"stroke",updateTriggers:{getWidth:L.getLineWidth,getColor:L.getLineColor,getDashArray:L.getLineDashArray}}),{data:M,getPath:function(t){return t.path}}),o&&j]}}]),e}(f.a);x.layerName="PolygonLayer",x.defaultProps=b;var _=i(4317),P=i(4330),w=i(4320),k=i(586),C=i(4381),L=i(468),E=i(980),M=i(4338);function S(t,e,i){let{break_points:n,num_buckets:o}=t;if(!e)return[];if(void 0===n||0===n.length){const t=o?parseInt(o,10):10,[n,s]=Object(k.extent)(e,i);if(void 0===n)return[];const r=(s-n)/t,a=0===r?0:Math.max(0,Math.ceil(Math.log10(1/r))),l=s>s.toFixed(a)?1:0;return new Array(t+1+l).fill().map((t,e)=>(n+e*r).toFixed(a))}return n.sort((t,e)=>parseFloat(t)-parseFloat(e))}function A(t,e,i){let{break_points:n,num_buckets:o,linear_color_scheme:s,opacity:r}=t;const a=n||o?S({break_points:n,num_buckets:o},e,i):null,l=Array.isArray(s)?new L.a({colors:s,id:"custom"}):Object(E.a)().get(s);let h,c;if(null!==a){const t=a.length-1,e=t>1?l.getColors(t):[l.colors[l.colors.length-1]],i=e[0],n=e[e.length-1];e.unshift(i),e.push(n);const o=a.map(t=>parseFloat(t));h=Object(C.scaleThreshold)().domain(o).range(e),c=e=>e>a[t]||e<a[0]}else h=l.createLinearScale(Object(k.extent)(e,i)),c=()=>!1;return t=>{const e=i(t),n=Object(M.hexToRGB)(h(e));return c(e)?n[3]=0:n[3]=r/100*255,n}}var j=i(4319),O=i(4314),T=i(4313);function N(t){return"geometry"in t.polygon?t.polygon.geometry.coordinates[0]:t.polygon}var F=i(4302);function z(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function I(){return(I=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function D(t,e,i,n,s,r,a){const l=t,h=l.fill_color_picker,c=l.stroke_color_picker;let u=[...e.data.features];if(null!=a&&a.forEach(t=>{u=u.filter(e=>t(e))}),l.js_data_mutator){const t=Object(T.a)(l.js_data_mutator);u=t(u)}const p=l.metric?l.metric.label||l.metric:null,d=null===l.metric?()=>[h.r,h.g,h.b,255*h.a]:A(l,u,t=>t[p]),f=t=>{const e=d(t);return s.length>0&&!s.includes(t[l.line_column])&&(e[3]/=2),e},v=l.line_column&&l.metric&&["json","geohash","zipcode"].includes(l.line_type)?function(t){return e=>{const i=t.metric.label||t.metric;return o.a.createElement("div",{className:"deckgl-tooltip"},e.object.name&&o.a.createElement(w.a,{label:"name: ",value:""+e.object.name}),e.object[t.line_column]&&o.a.createElement(w.a,{label:t.line_column+": ",value:""+e.object[t.line_column]}),t.metric&&o.a.createElement(w.a,{label:i+": ",value:""+e.object[i]}))}}(l):void 0;return new x(I({id:"path-layer-"+l.slice_id,data:u,pickable:!0,filled:l.filled,stroked:l.stroked,getPolygon:N,getFillColor:f,getLineColor:[c.r,c.g,c.b,255*c.a],getLineWidth:l.line_width,extruded:l.extruded,getElevation:t=>function(t,e){return 0===e(t)[3]?0:t.elevation}(t,f),elevationScale:l.multiplier,fp64:!0},Object(j.a)(l,n,v,r)))}const V={formData:r.a.object.isRequired,payload:r.a.object.isRequired,setControlValue:r.a.func.isRequired,viewport:r.a.object.isRequired,onAddFilter:r.a.func,width:r.a.number.isRequired,height:r.a.number.isRequired},R={onAddFilter(){}};class B extends o.a.Component{constructor(t){super(t),z(this,"containerRef",o.a.createRef()),z(this,"setTooltip",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)}),this.state=B.getDerivedStateFromProps(t),this.getLayers=this.getLayers.bind(this),this.onSelect=this.onSelect.bind(this),this.onValuesChange=this.onValuesChange.bind(this)}static getDerivedStateFromProps(t,e){const{width:i,height:n,formData:o,payload:s}=t;if(e&&s.form_data===e.formData)return null;const r=s.data.features||[],a=r.map(t=>t.__timestamp),l=s.form_data.time_grain_sqla||s.form_data.granularity||"P1D",{start:h,end:c,getStep:u,values:p,disabled:d}=Object(O.a)(a,l);let{viewport:f}=t;return o.autozoom&&(f=Object(F.a)(f,{width:i,height:n,points:r.flatMap(N)})),{start:h,end:c,getStep:u,values:p,disabled:d,viewport:f,selected:[],lastClick:0,formData:s.form_data}}onSelect(t){const{formData:e,onAddFilter:i}=this.props,n=new Date,o=n-this.state.lastClick<=250,s=[...this.state.selected];if(o)s.splice(0,s.length,t);else if(e.toggle_polygons){const e=s.indexOf(t);-1===e?s.push(t):s.splice(e,1)}else s.splice(0,1,t);this.setState({selected:s,lastClick:n}),e.table_filter&&i(e.line_column,s,!1,!0)}onValuesChange(t){this.setState({values:Array.isArray(t)?t:[t,t+this.state.getStep(t)]})}getLayers(t){if(void 0===this.props.payload.data.features)return[];const e=[];return t[0]===t[1]||t[1]===this.end?e.push(e=>e.__timestamp>=t[0]&&e.__timestamp<=t[1]):e.push(e=>e.__timestamp>=t[0]&&e.__timestamp<t[1]),[D(this.props.formData,this.props.payload,this.props.onAddFilter,this.setTooltip,this.state.selected,this.onSelect,e)]}render(){const{payload:t,formData:e,setControlValue:i}=this.props,{start:n,end:s,getStep:r,values:a,disabled:l,viewport:h}=this.state,c=e,u=c.metric?c.metric.label||c.metric:null,p=function(t,e,i){const n=S(t,e,i),o=A(t,e,i),s={};return n.slice(1).forEach((e,i)=>{const r=n[i]+" - "+n[i+1],a=.5*(parseFloat(n[i])+parseFloat(n[i+1])),l=t.metric?t.metric.label||t.metric:null;s[r]={color:o({[l||t.metric]:a}),enabled:!0}}),s}(e,t.data.features,t=>t[u]);return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement(_.a,{ref:this.containerRef,aggregation:!0,getLayers:this.getLayers,start:n,end:s,getStep:r,values:a,disabled:l,viewport:h,width:this.props.width,height:this.props.height,mapboxApiAccessToken:t.data.mapboxApiKey,mapStyle:e.mapbox_style,setControlValue:i,onValuesChange:this.onValuesChange,onViewportChange:this.onViewportChange},null!==e.metric&&o.a.createElement(P.a,{categories:p,position:e.legend_position,format:e.legend_format})))}}B.propTypes=V,B.defaultProps=R;e.default=B}}]);