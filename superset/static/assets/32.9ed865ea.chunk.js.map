{"version":3,"sources":["webpack:///./src/CRUD/crud.less","webpack:///./src/CRUD/CollectionTable.tsx","webpack:///./src/CRUD/Field.tsx","webpack:///./src/CRUD/Fieldset.jsx","webpack:///./src/CRUD/crud.less?5888","webpack:///./src/CRUD/utils.js","webpack:///./src/components/CertifiedIcon/index.tsx","webpack:///./src/components/DatabaseSelector/index.tsx","webpack:///./src/components/EditableTitle/index.tsx","webpack:///./src/components/RefreshLabel/index.tsx","webpack:///./src/components/TableSelector/index.tsx","webpack:///./src/datasource/DatasourceEditor.jsx"],"names":["propTypes","children","PropTypes","node","isRequired","onChange","func","item","object","title","compact","bool","defaultProps","Fieldset","React","PureComponent","constructor","props","fieldKey","val","render","propExtender","field","value","recurseReactClone","Field","type","Children","child","newChild","name","cloneElement","DatasourceContainer","styled","div","theme","colors","warning","base","typography","weights","bold","FlexRowContainer","gridUnit","StyledTableTabs","Tabs","EditLockContainer","supersetTheme","sizes","s","ColumnButtonWrapper","checkboxGenerator","d","DATA_TYPES","DATASOURCE_TYPES_ARR","key","label","t","DATASOURCE_TYPES","o","CollectionTabTitle","collection","length","string","array","ColumnCollectionTable","columns","editableColumnName","showExpression","allowAddItem","allowEditDataType","itemGenerator","column_name","groupby","is_dttm","filterable","v","onItemChange","StackedField","formElement","FormContainer","datasource","addSuccessToast","addDangerToast","DatasourceEditor","state","errors","isDruid","datasource_type","isSqla","isEditMode","databaseColumns","col","expression","calculatedColumns","metadataLoading","activeTabKey","datasourceType","sql","virtual","physical","onChangeEditMode","onDatasourcePropChange","onDatasourceChange","syncMetadata","setColumns","validateAndChange","handleTabSelect","allowEditSource","isFeatureEnabled","FeatureFlag","DISABLE_DATASET_SOURCE_EDIT","newDatasource","setState","prevState","attr","onDatasourceTypeChange","obj","validate","updateColumns","cols","databaseColumnNames","currentCols","agg","finalColumns","results","added","modified","removed","currentCol","push","id","shortid","generate","endpoint","SupersetClient","get","then","json","join","catch","response","getClientErrorObject","error","statusText","findDuplicates","arr","accessor","seen","dups","callback","metrics","metric_name","noFilterCalcCols","renderSettingsFieldset","data","result","pk","text","renderAdvancedFieldset","renderSpatialTab","spatials","all_cols","allCols","config","renderSourceFieldset","database","schema","table","table_name","undefined","grayscale","renderErrors","marginBottom","err","renderMetricCollection","verbose_name","metric","certification","details","certified_by","certifiedBy","warning_markdown","warningMarkdown","JSON","parse","extra","certification_details","_","record","is_certified","description","d3format","__expanded","withToasts"],"mappings":"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","file":"32.9ed865ea.chunk.js","sourcesContent":["exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n/************************************************************************/\\n/* COLORS                                                               */\\n/* Please attempt to use and standardize on these colors,               */\\n/* rather than including specific color values in                       */\\n/* component styles. This will allow us to more easily adjust theming   */\\n/************************************************************************/\\n/**************************** text-specific *****************************/\\n/***************************** status colors ****************************/\\n/* general component effects */\\n/************************************************************************/\\n/* OPACITIES                                                            */\\n/* Used in LESS filters, e.g. fade(@someColorVar, @someOpacityBelow)    */\\n/************************************************************************/\\n/************************************************************************/\\n/* SHADES & TINTS                                                       */\\n/* Used in LESS filters for shadint/tinting,                            */\\n/* e.g. shade(@someColorVar, @colorstop-one) to darken                  */\\n/* or tint(@someColorVar, @colorstop-one) to lighten                    */\\n/************************************************************************/\\n/************************************************************************/\\n/* LAYOUT                                                               */\\n/* Widths and heights of things, that might be referred to often        */\\n/************************************************************************/\\n/* builder component pane */\\n/************************************************************************/\\n/* Z-INDEX                                                              */\\n/* Think of the site as \\\"layers\\\" rather than an arms race of numbers    */\\n/* Keep these to a minimum                                              */\\n/* Label semantic \\\"layers\\\" and add comments for usage notes             */\\n/* Use double dash modifiers to step up/down from a base layer          */\\n/* e.g. z-whatever--modifier                                            */\\n/************************************************************************/\\n/************************ toast messages, popovers **********************/\\n/***** filters, dashboard editor widgets, Explore reloading overlay *****/\\n/******************************** charts ********************************/\\n/************************************************************************/\\n/* TYPOGRAPHY                                                           */\\n/* Commonly used font weights, line heights, etc. These should be the   */\\n/* core values used to build more complex styles for headers, etc.      */\\n/************************************************************************/\\n/************************************************************************/\\n/* TRANSITIONS                                                          */\\n/* Timing and easings presets used in CSS transitions                   */\\n/************************************************************************/\\n/************************************************************************/\\n/* BORDER RADII                                                         */\\n/* Standard border-radius settings                                      */\\n/************************************************************************/\\n/************************************************************************/\\n/* BOOTSTRAP/BOOTSWATCH/COSMO                                           */\\n/* These are the legacy Cosmo theme overrides to Bootswatch's           */\\n/* overrides to Bootstrap. We should consolidate/deprecate these        */\\n/* in favor of custom/reusable CSS wherever possible                    */\\n/************************************************************************/\\n/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n.CRUD .text-right {\\n  text-align: right;\\n}\\n.CRUD .empty-collection {\\n  padding: 10px;\\n}\\n.CRUD .control-label {\\n  font-weight: 700;\\n}\\n.CRUD .tiny-cell {\\n  width: 5px;\\n}\\n.CRUD i.fa-caret-down,\\n.CRUD i.fa-caret-up {\\n  width: 5px;\\n}\\n.CRUD td.expanded {\\n  border-top: 0;\\n  padding: 0;\\n}\\n.CRUD .frame {\\n  border: 1px solid #a3a3a3;\\n  border-radius: 4px;\\n  padding: 10;\\n  background: #f7f7f7;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"G:/workspace/boke-pro/superset-all/superset/superset-frontend/src/CRUD/crud.less\",\"G:/workspace/boke-pro/superset-all/superset/superset-frontend/src/CRUD/G:/workspace/boke-pro/superset-all/superset/superset-frontend/src/CRUD/crud.less\"],\"names\":[],\"mappings\":\"AAAA;;;;;;;;;;;;;;;;;GAiBG;AACH;;;;;;;;;;;;;;;;;GAiBG;AACH,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,+BAA+B;AAC/B,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,4BAA4B;AAC5B,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E,0EAA0E;AAC1E;;;;;;;;;;;;;;;;;GAiBG;ACvFH;EAEI,kBAAA;CDwFH;AC1FD;EAMI,cAAA;CDuFH;AC7FD;EAUI,iBAAA;CDsFH;AChGD;EAcI,WAAA;CDqFH;ACnGD;;EAmBI,WAAA;CDoFH;ACvGD;EAuBI,cAAA;EACA,WAAA;CDmFH;AC3GD;EA4BI,0BAAA;EACA,mBAAA;EACA,YAAA;EACA,oBAAA;CDkFH\",\"file\":\"crud.less\",\"sourcesContent\":[\"/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n/************************************************************************/\\n/* COLORS                                                               */\\n/* Please attempt to use and standardize on these colors,               */\\n/* rather than including specific color values in                       */\\n/* component styles. This will allow us to more easily adjust theming   */\\n/************************************************************************/\\n/**************************** text-specific *****************************/\\n/***************************** status colors ****************************/\\n/* general component effects */\\n/************************************************************************/\\n/* OPACITIES                                                            */\\n/* Used in LESS filters, e.g. fade(@someColorVar, @someOpacityBelow)    */\\n/************************************************************************/\\n/************************************************************************/\\n/* SHADES & TINTS                                                       */\\n/* Used in LESS filters for shadint/tinting,                            */\\n/* e.g. shade(@someColorVar, @colorstop-one) to darken                  */\\n/* or tint(@someColorVar, @colorstop-one) to lighten                    */\\n/************************************************************************/\\n/************************************************************************/\\n/* LAYOUT                                                               */\\n/* Widths and heights of things, that might be referred to often        */\\n/************************************************************************/\\n/* builder component pane */\\n/************************************************************************/\\n/* Z-INDEX                                                              */\\n/* Think of the site as \\\"layers\\\" rather than an arms race of numbers    */\\n/* Keep these to a minimum                                              */\\n/* Label semantic \\\"layers\\\" and add comments for usage notes             */\\n/* Use double dash modifiers to step up/down from a base layer          */\\n/* e.g. z-whatever--modifier                                            */\\n/************************************************************************/\\n/************************ toast messages, popovers **********************/\\n/***** filters, dashboard editor widgets, Explore reloading overlay *****/\\n/******************************** charts ********************************/\\n/************************************************************************/\\n/* TYPOGRAPHY                                                           */\\n/* Commonly used font weights, line heights, etc. These should be the   */\\n/* core values used to build more complex styles for headers, etc.      */\\n/************************************************************************/\\n/************************************************************************/\\n/* TRANSITIONS                                                          */\\n/* Timing and easings presets used in CSS transitions                   */\\n/************************************************************************/\\n/************************************************************************/\\n/* BORDER RADII                                                         */\\n/* Standard border-radius settings                                      */\\n/************************************************************************/\\n/************************************************************************/\\n/* BOOTSTRAP/BOOTSWATCH/COSMO                                           */\\n/* These are the legacy Cosmo theme overrides to Bootswatch's           */\\n/* overrides to Bootstrap. We should consolidate/deprecate these        */\\n/* in favor of custom/reusable CSS wherever possible                    */\\n/************************************************************************/\\n/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n.CRUD .text-right {\\n  text-align: right;\\n}\\n.CRUD .empty-collection {\\n  padding: 10px;\\n}\\n.CRUD .control-label {\\n  font-weight: 700;\\n}\\n.CRUD .tiny-cell {\\n  width: 5px;\\n}\\n.CRUD i.fa-caret-down,\\n.CRUD i.fa-caret-up {\\n  width: 5px;\\n}\\n.CRUD td.expanded {\\n  border-top: 0;\\n  padding: 0;\\n}\\n.CRUD .frame {\\n  border: 1px solid #a3a3a3;\\n  border-radius: 4px;\\n  padding: 10;\\n  background: #f7f7f7;\\n}\\n\",\"/**\\n * Licensed to the Apache Software Foundation (ASF) under one\\n * or more contributor license agreements.  See the NOTICE file\\n * distributed with this work for additional information\\n * regarding copyright ownership.  The ASF licenses this file\\n * to you under the Apache License, Version 2.0 (the\\n * \\\"License\\\"); you may not use this file except in compliance\\n * with the License.  You may obtain a copy of the License at\\n *\\n *   http://www.apache.org/licenses/LICENSE-2.0\\n *\\n * Unless required by applicable law or agreed to in writing,\\n * software distributed under the License is distributed on an\\n * \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\\n * KIND, either express or implied.  See the License for the\\n * specific language governing permissions and limitations\\n * under the License.\\n */\\n@import '../../stylesheets/less/variables.less';\\n\\n.CRUD {\\n  .text-right {\\n    text-align: right;\\n  }\\n\\n  .empty-collection {\\n    padding: 10px;\\n  }\\n\\n  .control-label {\\n    font-weight: @font-weight-bold;\\n  }\\n\\n  .tiny-cell {\\n    width: 5px;\\n  }\\n\\n  i.fa-caret-down,\\n  i.fa-caret-up {\\n    width: 5px;\\n  }\\n\\n  td.expanded {\\n    border-top: 0;\\n    padding: 0;\\n  }\\n\\n  .frame {\\n    border: 1px solid @gray-heading;\\n    border-radius: @border-radius-large;\\n    padding: 10;\\n    background: @gray-bg;\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React, { ReactNode } from 'react';\r\nimport shortid from 'shortid';\r\nimport { t, styled } from '@superset-ui/core';\r\nimport Button from 'src/components/Button';\r\nimport Icons from 'src/components/Icons';\r\nimport Fieldset from './Fieldset';\r\nimport { recurseReactClone } from './utils';\r\nimport './crud.less';\r\n\r\ninterface CRUDCollectionProps {\r\n  allowAddItem?: boolean;\r\n  allowDeletes?: boolean;\r\n  collection: Array<object>;\r\n  columnLabels?: object;\r\n  emptyMessage?: ReactNode;\r\n  expandFieldset?: ReactNode;\r\n  extraButtons?: ReactNode;\r\n  itemGenerator?: () => any;\r\n  itemRenderers?: ((\r\n    val: unknown,\r\n    onChange: () => void,\r\n    label: string,\r\n    record: any,\r\n  ) => ReactNode)[];\r\n  onChange?: (arg0: any) => void;\r\n  tableColumns: Array<any>;\r\n  stickyHeader?: boolean;\r\n}\r\n\r\ninterface CRUDCollectionState {\r\n  collection: object;\r\n  expandedColumns: object;\r\n}\r\n\r\nfunction createKeyedCollection(arr: Array<object>) {\r\n  const newArr = arr.map((o: any) => ({\r\n    ...o,\r\n    id: o.id || shortid.generate(),\r\n  }));\r\n  const map = {};\r\n  newArr.forEach((o: any) => {\r\n    map[o.id] = o;\r\n  });\r\n  return map;\r\n}\r\n\r\nconst CrudTableWrapper = styled.div<{ stickyHeader?: boolean }>`\r\n  ${({ stickyHeader }) =>\r\n    stickyHeader &&\r\n    `\r\n      height: 350px;\r\n      overflow: auto;\r\n\r\n      thead th {\r\n        background: #fff;\r\n        position: sticky;\r\n        top: 0;\r\n        z-index: 9;\r\n      }\r\n    `}\r\n`;\r\n\r\nconst CrudButtonWrapper = styled.div`\r\n  text-align: right;\r\n  ${({ theme }) => `margin-bottom: ${theme.gridUnit * 2}px`}\r\n`;\r\n\r\nexport default class CRUDCollection extends React.PureComponent<\r\n  CRUDCollectionProps,\r\n  CRUDCollectionState\r\n> {\r\n  constructor(props: CRUDCollectionProps) {\r\n    super(props);\r\n    this.state = {\r\n      expandedColumns: {},\r\n      collection: createKeyedCollection(props.collection),\r\n    };\r\n    this.renderItem = this.renderItem.bind(this);\r\n    this.onAddItem = this.onAddItem.bind(this);\r\n    this.renderExpandableSection = this.renderExpandableSection.bind(this);\r\n    this.getLabel = this.getLabel.bind(this);\r\n    this.onFieldsetChange = this.onFieldsetChange.bind(this);\r\n    this.renderTableBody = this.renderTableBody.bind(this);\r\n    this.changeCollection = this.changeCollection.bind(this);\r\n  }\r\n\r\n  UNSAFE_componentWillReceiveProps(nextProps: CRUDCollectionProps) {\r\n    if (nextProps.collection !== this.props.collection) {\r\n      this.setState({\r\n        collection: createKeyedCollection(nextProps.collection),\r\n      });\r\n    }\r\n  }\r\n\r\n  onCellChange(id: number, col: string, val: boolean) {\r\n    this.changeCollection({\r\n      ...this.state.collection,\r\n      [id]: {\r\n        ...this.state.collection[id],\r\n        [col]: val,\r\n      },\r\n    });\r\n  }\r\n\r\n  onAddItem() {\r\n    if (this.props.itemGenerator) {\r\n      let newItem = this.props.itemGenerator();\r\n      if (!newItem.id) {\r\n        newItem = { ...newItem, id: shortid.generate() };\r\n      }\r\n      this.changeCollection({\r\n        ...this.state.collection,\r\n        [newItem.id]: newItem,\r\n      });\r\n    }\r\n  }\r\n\r\n  onFieldsetChange(item: any) {\r\n    this.changeCollection({\r\n      ...this.state.collection,\r\n      [item.id]: item,\r\n    });\r\n  }\r\n\r\n  getLabel(col: any) {\r\n    const { columnLabels } = this.props;\r\n    let label = columnLabels && columnLabels[col] ? columnLabels[col] : col;\r\n    if (label.startsWith('__')) {\r\n      // special label-free columns (ie: caret for expand, delete cross)\r\n      label = '';\r\n    }\r\n    return label;\r\n  }\r\n\r\n  changeCollection(collection: any) {\r\n    this.setState({ collection });\r\n    if (this.props.onChange) {\r\n      this.props.onChange(Object.keys(collection).map(k => collection[k]));\r\n    }\r\n  }\r\n\r\n  deleteItem(id: number) {\r\n    const newColl = { ...this.state.collection };\r\n    delete newColl[id];\r\n    this.changeCollection(newColl);\r\n  }\r\n\r\n  effectiveTableColumns() {\r\n    const { tableColumns, allowDeletes, expandFieldset } = this.props;\r\n    const cols = allowDeletes\r\n      ? tableColumns.concat(['__actions'])\r\n      : tableColumns;\r\n    return expandFieldset ? ['__expand'].concat(cols) : cols;\r\n  }\r\n\r\n  toggleExpand(id: any) {\r\n    this.onCellChange(id, '__expanded', false);\r\n    this.setState(prevState => ({\r\n      expandedColumns: {\r\n        ...prevState.expandedColumns,\r\n        [id]: !prevState.expandedColumns[id],\r\n      },\r\n    }));\r\n  }\r\n\r\n  renderHeaderRow() {\r\n    const cols = this.effectiveTableColumns();\r\n    const { allowDeletes, expandFieldset, extraButtons } = this.props;\r\n    return (\r\n      <thead>\r\n        <tr>\r\n          {expandFieldset && <th aria-label=\"Expand\" className=\"tiny-cell\" />}\r\n          {cols.map(col => (\r\n            <th key={col}>{this.getLabel(col)}</th>\r\n          ))}\r\n          {extraButtons}\r\n          {allowDeletes && (\r\n            <th key=\"delete-item\" aria-label=\"Delete\" className=\"tiny-cell\" />\r\n          )}\r\n        </tr>\r\n      </thead>\r\n    );\r\n  }\r\n\r\n  renderExpandableSection(item: any) {\r\n    const propsGenerator = () => ({ item, onChange: this.onFieldsetChange });\r\n    return recurseReactClone(\r\n      this.props.expandFieldset,\r\n      Fieldset,\r\n      propsGenerator,\r\n    );\r\n  }\r\n\r\n  renderCell(record: any, col: any) {\r\n    const renderer = this.props.itemRenderers && this.props.itemRenderers[col];\r\n    const val = record[col];\r\n    const onChange = this.onCellChange.bind(this, record.id, col);\r\n    return renderer ? renderer(val, onChange, this.getLabel(col), record) : val;\r\n  }\r\n\r\n  renderItem(record: any) {\r\n    const {\r\n      allowAddItem,\r\n      allowDeletes,\r\n      expandFieldset,\r\n      tableColumns,\r\n    } = this.props;\r\n    /* eslint-disable no-underscore-dangle */\r\n    const isExpanded =\r\n      !!this.state.expandedColumns[record.id] || record.__expanded;\r\n    let tds = [];\r\n    if (expandFieldset) {\r\n      tds.push(\r\n        <td key=\"__expand\" className=\"expand\">\r\n          <i\r\n            role=\"button\"\r\n            aria-label=\"Toggle expand\"\r\n            tabIndex={0}\r\n            className={`fa fa-caret-${\r\n              isExpanded ? 'down' : 'right'\r\n            } text-primary pointer`}\r\n            onClick={this.toggleExpand.bind(this, record.id)}\r\n          />\r\n        </td>,\r\n      );\r\n    }\r\n    tds = tds.concat(\r\n      tableColumns.map(col => (\r\n        <td key={col}>{this.renderCell(record, col)}</td>\r\n      )),\r\n    );\r\n    if (allowAddItem) {\r\n      tds.push(<td key=\"add\" />);\r\n    }\r\n    if (allowDeletes) {\r\n      tds.push(\r\n        <td\r\n          key=\"__actions\"\r\n          data-test=\"crud-delete-option\"\r\n          className=\"text-primary\"\r\n        >\r\n          <Icons.Trash\r\n            aria-label=\"Delete item\"\r\n            className=\"pointer\"\r\n            data-test=\"crud-delete-icon\"\r\n            iconSize=\"m\"\r\n            role=\"button\"\r\n            tabIndex={0}\r\n            onClick={this.deleteItem.bind(this, record.id)}\r\n          />\r\n        </td>,\r\n      );\r\n    }\r\n    const trs = [\r\n      <tr {...{ 'data-test': 'table-row' }} className=\"row\" key={record.id}>\r\n        {tds}\r\n      </tr>,\r\n    ];\r\n    if (isExpanded) {\r\n      trs.push(\r\n        <tr className=\"exp\" key={`exp__${record.id}`}>\r\n          <td\r\n            colSpan={this.effectiveTableColumns().length}\r\n            className=\"expanded\"\r\n          >\r\n            <div>{this.renderExpandableSection(record)}</div>\r\n          </td>\r\n        </tr>,\r\n      );\r\n    }\r\n    return trs;\r\n  }\r\n\r\n  renderEmptyCell() {\r\n    return (\r\n      <tr>\r\n        <td className=\"empty-collection\">{this.props.emptyMessage}</td>\r\n      </tr>\r\n    );\r\n  }\r\n\r\n  renderTableBody() {\r\n    const data = Object.keys(this.state.collection).map(\r\n      k => this.state.collection[k],\r\n    );\r\n    const content = data.length\r\n      ? data.map(d => this.renderItem(d))\r\n      : this.renderEmptyCell();\r\n    return <tbody data-test=\"table-content-rows\">{content}</tbody>;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <CrudButtonWrapper>\r\n          {this.props.allowAddItem && (\r\n            <span className=\"m-t-10 m-r-10\">\r\n              <Button\r\n                buttonSize=\"small\"\r\n                buttonStyle=\"primary\"\r\n                onClick={this.onAddItem}\r\n                data-test=\"add-item-button\"\r\n              >\r\n                <i data-test=\"crud-add-table-item\" className=\"fa fa-plus\" />{' '}\r\n                {t('Add item')}\r\n              </Button>\r\n            </span>\r\n          )}\r\n        </CrudButtonWrapper>\r\n        <CrudTableWrapper\r\n          className=\"CRUD\"\r\n          stickyHeader={this.props.stickyHeader}\r\n        >\r\n          <table data-test=\"crud-table\" className=\"table\">\r\n            {this.renderHeaderRow()}\r\n            {this.renderTableBody()}\r\n          </table>\r\n        </CrudTableWrapper>\r\n      </>\r\n    );\r\n  }\r\n}\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React, { useCallback } from 'react';\r\nimport { css, SupersetTheme } from '@superset-ui/core';\r\nimport { Tooltip } from 'src/components/Tooltip';\r\nimport { FormItem, FormLabel } from 'src/components/Form';\r\nimport './crud.less';\r\n\r\nconst formItemInlineCss = css`\r\n  .ant-form-item-control-input-content {\r\n    display: flex;\r\n    flex-direction: row;\r\n  }\r\n`;\r\n\r\ninterface FieldProps<V> {\r\n  fieldKey: string;\r\n  value?: V;\r\n  label: string;\r\n  description?: React.ReactNode;\r\n  control: React.ReactElement;\r\n  onChange: (fieldKey: string, newValue: V) => void;\r\n  compact: boolean;\r\n  inline: boolean;\r\n}\r\n\r\nexport default function Field<V>({\r\n  fieldKey,\r\n  value,\r\n  label,\r\n  description,\r\n  control,\r\n  onChange,\r\n  compact,\r\n  inline,\r\n}: FieldProps<V>) {\r\n  const onControlChange = useCallback(\r\n    newValue => {\r\n      onChange(fieldKey, newValue);\r\n    },\r\n    [onChange, fieldKey],\r\n  );\r\n\r\n  const hookedControl = React.cloneElement(control, {\r\n    value,\r\n    onChange: onControlChange,\r\n  });\r\n  return (\r\n    <FormItem\r\n      label={\r\n        <FormLabel className=\"m-r-5\">\r\n          {label || fieldKey}\r\n          {compact && description && (\r\n            <Tooltip id=\"field-descr\" placement=\"right\" title={description}>\r\n              <i className=\"fa fa-info-circle m-l-5\" />\r\n            </Tooltip>\r\n          )}\r\n        </FormLabel>\r\n      }\r\n      css={inline && formItemInlineCss}\r\n    >\r\n      {hookedControl}\r\n      {!compact && description && (\r\n        <div\r\n          css={(theme: SupersetTheme) => ({\r\n            color: theme.colors.grayscale.base,\r\n            [inline ? 'marginLeft' : 'marginTop']: theme.gridUnit,\r\n          })}\r\n        >\r\n          {description}\r\n        </div>\r\n      )}\r\n    </FormItem>\r\n  );\r\n}\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Form } from 'src/components/Form';\r\n\r\nimport { recurseReactClone } from './utils';\r\nimport Field from './Field';\r\n\r\nconst propTypes = {\r\n  children: PropTypes.node.isRequired,\r\n  onChange: PropTypes.func,\r\n  item: PropTypes.object,\r\n  title: PropTypes.node,\r\n  compact: PropTypes.bool,\r\n};\r\nconst defaultProps = {\r\n  compact: false,\r\n  title: null,\r\n};\r\n\r\nexport default class Fieldset extends React.PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.onChange = this.onChange.bind(this);\r\n  }\r\n\r\n  onChange(fieldKey, val) {\r\n    return this.props.onChange({\r\n      ...this.props.item,\r\n      [fieldKey]: val,\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { title } = this.props;\r\n    const propExtender = field => ({\r\n      onChange: this.onChange,\r\n      value: this.props.item[field.props.fieldKey],\r\n      compact: this.props.compact,\r\n    });\r\n    return (\r\n      <Form componentClass=\"fieldset\" className=\"CRUD\" layout=\"vertical\">\r\n        {title && <legend>{title}</legend>}\r\n        {recurseReactClone(this.props.children, Field, propExtender)}\r\n      </Form>\r\n    );\r\n  }\r\n}\r\nFieldset.propTypes = propTypes;\r\nFieldset.defaultProps = defaultProps;\r\n","var content = require(\"!!../../node_modules/css-loader/index.js??ref--8-1!../../node_modules/less-loader/dist/cjs.js??ref--8-2!./crud.less\");\n\nif (typeof content === 'string') {\n  content = [[module.id, content, '']];\n}\n\nvar options = {}\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = require(\"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\")(content, options);\n\nif (content.locals) {\n  module.exports = content.locals;\n}\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React from 'react';\r\n\r\nexport function recurseReactClone(children, type, propExtender) {\r\n  /**\r\n   * Clones a React component's children, and injects new props\r\n   * where the type specified is matched.\r\n   */\r\n  return React.Children.map(children, child => {\r\n    let newChild = child;\r\n    if (child && child.type.name === type.name) {\r\n      newChild = React.cloneElement(child, propExtender(child));\r\n    }\r\n    if (newChild && newChild.props.children) {\r\n      newChild = React.cloneElement(newChild, {\r\n        children: recurseReactClone(\r\n          newChild.props.children,\r\n          type,\r\n          propExtender,\r\n        ),\r\n      });\r\n    }\r\n    return newChild;\r\n  });\r\n}\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React from 'react';\r\nimport { t, supersetTheme } from '@superset-ui/core';\r\nimport Icon from 'src/components/Icon';\r\nimport { Tooltip } from 'src/components/Tooltip';\r\n\r\nexport interface CertifiedIconProps {\r\n  certifiedBy?: string;\r\n  details?: string;\r\n  size?: number;\r\n}\r\n\r\nfunction CertifiedIcon({\r\n  certifiedBy,\r\n  details,\r\n  size = 24,\r\n}: CertifiedIconProps) {\r\n  return (\r\n    <Tooltip\r\n      id=\"certified-details-tooltip\"\r\n      title={\r\n        <>\r\n          {certifiedBy && (\r\n            <div>\r\n              <strong>{t('Certified by %s', certifiedBy)}</strong>\r\n            </div>\r\n          )}\r\n          <div>{details}</div>\r\n        </>\r\n      }\r\n    >\r\n      <Icon\r\n        color={supersetTheme.colors.primary.base}\r\n        height={size}\r\n        width={size}\r\n        name=\"certified\"\r\n      />\r\n    </Tooltip>\r\n  );\r\n}\r\n\r\nexport default CertifiedIcon;\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React, { ReactNode, useEffect, useState } from 'react';\r\nimport { styled, SupersetClient, t } from '@superset-ui/core';\r\nimport rison from 'rison';\r\nimport { Select } from 'src/components/Select';\r\nimport Label from 'src/components/Label';\r\nimport RefreshLabel from 'src/components/RefreshLabel';\r\nimport SupersetAsyncSelect from 'src/components/AsyncSelect';\r\n\r\nconst FieldTitle = styled.p`\r\n  color: ${({ theme }) => theme.colors.secondary.light2};\r\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\r\n  margin: 20px 0 10px 0;\r\n  text-transform: uppercase;\r\n`;\r\n\r\nconst DatabaseSelectorWrapper = styled.div`\r\n  .fa-refresh {\r\n    padding-left: 9px;\r\n  }\r\n\r\n  .refresh-col {\r\n    display: flex;\r\n    align-items: center;\r\n    width: 30px;\r\n    margin-left: ${({ theme }) => theme.gridUnit}px;\r\n  }\r\n\r\n  .section {\r\n    padding-bottom: 5px;\r\n    display: flex;\r\n    flex-direction: row;\r\n  }\r\n\r\n  .select {\r\n    flex-grow: 1;\r\n  }\r\n`;\r\n\r\nconst DatabaseOption = styled.span`\r\n  display: inline-flex;\r\n  align-items: center;\r\n`;\r\n\r\ninterface DatabaseSelectorProps {\r\n  dbId: number;\r\n  formMode?: boolean;\r\n  getDbList?: (arg0: any) => {};\r\n  getTableList?: (dbId: number, schema: string, force: boolean) => {};\r\n  handleError: (msg: string) => void;\r\n  isDatabaseSelectEnabled?: boolean;\r\n  onDbChange?: (db: any) => void;\r\n  onSchemaChange?: (arg0?: any) => {};\r\n  onSchemasLoad?: (schemas: Array<object>) => void;\r\n  readOnly?: boolean;\r\n  schema?: string;\r\n  sqlLabMode?: boolean;\r\n  onChange?: ({\r\n    dbId,\r\n    schema,\r\n  }: {\r\n    dbId: number;\r\n    schema?: string;\r\n    tableName?: string;\r\n  }) => void;\r\n}\r\n\r\nexport default function DatabaseSelector({\r\n  dbId,\r\n  formMode = false,\r\n  getDbList,\r\n  getTableList,\r\n  handleError,\r\n  isDatabaseSelectEnabled = true,\r\n  onChange,\r\n  onDbChange,\r\n  onSchemaChange,\r\n  onSchemasLoad,\r\n  readOnly = false,\r\n  schema,\r\n  sqlLabMode = false,\r\n}: DatabaseSelectorProps) {\r\n  const [currentDbId, setCurrentDbId] = useState(dbId);\r\n  const [currentSchema, setCurrentSchema] = useState<string | undefined>(\r\n    schema,\r\n  );\r\n  const [schemaLoading, setSchemaLoading] = useState(false);\r\n  const [schemaOptions, setSchemaOptions] = useState([]);\r\n\r\n  function fetchSchemas(databaseId: number, forceRefresh = false) {\r\n    const actualDbId = databaseId || dbId;\r\n    if (actualDbId) {\r\n      setSchemaLoading(true);\r\n      const queryParams = rison.encode({\r\n        force: Boolean(forceRefresh),\r\n      });\r\n      const endpoint = `/api/v1/database/${actualDbId}/schemas/?q=${queryParams}`;\r\n      return SupersetClient.get({ endpoint })\r\n        .then(({ json }) => {\r\n          const options = json.result.map((s: string) => ({\r\n            value: s,\r\n            label: s,\r\n            title: s,\r\n          }));\r\n          setSchemaOptions(options);\r\n          setSchemaLoading(false);\r\n          if (onSchemasLoad) {\r\n            onSchemasLoad(options);\r\n          }\r\n        })\r\n        .catch(() => {\r\n          setSchemaOptions([]);\r\n          setSchemaLoading(false);\r\n          handleError(t('Error while fetching schema list'));\r\n        });\r\n    }\r\n    return Promise.resolve();\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (currentDbId) {\r\n      fetchSchemas(currentDbId);\r\n    }\r\n  }, [currentDbId]);\r\n\r\n  function onSelectChange({ dbId, schema }: { dbId: number; schema?: string }) {\r\n    setCurrentDbId(dbId);\r\n    setCurrentSchema(schema);\r\n    if (onChange) {\r\n      onChange({ dbId, schema, tableName: undefined });\r\n    }\r\n  }\r\n\r\n  function dbMutator(data: any) {\r\n    if (getDbList) {\r\n      getDbList(data.result);\r\n    }\r\n    if (data.result.length === 0) {\r\n      handleError(t(\"It seems you don't have access to any database\"));\r\n    }\r\n    return data.result.map((row: any) => ({\r\n      ...row,\r\n      // label is used for the typeahead\r\n      label: `${row.backend} ${row.database_name}`,\r\n    }));\r\n  }\r\n\r\n  function changeDataBase(db: any, force = false) {\r\n    const dbId = db ? db.id : null;\r\n    setSchemaOptions([]);\r\n    if (onSchemaChange) {\r\n      onSchemaChange(null);\r\n    }\r\n    if (onDbChange) {\r\n      onDbChange(db);\r\n    }\r\n    fetchSchemas(dbId, force);\r\n    onSelectChange({ dbId, schema: undefined });\r\n  }\r\n\r\n  function changeSchema(schemaOpt: any, force = false) {\r\n    const schema = schemaOpt ? schemaOpt.value : null;\r\n    if (onSchemaChange) {\r\n      onSchemaChange(schema);\r\n    }\r\n    setCurrentSchema(schema);\r\n    onSelectChange({ dbId: currentDbId, schema });\r\n    if (getTableList) {\r\n      getTableList(currentDbId, schema, force);\r\n    }\r\n  }\r\n\r\n  function renderDatabaseOption(db: any) {\r\n    return (\r\n      <DatabaseOption title={db.database_name}>\r\n        <Label type=\"default\">{db.backend}</Label> {db.database_name}\r\n      </DatabaseOption>\r\n    );\r\n  }\r\n\r\n  function renderSelectRow(select: ReactNode, refreshBtn: ReactNode) {\r\n    return (\r\n      <div className=\"section\">\r\n        <span className=\"select\">{select}</span>\r\n        <span className=\"refresh-col\">{refreshBtn}</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  function renderDatabaseSelect() {\r\n    const queryParams = rison.encode({\r\n      order_columns: 'database_name',\r\n      order_direction: 'asc',\r\n      page: 0,\r\n      page_size: -1,\r\n      ...(formMode || !sqlLabMode\r\n        ? {}\r\n        : {\r\n            filters: [\r\n              {\r\n                col: 'expose_in_sqllab',\r\n                opr: 'eq',\r\n                value: true,\r\n              },\r\n            ],\r\n          }),\r\n    });\r\n\r\n    return renderSelectRow(\r\n      <SupersetAsyncSelect\r\n        data-test=\"select-database\"\r\n        dataEndpoint={`/api/v1/database/?q=${queryParams}`}\r\n        onChange={(db: any) => changeDataBase(db)}\r\n        onAsyncError={() =>\r\n          handleError(t('Error while fetching database list'))\r\n        }\r\n        clearable={false}\r\n        value={currentDbId}\r\n        valueKey=\"id\"\r\n        valueRenderer={(db: any) => (\r\n          <div>\r\n            <span className=\"text-muted m-r-5\">{t('Database:')}</span>\r\n            {renderDatabaseOption(db)}\r\n          </div>\r\n        )}\r\n        optionRenderer={renderDatabaseOption}\r\n        mutator={dbMutator}\r\n        placeholder={t('Select a database')}\r\n        autoSelect\r\n        isDisabled={!isDatabaseSelectEnabled || readOnly}\r\n      />,\r\n      null,\r\n    );\r\n  }\r\n\r\n  function renderSchemaSelect() {\r\n    const value = schemaOptions.filter(({ value }) => currentSchema === value);\r\n    const refresh = !formMode && !readOnly && (\r\n      <RefreshLabel\r\n        onClick={() => changeDataBase({ id: dbId }, true)}\r\n        tooltipContent={t('Force refresh schema list')}\r\n      />\r\n    );\r\n\r\n    return renderSelectRow(\r\n      <Select\r\n        name=\"select-schema\"\r\n        placeholder={t('Select a schema (%s)', schemaOptions.length)}\r\n        options={schemaOptions}\r\n        value={value}\r\n        valueRenderer={o => (\r\n          <div>\r\n            <span className=\"text-muted\">{t('Schema:')}</span> {o.label}\r\n          </div>\r\n        )}\r\n        isLoading={schemaLoading}\r\n        autosize={false}\r\n        onChange={item => changeSchema(item)}\r\n        isDisabled={readOnly}\r\n      />,\r\n      refresh,\r\n    );\r\n  }\r\n\r\n  return (\r\n    <DatabaseSelectorWrapper data-test=\"DatabaseSelector\">\r\n      {formMode && <FieldTitle>{t('datasource')}</FieldTitle>}\r\n      {renderDatabaseSelect()}\r\n      {formMode && <FieldTitle>{t('schema')}</FieldTitle>}\r\n      {renderSchemaSelect()}\r\n    </DatabaseSelectorWrapper>\r\n  );\r\n}\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React, { useEffect, useState, useRef } from 'react';\r\nimport cx from 'classnames';\r\nimport { t } from '@superset-ui/core';\r\nimport { Tooltip } from 'src/components/Tooltip';\r\n\r\nexport interface EditableTitleProps {\r\n  canEdit?: boolean;\r\n  editing?: boolean;\r\n  emptyText?: string;\r\n  extraClasses?: Array<string> | string;\r\n  multiLine?: boolean;\r\n  noPermitTooltip?: string;\r\n  onSaveTitle: (arg0: string) => void;\r\n  showTooltip?: boolean;\r\n  style?: object;\r\n  title?: string;\r\n  defaultTitle?: string;\r\n  placeholder?: string;\r\n}\r\n\r\nexport default function EditableTitle({\r\n  canEdit = false,\r\n  editing = false,\r\n  extraClasses,\r\n  multiLine = false,\r\n  noPermitTooltip,\r\n  onSaveTitle,\r\n  showTooltip = true,\r\n  style,\r\n  title = '',\r\n  defaultTitle = '',\r\n  placeholder = '',\r\n}: EditableTitleProps) {\r\n  const [isEditing, setIsEditing] = useState(editing);\r\n  const [currentTitle, setCurrentTitle] = useState(title);\r\n  const [lastTitle, setLastTitle] = useState(title);\r\n  const [\r\n    contentBoundingRect,\r\n    setContentBoundingRect,\r\n  ] = useState<DOMRect | null>(null);\r\n  // Used so we can access the DOM element if a user clicks on this component.\r\n\r\n  const contentRef = useRef<any | HTMLInputElement | HTMLTextAreaElement>();\r\n\r\n  useEffect(() => {\r\n    if (title !== currentTitle) {\r\n      setLastTitle(currentTitle);\r\n      setCurrentTitle(title);\r\n    }\r\n  }, [title]);\r\n\r\n  useEffect(() => {\r\n    if (isEditing) {\r\n      contentRef.current.focus();\r\n    }\r\n  }, [isEditing]);\r\n\r\n  function handleClick() {\r\n    if (!canEdit || isEditing) {\r\n      return;\r\n    }\r\n\r\n    // For multi-line values, save the actual rendered size of the displayed text.\r\n    // Later, if a textarea is constructed for editing the value, we'll need this.\r\n    const contentBounding = contentRef.current\r\n      ? contentRef.current.getBoundingClientRect()\r\n      : null;\r\n    setIsEditing(true);\r\n    setContentBoundingRect(contentBounding);\r\n  }\r\n\r\n  function handleBlur() {\r\n    const formattedTitle = currentTitle.trim();\r\n\r\n    if (!canEdit) {\r\n      return;\r\n    }\r\n\r\n    setIsEditing(false);\r\n\r\n    if (!formattedTitle.length) {\r\n      setCurrentTitle(lastTitle);\r\n      return;\r\n    }\r\n\r\n    if (lastTitle !== formattedTitle) {\r\n      setLastTitle(formattedTitle);\r\n    }\r\n\r\n    if (title !== formattedTitle) {\r\n      onSaveTitle(formattedTitle);\r\n    }\r\n  }\r\n\r\n  // tl;dr when a EditableTitle is being edited, typically the Tab that wraps it has been\r\n  // clicked and is focused/active. For accessibility, when the focused tab anchor intercepts\r\n  // the ' ' key (among others, including all arrows) the onChange() doesn't fire. Somehow\r\n  // keydown is still called so we can detect this and manually add a ' ' to the current title\r\n  function handleKeyDown(event: any) {\r\n    if (event.key === ' ') {\r\n      event.stopPropagation();\r\n    }\r\n    if (event.key === 'Enter') {\r\n      event.preventDefault();\r\n      handleBlur();\r\n    }\r\n  }\r\n\r\n  function handleChange(ev: any) {\r\n    if (!canEdit) {\r\n      return;\r\n    }\r\n    setCurrentTitle(ev.target.value);\r\n  }\r\n\r\n  function handleKeyPress(ev: any) {\r\n    if (ev.key === 'Enter') {\r\n      ev.preventDefault();\r\n      handleBlur();\r\n    }\r\n  }\r\n\r\n  let value: string | undefined;\r\n  value = currentTitle;\r\n  if (!isEditing && !currentTitle) {\r\n    value = defaultTitle || title;\r\n  }\r\n\r\n  // Construct an inline style based on previously-saved height of the rendered label. Only\r\n  // used in multi-line contexts.\r\n  const editStyle =\r\n    isEditing && contentBoundingRect\r\n      ? { height: `${contentBoundingRect.height}px` }\r\n      : undefined;\r\n\r\n  // Create a textarea when we're editing a multi-line value, otherwise create an input (which may\r\n  // be text or a button).\r\n  let titleComponent =\r\n    multiLine && isEditing ? (\r\n      <textarea\r\n        data-test=\"editable-title-input\"\r\n        ref={contentRef}\r\n        value={value}\r\n        className={!title ? 'text-muted' : undefined}\r\n        onKeyDown={handleKeyDown}\r\n        onChange={handleChange}\r\n        onBlur={handleBlur}\r\n        onClick={handleClick}\r\n        onKeyPress={handleKeyPress}\r\n        placeholder={placeholder}\r\n        style={editStyle}\r\n      />\r\n    ) : (\r\n      <input\r\n        data-test=\"editable-title-input\"\r\n        ref={contentRef}\r\n        type={isEditing ? 'text' : 'button'}\r\n        value={value}\r\n        className={!title ? 'text-muted' : undefined}\r\n        onKeyDown={handleKeyDown}\r\n        onChange={handleChange}\r\n        onBlur={handleBlur}\r\n        onClick={handleClick}\r\n        onKeyPress={handleKeyPress}\r\n        placeholder={placeholder}\r\n      />\r\n    );\r\n  if (showTooltip && !isEditing) {\r\n    titleComponent = (\r\n      <Tooltip\r\n        id=\"title-tooltip\"\r\n        title={\r\n          canEdit\r\n            ? t('Click to edit')\r\n            : noPermitTooltip ||\r\n              t(\"You don't have the rights to alter this title.\")\r\n        }\r\n      >\r\n        {titleComponent}\r\n      </Tooltip>\r\n    );\r\n  }\r\n  if (!canEdit) {\r\n    // don't actually want an input in this case\r\n    titleComponent = (\r\n      <span data-test=\"editable-title-input\" title={value}>\r\n        {value}\r\n      </span>\r\n    );\r\n  }\r\n  return (\r\n    <span\r\n      data-test=\"editable-title\"\r\n      className={cx(\r\n        'editable-title',\r\n        extraClasses,\r\n        canEdit && 'editable-title--editable',\r\n        isEditing && 'editable-title--editing',\r\n      )}\r\n      style={style}\r\n    >\r\n      {titleComponent}\r\n    </span>\r\n  );\r\n}\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React, { MouseEventHandler } from 'react';\r\nimport { SupersetTheme } from '@superset-ui/core';\r\nimport { Tooltip } from 'src/components/Tooltip';\r\nimport Icon, { IconProps } from 'src/components/Icon';\r\n\r\nexport interface RefreshLabelProps {\r\n  onClick: MouseEventHandler<SVGSVGElement>;\r\n  tooltipContent: string;\r\n}\r\n\r\nconst RefreshLabel = ({ onClick, tooltipContent }: RefreshLabelProps) => {\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const IconWithoutRef = React.forwardRef((props: IconProps, ref: any) => (\r\n    <Icon {...props} />\r\n  ));\r\n\r\n  return (\r\n    <Tooltip title={tooltipContent}>\r\n      <IconWithoutRef\r\n        role=\"button\"\r\n        onClick={onClick}\r\n        name=\"refresh\"\r\n        css={(theme: SupersetTheme) => ({\r\n          cursor: 'pointer',\r\n          color: theme.colors.grayscale.base,\r\n          '&:hover': { color: theme.colors.primary.base },\r\n        })}\r\n      />\r\n    </Tooltip>\r\n  );\r\n};\r\n\r\nexport default RefreshLabel;\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React, {\r\n  FunctionComponent,\r\n  useEffect,\r\n  useState,\r\n  ReactNode,\r\n} from 'react';\r\nimport { styled, SupersetClient, t } from '@superset-ui/core';\r\nimport { AsyncSelect, CreatableSelect, Select } from 'src/components/Select';\r\n\r\nimport { FormLabel } from 'src/components/Form';\r\n\r\nimport DatabaseSelector from 'src/components/DatabaseSelector';\r\nimport RefreshLabel from 'src/components/RefreshLabel';\r\nimport CertifiedIcon from 'src/components/CertifiedIcon';\r\nimport WarningIconWithTooltip from 'src/components/WarningIconWithTooltip';\r\n\r\nconst FieldTitle = styled.p`\r\n  color: ${({ theme }) => theme.colors.secondary.light2};\r\n  font-size: ${({ theme }) => theme.typography.sizes.s}px;\r\n  margin: 20px 0 10px 0;\r\n  text-transform: uppercase;\r\n`;\r\n\r\nconst TableSelectorWrapper = styled.div`\r\n  .fa-refresh {\r\n    padding-left: 9px;\r\n  }\r\n\r\n  .refresh-col {\r\n    display: flex;\r\n    align-items: center;\r\n    width: 30px;\r\n    margin-left: ${({ theme }) => theme.gridUnit}px;\r\n  }\r\n\r\n  .section {\r\n    padding-bottom: 5px;\r\n    display: flex;\r\n    flex-direction: row;\r\n  }\r\n\r\n  .select {\r\n    flex-grow: 1;\r\n  }\r\n\r\n  .divider {\r\n    border-bottom: 1px solid ${({ theme }) => theme.colors.secondary.light5};\r\n    margin: 15px 0;\r\n  }\r\n`;\r\n\r\nconst TableLabel = styled.span`\r\n  align-items: center;\r\n  display: flex;\r\n  white-space: nowrap;\r\n\r\n  > svg,\r\n  > small {\r\n    margin-right: ${({ theme }) => theme.gridUnit}px;\r\n  }\r\n`;\r\n\r\ninterface TableSelectorProps {\r\n  clearable?: boolean;\r\n  database?: any;\r\n  dbId: number;\r\n  formMode?: boolean;\r\n  getDbList?: (arg0: any) => {};\r\n  handleError: (msg: string) => void;\r\n  isDatabaseSelectEnabled?: boolean;\r\n  onChange?: ({\r\n    dbId,\r\n    schema,\r\n  }: {\r\n    dbId: number;\r\n    schema?: string;\r\n    tableName?: string;\r\n  }) => void;\r\n  onDbChange?: (db: any) => void;\r\n  onSchemaChange?: (arg0?: any) => {};\r\n  onSchemasLoad?: () => void;\r\n  onTableChange?: (tableName: string, schema: string) => void;\r\n  onTablesLoad?: (options: Array<any>) => {};\r\n  readOnly?: boolean;\r\n  schema?: string;\r\n  sqlLabMode?: boolean;\r\n  tableName?: string;\r\n  tableNameSticky?: boolean;\r\n}\r\n\r\nconst TableSelector: FunctionComponent<TableSelectorProps> = ({\r\n  database,\r\n  dbId,\r\n  formMode = false,\r\n  getDbList,\r\n  handleError,\r\n  isDatabaseSelectEnabled = true,\r\n  onChange,\r\n  onDbChange,\r\n  onSchemaChange,\r\n  onSchemasLoad,\r\n  onTableChange,\r\n  onTablesLoad,\r\n  readOnly = false,\r\n  schema,\r\n  sqlLabMode = true,\r\n  tableName,\r\n  tableNameSticky = true,\r\n}) => {\r\n  const [currentSchema, setCurrentSchema] = useState<string | undefined>(\r\n    schema,\r\n  );\r\n  const [currentTableName, setCurrentTableName] = useState<string | undefined>(\r\n    tableName,\r\n  );\r\n  const [tableLoading, setTableLoading] = useState(false);\r\n  const [tableOptions, setTableOptions] = useState([]);\r\n\r\n  function fetchTables(\r\n    databaseId?: number,\r\n    schema?: string,\r\n    forceRefresh = false,\r\n    substr = 'undefined',\r\n  ) {\r\n    const dbSchema = schema || currentSchema;\r\n    const actualDbId = databaseId || dbId;\r\n    if (actualDbId && dbSchema) {\r\n      const encodedSchema = encodeURIComponent(dbSchema);\r\n      const encodedSubstr = encodeURIComponent(substr);\r\n      setTableLoading(true);\r\n      setTableOptions([]);\r\n      const endpoint = encodeURI(\r\n        `/superset/tables/${actualDbId}/${encodedSchema}/${encodedSubstr}/${!!forceRefresh}/`,\r\n      );\r\n      return SupersetClient.get({ endpoint })\r\n        .then(({ json }) => {\r\n          const options = json.options.map((o: any) => ({\r\n            value: o.value,\r\n            schema: o.schema,\r\n            label: o.label,\r\n            title: o.title,\r\n            type: o.type,\r\n            extra: o?.extra,\r\n          }));\r\n          setTableLoading(false);\r\n          setTableOptions(options);\r\n          if (onTablesLoad) {\r\n            onTablesLoad(json.options);\r\n          }\r\n        })\r\n        .catch(() => {\r\n          setTableLoading(false);\r\n          setTableOptions([]);\r\n          handleError(t('Error while fetching table list'));\r\n        });\r\n    }\r\n    setTableLoading(false);\r\n    setTableOptions([]);\r\n    return Promise.resolve();\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (dbId && schema) {\r\n      fetchTables();\r\n    }\r\n  }, [dbId, schema]);\r\n\r\n  function onSelectionChange({\r\n    dbId,\r\n    schema,\r\n    tableName,\r\n  }: {\r\n    dbId: number;\r\n    schema?: string;\r\n    tableName?: string;\r\n  }) {\r\n    setCurrentTableName(tableName);\r\n    setCurrentSchema(schema);\r\n    if (onChange) {\r\n      onChange({ dbId, schema, tableName });\r\n    }\r\n  }\r\n\r\n  function getTableNamesBySubStr(substr = 'undefined') {\r\n    if (!dbId || !substr) {\r\n      const options: any[] = [];\r\n      return Promise.resolve({ options });\r\n    }\r\n    const encodedSchema = encodeURIComponent(schema || '');\r\n    const encodedSubstr = encodeURIComponent(substr);\r\n    return SupersetClient.get({\r\n      endpoint: encodeURI(\r\n        `/superset/tables/${dbId}/${encodedSchema}/${encodedSubstr}`,\r\n      ),\r\n    }).then(({ json }) => {\r\n      const options = json.options.map((o: any) => ({\r\n        value: o.value,\r\n        schema: o.schema,\r\n        label: o.label,\r\n        title: o.title,\r\n        type: o.type,\r\n      }));\r\n      return { options };\r\n    });\r\n  }\r\n\r\n  function changeTable(tableOpt: any) {\r\n    if (!tableOpt) {\r\n      setCurrentTableName('');\r\n      return;\r\n    }\r\n    const schemaName = tableOpt.schema;\r\n    const tableOptTableName = tableOpt.value;\r\n    if (tableNameSticky) {\r\n      onSelectionChange({\r\n        dbId,\r\n        schema: schemaName,\r\n        tableName: tableOptTableName,\r\n      });\r\n    }\r\n    if (onTableChange) {\r\n      onTableChange(tableOptTableName, schemaName);\r\n    }\r\n  }\r\n\r\n  function changeSchema(schemaOpt: any, force = false) {\r\n    const value = schemaOpt ? schemaOpt.value : null;\r\n    if (onSchemaChange) {\r\n      onSchemaChange(value);\r\n    }\r\n    onSelectionChange({\r\n      dbId,\r\n      schema: value,\r\n      tableName: undefined,\r\n    });\r\n    fetchTables(dbId, currentSchema, force);\r\n  }\r\n\r\n  function renderTableOption(option: any) {\r\n    return (\r\n      <TableLabel title={option.label}>\r\n        <small className=\"text-muted\">\r\n          <i className={`fa fa-${option.type === 'view' ? 'eye' : 'table'}`} />\r\n        </small>\r\n        {option.extra?.certification && (\r\n          <CertifiedIcon\r\n            certifiedBy={option.extra.certification.certified_by}\r\n            details={option.extra.certification.details}\r\n            size={20}\r\n          />\r\n        )}\r\n        {option.extra?.warning_markdown && (\r\n          <WarningIconWithTooltip\r\n            warningMarkdown={option.extra.warning_markdown}\r\n            size={20}\r\n          />\r\n        )}\r\n        {option.label}\r\n      </TableLabel>\r\n    );\r\n  }\r\n\r\n  function renderSelectRow(select: ReactNode, refreshBtn: ReactNode) {\r\n    return (\r\n      <div className=\"section\">\r\n        <span className=\"select\">{select}</span>\r\n        <span className=\"refresh-col\">{refreshBtn}</span>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  function renderDatabaseSelector() {\r\n    return (\r\n      <DatabaseSelector\r\n        dbId={dbId}\r\n        formMode={formMode}\r\n        getDbList={getDbList}\r\n        getTableList={fetchTables}\r\n        handleError={handleError}\r\n        onChange={onSelectionChange}\r\n        onDbChange={readOnly ? undefined : onDbChange}\r\n        onSchemaChange={readOnly ? undefined : onSchemaChange}\r\n        onSchemasLoad={onSchemasLoad}\r\n        schema={currentSchema}\r\n        sqlLabMode={sqlLabMode}\r\n        isDatabaseSelectEnabled={isDatabaseSelectEnabled && !readOnly}\r\n        readOnly={readOnly}\r\n      />\r\n    );\r\n  }\r\n\r\n  function renderTableSelect() {\r\n    const options = tableOptions;\r\n    let select = null;\r\n    if (currentSchema && !formMode) {\r\n      // dataset editor\r\n      select = (\r\n        <Select\r\n          name=\"select-table\"\r\n          isLoading={tableLoading}\r\n          ignoreAccents={false}\r\n          placeholder={t('Select table or type table name')}\r\n          autosize={false}\r\n          onChange={changeTable}\r\n          options={options}\r\n          // @ts-ignore\r\n          value={currentTableName}\r\n          optionRenderer={renderTableOption}\r\n          valueRenderer={renderTableOption}\r\n          isDisabled={readOnly}\r\n        />\r\n      );\r\n    } else if (formMode) {\r\n      select = (\r\n        <CreatableSelect\r\n          name=\"select-table\"\r\n          isLoading={tableLoading}\r\n          ignoreAccents={false}\r\n          placeholder={t('Select table or type table name')}\r\n          autosize={false}\r\n          onChange={changeTable}\r\n          options={options}\r\n          // @ts-ignore\r\n          value={currentTableName}\r\n          optionRenderer={renderTableOption}\r\n        />\r\n      );\r\n    } else {\r\n      // sql lab\r\n      let tableSelectPlaceholder;\r\n      let tableSelectDisabled = false;\r\n      if (database && database.allow_multi_schema_metadata_fetch) {\r\n        tableSelectPlaceholder = t('Type to search ...');\r\n      } else {\r\n        tableSelectPlaceholder = t('Select table ');\r\n        tableSelectDisabled = true;\r\n      }\r\n      select = (\r\n        <AsyncSelect\r\n          name=\"async-select-table\"\r\n          placeholder={tableSelectPlaceholder}\r\n          isDisabled={tableSelectDisabled}\r\n          autosize={false}\r\n          onChange={changeTable}\r\n          // @ts-ignore\r\n          value={currentTableName}\r\n          loadOptions={getTableNamesBySubStr}\r\n          optionRenderer={renderTableOption}\r\n        />\r\n      );\r\n    }\r\n    const refresh = !formMode && !readOnly && (\r\n      <RefreshLabel\r\n        onClick={() => changeSchema({ value: schema }, true)}\r\n        tooltipContent={t('Force refresh table list')}\r\n      />\r\n    );\r\n    return renderSelectRow(select, refresh);\r\n  }\r\n\r\n  function renderSeeTableLabel() {\r\n    return (\r\n      <div className=\"section\">\r\n        <FormLabel>\r\n          {t('See table schema')}{' '}\r\n          {schema && (\r\n            <small>\r\n              {tableOptions.length} in\r\n              <i>{schema}</i>\r\n            </small>\r\n          )}\r\n        </FormLabel>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <TableSelectorWrapper>\r\n      {renderDatabaseSelector()}\r\n      {!formMode && <div className=\"divider\" />}\r\n      {sqlLabMode && renderSeeTableLabel()}\r\n      {formMode && <FieldTitle>{t('Table')}</FieldTitle>}\r\n      {renderTableSelect()}\r\n    </TableSelectorWrapper>\r\n  );\r\n};\r\n\r\nexport default TableSelector;\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { Row, Col } from 'src/common/components';\r\nimport { Radio } from 'src/components/Radio';\r\nimport Card from 'src/components/Card';\r\nimport Alert from 'src/components/Alert';\r\nimport Badge from 'src/components/Badge';\r\nimport shortid from 'shortid';\r\nimport { styled, SupersetClient, t, supersetTheme } from '@superset-ui/core';\r\nimport Button from 'src/components/Button';\r\nimport Tabs from 'src/components/Tabs';\r\nimport CertifiedIcon from 'src/components/CertifiedIcon';\r\nimport WarningIconWithTooltip from 'src/components/WarningIconWithTooltip';\r\nimport DatabaseSelector from 'src/components/DatabaseSelector';\r\nimport Icon from 'src/components/Icon';\r\nimport Label from 'src/components/Label';\r\nimport Loading from 'src/components/Loading';\r\nimport TableSelector from 'src/components/TableSelector';\r\nimport EditableTitle from 'src/components/EditableTitle';\r\n\r\nimport { getClientErrorObject } from 'src/utils/getClientErrorObject';\r\n\r\nimport CheckboxControl from 'src/explore/components/controls/CheckboxControl';\r\nimport TextControl from 'src/explore/components/controls/TextControl';\r\nimport SelectControl from 'src/explore/components/controls/SelectControl';\r\nimport TextAreaControl from 'src/explore/components/controls/TextAreaControl';\r\nimport SelectAsyncControl from 'src/explore/components/controls/SelectAsyncControl';\r\nimport SpatialControl from 'src/explore/components/controls/SpatialControl';\r\n\r\nimport CollectionTable from 'src/CRUD/CollectionTable';\r\nimport Fieldset from 'src/CRUD/Fieldset';\r\nimport Field from 'src/CRUD/Field';\r\n\r\nimport withToasts from 'src/messageToasts/enhancers/withToasts';\r\nimport { FeatureFlag, isFeatureEnabled } from 'src/featureFlags';\r\n\r\nconst DatasourceContainer = styled.div`\r\n  .change-warning {\r\n    margin: 16px 10px 0;\r\n    color: ${({ theme }) => theme.colors.warning.base};\r\n  }\r\n\r\n  .change-warning .bold {\r\n    font-weight: ${({ theme }) => theme.typography.weights.bold};\r\n  }\r\n\r\n  .form-group.has-feedback > .help-block {\r\n    margin-top: 8px;\r\n  }\r\n\r\n  .form-group.form-group-md {\r\n    margin-bottom: 8px;\r\n  }\r\n`;\r\n\r\nconst FlexRowContainer = styled.div`\r\n  align-items: center;\r\n  display: flex;\r\n\r\n  > svg {\r\n    margin-right: ${({ theme }) => theme.gridUnit}px;\r\n  }\r\n`;\r\n\r\nconst StyledTableTabs = styled(Tabs)`\r\n  overflow: visible;\r\n  .ant-tabs-content-holder {\r\n    overflow: visible;\r\n  }\r\n`;\r\n\r\nconst EditLockContainer = styled.div`\r\n  font-size: ${supersetTheme.typography.sizes.s}px;\r\n  display: flex;\r\n  align-items: center;\r\n  a {\r\n    padding: 0 10px;\r\n  }\r\n`;\r\n\r\nconst ColumnButtonWrapper = styled.div`\r\n  text-align: right;\r\n  ${({ theme }) => `margin-bottom: ${theme.gridUnit * 2}px`}\r\n`;\r\n\r\nconst checkboxGenerator = (d, onChange) => (\r\n  <CheckboxControl value={d} onChange={onChange} />\r\n);\r\nconst DATA_TYPES = ['STRING', 'NUMERIC', 'DATETIME'];\r\n\r\nconst DATASOURCE_TYPES_ARR = [\r\n  { key: 'physical', label: t('Physical (table or view)') },\r\n  { key: 'virtual', label: t('Virtual (SQL)') },\r\n];\r\nconst DATASOURCE_TYPES = {};\r\nDATASOURCE_TYPES_ARR.forEach(o => {\r\n  DATASOURCE_TYPES[o.key] = o;\r\n});\r\n\r\nfunction CollectionTabTitle({ title, collection }) {\r\n  return (\r\n    <div data-test={`collection-tab-${title}`}>\r\n      {title} <Badge count={collection ? collection.length : 0} showZero />\r\n    </div>\r\n  );\r\n}\r\n\r\nCollectionTabTitle.propTypes = {\r\n  title: PropTypes.string,\r\n  collection: PropTypes.array,\r\n};\r\n\r\nfunction ColumnCollectionTable({\r\n  columns,\r\n  onChange,\r\n  editableColumnName,\r\n  showExpression,\r\n  allowAddItem,\r\n  allowEditDataType,\r\n  itemGenerator,\r\n}) {\r\n  return (\r\n    <CollectionTable\r\n      collection={columns}\r\n      tableColumns={['column_name', 'type', 'is_dttm', 'filterable', 'groupby']}\r\n      allowDeletes\r\n      allowAddItem={allowAddItem}\r\n      itemGenerator={itemGenerator}\r\n      stickyHeader\r\n      expandFieldset={\r\n        <FormContainer>\r\n          <Fieldset compact>\r\n            {showExpression && (\r\n              <Field\r\n                fieldKey=\"expression\"\r\n                label={t('SQL expression')}\r\n                control={\r\n                  <TextAreaControl\r\n                    language=\"markdown\"\r\n                    offerEditInModal={false}\r\n                  />\r\n                }\r\n              />\r\n            )}\r\n            <Field\r\n              fieldKey=\"verbose_name\"\r\n              label={t('Label')}\r\n              control={\r\n                <TextControl\r\n                  controlId=\"verbose_name\"\r\n                  placeholder={t('Label')}\r\n                />\r\n              }\r\n            />\r\n            <Field\r\n              fieldKey=\"description\"\r\n              label={t('Description')}\r\n              control={\r\n                <TextControl\r\n                  controlId=\"description\"\r\n                  placeholder={t('Description')}\r\n                />\r\n              }\r\n            />\r\n            {allowEditDataType && (\r\n              <Field\r\n                fieldKey=\"type\"\r\n                label={t('Data type')}\r\n                control={\r\n                  <SelectControl choices={DATA_TYPES} name=\"type\" freeForm />\r\n                }\r\n              />\r\n            )}\r\n            <Field\r\n              fieldKey=\"python_date_format\"\r\n              label={t('Datetime format')}\r\n              description={\r\n                /* Note the fragmented translations may not work. */\r\n                <div>\r\n                  {t('The pattern of timestamp format. For strings use ')}\r\n                  <a href=\"https://docs.python.org/2/library/datetime.html#strftime-strptime-behavior\">\r\n                    {t('Python datetime string pattern')}\r\n                  </a>\r\n                  {t(' expression which needs to adhere to the ')}\r\n                  <a href=\"https://en.wikipedia.org/wiki/ISO_8601\">\r\n                    {t('ISO 8601')}\r\n                  </a>\r\n                  {t(` standard to ensure that the lexicographical ordering\r\n                      coincides with the chronological ordering. If the\r\n                      timestamp format does not adhere to the ISO 8601 standard\r\n                      you will need to define an expression and type for\r\n                      transforming the string into a date or timestamp. Note\r\n                      currently time zones are not supported. If time is stored\r\n                      in epoch format, put \\`epoch_s\\` or \\`epoch_ms\\`. If no pattern\r\n                      is specified we fall back to using the optional defaults on a per\r\n                      database/column name level via the extra parameter.`)}\r\n                </div>\r\n              }\r\n              control={\r\n                <TextControl\r\n                  controlId=\"python_date_format\"\r\n                  placeholder=\"%Y/%m/%d\"\r\n                />\r\n              }\r\n            />\r\n          </Fieldset>\r\n        </FormContainer>\r\n      }\r\n      columnLabels={{\r\n        column_name: t('Column'),\r\n        type: t('Data type'),\r\n        groupby: t('Is dimension'),\r\n        is_dttm: t('Is temporal'),\r\n        filterable: t('Is filterable'),\r\n      }}\r\n      onChange={onChange}\r\n      itemRenderers={{\r\n        column_name: (v, onItemChange) =>\r\n          editableColumnName ? (\r\n            <EditableTitle canEdit title={v} onSaveTitle={onItemChange} />\r\n          ) : (\r\n            v\r\n          ),\r\n        type: d => (d ? <Label>{d}</Label> : null),\r\n        is_dttm: checkboxGenerator,\r\n        filterable: checkboxGenerator,\r\n        groupby: checkboxGenerator,\r\n      }}\r\n    />\r\n  );\r\n}\r\nColumnCollectionTable.propTypes = {\r\n  columns: PropTypes.array.isRequired,\r\n  onChange: PropTypes.func.isRequired,\r\n  editableColumnName: PropTypes.bool,\r\n  showExpression: PropTypes.bool,\r\n  allowAddItem: PropTypes.bool,\r\n  allowEditDataType: PropTypes.bool,\r\n  itemGenerator: PropTypes.func,\r\n};\r\nColumnCollectionTable.defaultProps = {\r\n  editableColumnName: false,\r\n  showExpression: false,\r\n  allowAddItem: false,\r\n  allowEditDataType: false,\r\n  itemGenerator: () => ({\r\n    column_name: '<new column>',\r\n    filterable: true,\r\n    groupby: true,\r\n  }),\r\n};\r\n\r\nfunction StackedField({ label, formElement }) {\r\n  return (\r\n    <div>\r\n      <div>\r\n        <strong>{label}</strong>\r\n      </div>\r\n      <div>{formElement}</div>\r\n    </div>\r\n  );\r\n}\r\n\r\nStackedField.propTypes = {\r\n  label: PropTypes.string,\r\n  formElement: PropTypes.node,\r\n};\r\n\r\nfunction FormContainer({ children }) {\r\n  return <Card padded>{children}</Card>;\r\n}\r\n\r\nFormContainer.propTypes = {\r\n  children: PropTypes.node,\r\n};\r\n\r\nconst propTypes = {\r\n  datasource: PropTypes.object.isRequired,\r\n  onChange: PropTypes.func,\r\n  addSuccessToast: PropTypes.func.isRequired,\r\n  addDangerToast: PropTypes.func.isRequired,\r\n};\r\n\r\nconst defaultProps = {\r\n  onChange: () => {},\r\n};\r\n\r\nclass DatasourceEditor extends React.PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      datasource: props.datasource,\r\n      errors: [],\r\n      isDruid:\r\n        props.datasource.type === 'druid' ||\r\n        props.datasource.datasource_type === 'druid',\r\n      isSqla:\r\n        props.datasource.datasource_type === 'table' ||\r\n        props.datasource.type === 'table',\r\n      isEditMode: false,\r\n      databaseColumns: props.datasource.columns.filter(col => !col.expression),\r\n      calculatedColumns: props.datasource.columns.filter(\r\n        col => !!col.expression,\r\n      ),\r\n      metadataLoading: false,\r\n      activeTabKey: 0,\r\n      datasourceType: props.datasource.sql\r\n        ? DATASOURCE_TYPES.virtual.key\r\n        : DATASOURCE_TYPES.physical.key,\r\n    };\r\n\r\n    this.onChange = this.onChange.bind(this);\r\n    this.onChangeEditMode = this.onChangeEditMode.bind(this);\r\n    this.onDatasourcePropChange = this.onDatasourcePropChange.bind(this);\r\n    this.onDatasourceChange = this.onDatasourceChange.bind(this);\r\n    this.syncMetadata = this.syncMetadata.bind(this);\r\n    this.setColumns = this.setColumns.bind(this);\r\n    this.validateAndChange = this.validateAndChange.bind(this);\r\n    this.handleTabSelect = this.handleTabSelect.bind(this);\r\n    this.allowEditSource = !isFeatureEnabled(\r\n      FeatureFlag.DISABLE_DATASET_SOURCE_EDIT,\r\n    );\r\n  }\r\n\r\n  onChange() {\r\n    // Emptying SQL if \"Physical\" radio button is selected\r\n    // Currently the logic to know whether the source is\r\n    // physical or virtual is based on whether SQL is empty or not.\r\n    const { datasourceType, datasource } = this.state;\r\n    const sql =\r\n      datasourceType === DATASOURCE_TYPES.physical.key ? '' : datasource.sql;\r\n\r\n    const newDatasource = {\r\n      ...this.state.datasource,\r\n      sql,\r\n      columns: [...this.state.databaseColumns, ...this.state.calculatedColumns],\r\n    };\r\n    this.props.onChange(newDatasource, this.state.errors);\r\n  }\r\n\r\n  onChangeEditMode() {\r\n    this.setState(prevState => ({ isEditMode: !prevState.isEditMode }));\r\n  }\r\n\r\n  onDatasourceChange(datasource) {\r\n    this.setState({ datasource }, this.validateAndChange);\r\n  }\r\n\r\n  onDatasourcePropChange(attr, value) {\r\n    const datasource = { ...this.state.datasource, [attr]: value };\r\n    this.setState(\r\n      prevState => ({\r\n        datasource: { ...prevState.datasource, [attr]: value },\r\n      }),\r\n      this.onDatasourceChange(datasource),\r\n    );\r\n  }\r\n\r\n  onDatasourceTypeChange(datasourceType) {\r\n    this.setState({ datasourceType });\r\n  }\r\n\r\n  setColumns(obj) {\r\n    // update calculatedColumns or databaseColumns\r\n    this.setState(obj, this.validateAndChange);\r\n  }\r\n\r\n  validateAndChange() {\r\n    this.validate(this.onChange);\r\n  }\r\n\r\n  updateColumns(cols) {\r\n    const { databaseColumns } = this.state;\r\n    const databaseColumnNames = cols.map(col => col.name);\r\n    const currentCols = databaseColumns.reduce(\r\n      (agg, col) => ({\r\n        ...agg,\r\n        [col.column_name]: col,\r\n      }),\r\n      {},\r\n    );\r\n    const finalColumns = [];\r\n    const results = {\r\n      added: [],\r\n      modified: [],\r\n      removed: databaseColumns\r\n        .map(col => col.column_name)\r\n        .filter(col => !databaseColumnNames.includes(col)),\r\n    };\r\n    cols.forEach(col => {\r\n      const currentCol = currentCols[col.name];\r\n      if (!currentCol) {\r\n        // new column\r\n        finalColumns.push({\r\n          id: shortid.generate(),\r\n          column_name: col.name,\r\n          type: col.type,\r\n          groupby: true,\r\n          filterable: true,\r\n          is_dttm: col.is_dttm,\r\n        });\r\n        results.added.push(col.name);\r\n      } else if (\r\n        currentCol.type !== col.type ||\r\n        currentCol.is_dttm !== col.is_dttm\r\n      ) {\r\n        // modified column\r\n        finalColumns.push({\r\n          ...currentCol,\r\n          type: col.type,\r\n          is_dttm: col.is_dttm,\r\n        });\r\n        results.modified.push(col.name);\r\n      } else {\r\n        // unchanged\r\n        finalColumns.push(currentCol);\r\n      }\r\n    });\r\n    if (\r\n      results.added.length ||\r\n      results.modified.length ||\r\n      results.removed.length\r\n    ) {\r\n      this.setColumns({ databaseColumns: finalColumns });\r\n    }\r\n    return results;\r\n  }\r\n\r\n  syncMetadata() {\r\n    const { datasource } = this.state;\r\n    const endpoint = `/datasource/external_metadata/${\r\n      datasource.type || datasource.datasource_type\r\n    }/${datasource.id}/`;\r\n    this.setState({ metadataLoading: true });\r\n\r\n    SupersetClient.get({ endpoint })\r\n      .then(({ json }) => {\r\n        const results = this.updateColumns(json);\r\n        if (results.modified.length) {\r\n          this.props.addSuccessToast(\r\n            t('Modified columns: %s', results.modified.join(', ')),\r\n          );\r\n        }\r\n        if (results.removed.length) {\r\n          this.props.addSuccessToast(\r\n            t('Removed columns: %s', results.removed.join(', ')),\r\n          );\r\n        }\r\n        if (results.added.length) {\r\n          this.props.addSuccessToast(\r\n            t('New columns added: %s', results.added.join(', ')),\r\n          );\r\n        }\r\n        this.props.addSuccessToast(t('Metadata has been synced'));\r\n        this.setState({ metadataLoading: false });\r\n      })\r\n      .catch(response =>\r\n        getClientErrorObject(response).then(({ error, statusText }) => {\r\n          this.props.addDangerToast(\r\n            error || statusText || t('An error has occurred'),\r\n          );\r\n          this.setState({ metadataLoading: false });\r\n        }),\r\n      );\r\n  }\r\n\r\n  findDuplicates(arr, accessor) {\r\n    const seen = {};\r\n    const dups = [];\r\n    arr.forEach(obj => {\r\n      const item = accessor(obj);\r\n      if (item in seen) {\r\n        dups.push(item);\r\n      } else {\r\n        seen[item] = null;\r\n      }\r\n    });\r\n    return dups;\r\n  }\r\n\r\n  validate(callback) {\r\n    let errors = [];\r\n    let dups;\r\n    const { datasource } = this.state;\r\n\r\n    // Looking for duplicate column_name\r\n    dups = this.findDuplicates(datasource.columns, obj => obj.column_name);\r\n    errors = errors.concat(\r\n      dups.map(name => t('Column name [%s] is duplicated', name)),\r\n    );\r\n\r\n    // Looking for duplicate metric_name\r\n    dups = this.findDuplicates(datasource.metrics, obj => obj.metric_name);\r\n    errors = errors.concat(\r\n      dups.map(name => t('Metric name [%s] is duplicated', name)),\r\n    );\r\n\r\n    // Making sure calculatedColumns have an expression defined\r\n    const noFilterCalcCols = this.state.calculatedColumns.filter(\r\n      col => !col.expression && !col.json,\r\n    );\r\n    errors = errors.concat(\r\n      noFilterCalcCols.map(col =>\r\n        t('Calculated column [%s] requires an expression', col.column_name),\r\n      ),\r\n    );\r\n\r\n    this.setState({ errors }, callback);\r\n  }\r\n\r\n  handleTabSelect(activeTabKey) {\r\n    this.setState({ activeTabKey });\r\n  }\r\n\r\n  renderSettingsFieldset() {\r\n    const { datasource } = this.state;\r\n    return (\r\n      <Fieldset\r\n        title={t('Basic')}\r\n        item={datasource}\r\n        onChange={this.onDatasourceChange}\r\n      >\r\n        <Field\r\n          fieldKey=\"description\"\r\n          label={t('Description')}\r\n          control={\r\n            <TextAreaControl language=\"markdown\" offerEditInModal={false} />\r\n          }\r\n        />\r\n        <Field\r\n          fieldKey=\"default_endpoint\"\r\n          label={t('Default URL')}\r\n          description={t(\r\n            'Default URL to redirect to when accessing from the dataset list page',\r\n          )}\r\n          control={<TextControl controlId=\"default_endpoint\" />}\r\n        />\r\n        <Field\r\n          inline\r\n          fieldKey=\"filter_select_enabled\"\r\n          label={t('Autocomplete filters')}\r\n          description={t('Whether to populate autocomplete filters options')}\r\n          control={<CheckboxControl />}\r\n        />\r\n        {this.state.isSqla && (\r\n          <Field\r\n            fieldKey=\"fetch_values_predicate\"\r\n            label={t('Autocomplete query predicate')}\r\n            description={t(\r\n              'When using \"Autocomplete filters\", this can be used to improve performance ' +\r\n                'of the query fetching the values. Use this option to apply a ' +\r\n                'predicate (WHERE clause) to the query selecting the distinct ' +\r\n                'values from the table. Typically the intent would be to limit the scan ' +\r\n                'by applying a relative time filter on a partitioned or indexed time-related field.',\r\n            )}\r\n            control={<TextControl controlId=\"fetch_values_predicate\" />}\r\n          />\r\n        )}\r\n        {this.state.isSqla && (\r\n          <Field\r\n            fieldKey=\"extra\"\r\n            label={t('Extra')}\r\n            description={t(\r\n              'Extra data to specify table metadata. Currently supports ' +\r\n                'metadata of the format: `{ \"certification\": { \"certified_by\": ' +\r\n                '\"Data Platform Team\", \"details\": \"This table is the source of truth.\" ' +\r\n                '}, \"warning_markdown\": \"This is a warning.\" }`.',\r\n            )}\r\n            control={\r\n              <TextAreaControl\r\n                controlId=\"extra\"\r\n                language=\"json\"\r\n                offerEditInModal={false}\r\n              />\r\n            }\r\n          />\r\n        )}\r\n        <Field\r\n          fieldKey=\"owners\"\r\n          label={t('Owners')}\r\n          description={t('Owners of the dataset')}\r\n          control={\r\n            <SelectAsyncControl\r\n              dataEndpoint=\"api/v1/dataset/related/owners\"\r\n              multi\r\n              mutator={data =>\r\n                data.result.map(pk => ({\r\n                  value: pk.value,\r\n                  label: `${pk.text}`,\r\n                }))\r\n              }\r\n            />\r\n          }\r\n          controlProps={{}}\r\n        />\r\n      </Fieldset>\r\n    );\r\n  }\r\n\r\n  renderAdvancedFieldset() {\r\n    const { datasource } = this.state;\r\n    return (\r\n      <Fieldset\r\n        title={t('Advanced')}\r\n        item={datasource}\r\n        onChange={this.onDatasourceChange}\r\n      >\r\n        <Field\r\n          fieldKey=\"cache_timeout\"\r\n          label={t('Cache timeout')}\r\n          description={t(\r\n            'The duration of time in seconds before the cache is invalidated',\r\n          )}\r\n          control={<TextControl controlId=\"cache_timeout\" />}\r\n        />\r\n        <Field\r\n          fieldKey=\"offset\"\r\n          label={t('Hours offset')}\r\n          control={<TextControl controlId=\"offset\" />}\r\n          description={t(\r\n            'The number of hours, negative or positive, to shift the time column. This can be used to move UTC time to local time.',\r\n          )}\r\n        />\r\n        {this.state.isSqla && (\r\n          <Field\r\n            fieldKey=\"template_params\"\r\n            label={t('Template parameters')}\r\n            description={t(\r\n              'A set of parameters that become available in the query using Jinja templating syntax',\r\n            )}\r\n            control={<TextControl controlId=\"template_params\" />}\r\n          />\r\n        )}\r\n      </Fieldset>\r\n    );\r\n  }\r\n\r\n  renderSpatialTab() {\r\n    const { datasource } = this.state;\r\n    const { spatials, all_cols: allCols } = datasource;\r\n    return (\r\n      <Tabs.TabPane\r\n        tab={<CollectionTabTitle collection={spatials} title={t('Spatial')} />}\r\n        key={4}\r\n      >\r\n        <CollectionTable\r\n          tableColumns={['name', 'config']}\r\n          onChange={this.onDatasourcePropChange.bind(this, 'spatials')}\r\n          itemGenerator={() => ({\r\n            name: '<new spatial>',\r\n            type: '<no type>',\r\n            config: null,\r\n          })}\r\n          collection={spatials}\r\n          allowDeletes\r\n          itemRenderers={{\r\n            name: (d, onChange) => (\r\n              <EditableTitle canEdit title={d} onSaveTitle={onChange} />\r\n            ),\r\n            config: (v, onChange) => (\r\n              <SpatialControl value={v} onChange={onChange} choices={allCols} />\r\n            ),\r\n          }}\r\n        />\r\n      </Tabs.TabPane>\r\n    );\r\n  }\r\n\r\n  renderSourceFieldset() {\r\n    const { datasource } = this.state;\r\n    return (\r\n      <div>\r\n        <div className=\"m-l-10 m-t-20 m-b-10\">\r\n          {DATASOURCE_TYPES_ARR.map(type => (\r\n            <Radio\r\n              key={type.key}\r\n              value={type.key}\r\n              inline\r\n              onChange={this.onDatasourceTypeChange.bind(this, type.key)}\r\n              checked={this.state.datasourceType === type.key}\r\n              disabled={!this.state.isEditMode}\r\n            >\r\n              {type.label}\r\n            </Radio>\r\n          ))}\r\n        </div>\r\n        <hr />\r\n        <Fieldset item={datasource} onChange={this.onDatasourceChange} compact>\r\n          {this.state.datasourceType === DATASOURCE_TYPES.virtual.key && (\r\n            <div>\r\n              {this.state.isSqla && (\r\n                <>\r\n                  <Field\r\n                    fieldKey=\"databaseSelector\"\r\n                    label={t('virtual')}\r\n                    control={\r\n                      <DatabaseSelector\r\n                        dbId={datasource.database.id}\r\n                        schema={datasource.schema}\r\n                        onSchemaChange={schema =>\r\n                          this.state.isEditMode &&\r\n                          this.onDatasourcePropChange('schema', schema)\r\n                        }\r\n                        onDbChange={database =>\r\n                          this.state.isEditMode &&\r\n                          this.onDatasourcePropChange('database', database)\r\n                        }\r\n                        formMode={false}\r\n                        handleError={this.props.addDangerToast}\r\n                        readOnly={!this.state.isEditMode}\r\n                      />\r\n                    }\r\n                  />\r\n                  <Field\r\n                    fieldKey=\"table_name\"\r\n                    label={t('Dataset name')}\r\n                    control={\r\n                      <TextControl\r\n                        controlId=\"table_name\"\r\n                        onChange={table => {\r\n                          this.onDatasourcePropChange('table_name', table);\r\n                        }}\r\n                        placeholder={t('Dataset name')}\r\n                        disabled={!this.state.isEditMode}\r\n                      />\r\n                    }\r\n                  />\r\n                  <Field\r\n                    fieldKey=\"sql\"\r\n                    label={t('SQL')}\r\n                    description={t(\r\n                      'When specifying SQL, the datasource acts as a view. ' +\r\n                        'Superset will use this statement as a subquery while grouping and filtering ' +\r\n                        'on the generated parent queries.',\r\n                    )}\r\n                    control={\r\n                      <TextAreaControl\r\n                        language=\"sql\"\r\n                        offerEditInModal={false}\r\n                        minLines={20}\r\n                        maxLines={20}\r\n                        readOnly={!this.state.isEditMode}\r\n                      />\r\n                    }\r\n                  />\r\n                </>\r\n              )}\r\n              {this.state.isDruid && (\r\n                <Field\r\n                  fieldKey=\"json\"\r\n                  label={t('JSON')}\r\n                  description={\r\n                    <div>\r\n                      {t('The JSON metric or post aggregation definition.')}\r\n                    </div>\r\n                  }\r\n                  control={\r\n                    <TextAreaControl language=\"json\" offerEditInModal={false} />\r\n                  }\r\n                />\r\n              )}\r\n            </div>\r\n          )}\r\n          {this.state.datasourceType === DATASOURCE_TYPES.physical.key && (\r\n            <Col xs={24} md={12}>\r\n              {this.state.isSqla && (\r\n                <Field\r\n                  fieldKey=\"tableSelector\"\r\n                  label={t('Physical')}\r\n                  control={\r\n                    <TableSelector\r\n                      clearable={false}\r\n                      dbId={datasource.database.id}\r\n                      handleError={this.props.addDangerToast}\r\n                      schema={datasource.schema}\r\n                      sqlLabMode={false}\r\n                      tableName={datasource.table_name}\r\n                      onSchemaChange={\r\n                        this.state.isEditMode\r\n                          ? schema =>\r\n                              this.onDatasourcePropChange('schema', schema)\r\n                          : undefined\r\n                      }\r\n                      onDbChange={\r\n                        this.state.isEditMode\r\n                          ? database =>\r\n                              this.onDatasourcePropChange('database', database)\r\n                          : undefined\r\n                      }\r\n                      onTableChange={\r\n                        this.state.isEditMode\r\n                          ? table =>\r\n                              this.onDatasourcePropChange('table_name', table)\r\n                          : undefined\r\n                      }\r\n                      readOnly={!this.state.isEditMode}\r\n                    />\r\n                  }\r\n                  description={t(\r\n                    'The pointer to a physical table (or view). Keep in mind that the chart is ' +\r\n                      'associated to this Superset logical table, and this logical table points ' +\r\n                      'the physical table referenced here.',\r\n                  )}\r\n                />\r\n              )}\r\n            </Col>\r\n          )}\r\n        </Fieldset>\r\n        {this.allowEditSource && (\r\n          <EditLockContainer>\r\n            <span role=\"button\" tabIndex={0} onClick={this.onChangeEditMode}>\r\n              <Icon\r\n                color={supersetTheme.colors.grayscale.base}\r\n                name={this.state.isEditMode ? 'lock-unlocked' : 'lock-locked'}\r\n              />\r\n            </span>\r\n            {!this.state.isEditMode && (\r\n              <div>{t('Click the lock to make changes.')}</div>\r\n            )}\r\n            {this.state.isEditMode && (\r\n              <div>{t('Click the lock to prevent further changes.')}</div>\r\n            )}\r\n          </EditLockContainer>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderErrors() {\r\n    if (this.state.errors.length > 0) {\r\n      return (\r\n        <Alert\r\n          css={theme => ({ marginBottom: theme.gridUnit * 4 })}\r\n          type=\"error\"\r\n          message={\r\n            <>\r\n              {this.state.errors.map(err => (\r\n                <div key={err}>{err}</div>\r\n              ))}\r\n            </>\r\n          }\r\n        />\r\n      );\r\n    }\r\n    return null;\r\n  }\r\n\r\n  renderMetricCollection() {\r\n    return (\r\n      <CollectionTable\r\n        tableColumns={['metric_name', 'verbose_name', 'expression']}\r\n        columnLabels={{\r\n          metric_name: t('Metric'),\r\n          verbose_name: t('Label'),\r\n          expression: t('SQL expression'),\r\n        }}\r\n        expandFieldset={\r\n          <FormContainer>\r\n            <Fieldset compact>\r\n              <Field\r\n                fieldKey=\"verbose_name\"\r\n                label={t('Label')}\r\n                control={<TextControl controlId=\"verbose_name\" />}\r\n              />\r\n              <Field\r\n                fieldKey=\"description\"\r\n                label={t('Description')}\r\n                control={\r\n                  <TextControl\r\n                    controlId=\"description\"\r\n                    placeholder={t('Description')}\r\n                  />\r\n                }\r\n              />\r\n              <Field\r\n                fieldKey=\"d3format\"\r\n                label={t('D3 format')}\r\n                control={\r\n                  <TextControl controlId=\"d3format\" placeholder=\"%y/%m/%d\" />\r\n                }\r\n              />\r\n              <Field\r\n                label={t('Certified by')}\r\n                fieldKey=\"certified_by\"\r\n                description={t(\r\n                  'Person or group that has certified this metric',\r\n                )}\r\n                control={\r\n                  <TextControl\r\n                    controlId=\"certified_by\"\r\n                    placeholder={t('Certified by')}\r\n                  />\r\n                }\r\n              />\r\n              <Field\r\n                label={t('Certification details')}\r\n                fieldKey=\"certification_details\"\r\n                description={t('Details of the certification')}\r\n                control={\r\n                  <TextControl\r\n                    controlId=\"certification_details\"\r\n                    placeholder={t('Certification details')}\r\n                  />\r\n                }\r\n              />\r\n              <Field\r\n                label={t('Warning')}\r\n                fieldKey=\"warning_markdown\"\r\n                description={t('Optional warning about use of this metric')}\r\n                control={\r\n                  <TextAreaControl\r\n                    controlId=\"warning_markdown\"\r\n                    language=\"markdown\"\r\n                    offerEditInModal={false}\r\n                  />\r\n                }\r\n              />\r\n            </Fieldset>\r\n          </FormContainer>\r\n        }\r\n        collection={this.state.datasource.metrics?.map(metric => {\r\n          const {\r\n            certification: { details, certified_by: certifiedBy } = {},\r\n            warning_markdown: warningMarkdown,\r\n          } = JSON.parse(metric.extra || '{}') || {};\r\n          return {\r\n            ...metric,\r\n            certification_details: details || '',\r\n            warning_markdown: warningMarkdown || '',\r\n            certified_by: certifiedBy,\r\n          };\r\n        })}\r\n        allowAddItem\r\n        onChange={this.onDatasourcePropChange.bind(this, 'metrics')}\r\n        itemGenerator={() => ({\r\n          metric_name: '<new metric>',\r\n          verbose_name: '',\r\n          expression: '',\r\n        })}\r\n        itemRenderers={{\r\n          metric_name: (v, onChange, _, record) => (\r\n            <FlexRowContainer>\r\n              {record.is_certified && (\r\n                <CertifiedIcon\r\n                  certifiedBy={record.certified_by}\r\n                  details={record.certification_details}\r\n                />\r\n              )}\r\n              {record.warning_markdown && (\r\n                <WarningIconWithTooltip\r\n                  warningMarkdown={record.warning_markdown}\r\n                />\r\n              )}\r\n              <EditableTitle canEdit title={v} onSaveTitle={onChange} />\r\n            </FlexRowContainer>\r\n          ),\r\n          verbose_name: (v, onChange) => (\r\n            <EditableTitle canEdit title={v} onSaveTitle={onChange} />\r\n          ),\r\n          expression: (v, onChange) => (\r\n            <EditableTitle\r\n              canEdit\r\n              title={v}\r\n              onSaveTitle={onChange}\r\n              extraClasses={['datasource-sql-expression']}\r\n              multiLine\r\n            />\r\n          ),\r\n          description: (v, onChange, label) => (\r\n            <StackedField\r\n              label={label}\r\n              formElement={<TextControl value={v} onChange={onChange} />}\r\n            />\r\n          ),\r\n          d3format: (v, onChange, label) => (\r\n            <StackedField\r\n              label={label}\r\n              formElement={<TextControl value={v} onChange={onChange} />}\r\n            />\r\n          ),\r\n        }}\r\n        allowDeletes\r\n        stickyHeader\r\n      />\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { datasource, activeTabKey } = this.state;\r\n    return (\r\n      <DatasourceContainer>\r\n        {this.renderErrors()}\r\n        <Alert\r\n          css={theme => ({ marginBottom: theme.gridUnit * 4 })}\r\n          type=\"warning\"\r\n          message={\r\n            <>\r\n              {' '}\r\n              <strong>{t('Be careful.')} </strong>\r\n              {t(\r\n                'Changing these settings will affect all charts using this dataset, including charts owned by other people.',\r\n              )}\r\n            </>\r\n          }\r\n        />\r\n        <StyledTableTabs\r\n          fullWidth={false}\r\n          id=\"table-tabs\"\r\n          data-test=\"edit-dataset-tabs\"\r\n          onChange={this.handleTabSelect}\r\n          defaultActiveKey={activeTabKey}\r\n        >\r\n          <Tabs.TabPane key={0} tab={t('Source')}>\r\n            {this.renderSourceFieldset()}\r\n          </Tabs.TabPane>\r\n          <Tabs.TabPane\r\n            tab={\r\n              <CollectionTabTitle\r\n                collection={datasource.metrics}\r\n                title={t('Metrics')}\r\n              />\r\n            }\r\n            key={1}\r\n          >\r\n            {this.renderMetricCollection()}\r\n          </Tabs.TabPane>\r\n          <Tabs.TabPane\r\n            tab={\r\n              <CollectionTabTitle\r\n                collection={this.state.databaseColumns}\r\n                title={t('Columns')}\r\n              />\r\n            }\r\n            key={2}\r\n          >\r\n            <div>\r\n              <ColumnButtonWrapper>\r\n                <span className=\"m-t-10 m-r-10\">\r\n                  <Button\r\n                    buttonSize=\"small\"\r\n                    buttonStyle=\"primary\"\r\n                    onClick={this.syncMetadata}\r\n                    className=\"sync-from-source\"\r\n                  >\r\n                    <i className=\"fa fa-database\" />{' '}\r\n                    {t('Sync columns from source')}\r\n                  </Button>\r\n                </span>\r\n              </ColumnButtonWrapper>\r\n              <ColumnCollectionTable\r\n                className=\"columns-table\"\r\n                columns={this.state.databaseColumns}\r\n                onChange={databaseColumns =>\r\n                  this.setColumns({ databaseColumns })\r\n                }\r\n              />\r\n              {this.state.metadataLoading && <Loading />}\r\n            </div>\r\n          </Tabs.TabPane>\r\n          <Tabs.TabPane\r\n            tab={\r\n              <CollectionTabTitle\r\n                collection={this.state.calculatedColumns}\r\n                title={t('Calculated columns')}\r\n              />\r\n            }\r\n            key={3}\r\n          >\r\n            <ColumnCollectionTable\r\n              columns={this.state.calculatedColumns}\r\n              onChange={calculatedColumns =>\r\n                this.setColumns({ calculatedColumns })\r\n              }\r\n              editableColumnName\r\n              showExpression\r\n              allowAddItem\r\n              allowEditDataType\r\n              itemGenerator={() => ({\r\n                column_name: '<new column>',\r\n                filterable: true,\r\n                groupby: true,\r\n                expression: '<enter SQL expression here>',\r\n                __expanded: true,\r\n              })}\r\n            />\r\n          </Tabs.TabPane>\r\n          <Tabs.TabPane key={4} tab={t('Settings')}>\r\n            <Row gutter={16}>\r\n              <Col xs={24} md={12}>\r\n                <FormContainer>{this.renderSettingsFieldset()}</FormContainer>\r\n              </Col>\r\n              <Col xs={24} md={12}>\r\n                <FormContainer>{this.renderAdvancedFieldset()}</FormContainer>\r\n              </Col>\r\n            </Row>\r\n          </Tabs.TabPane>\r\n        </StyledTableTabs>\r\n      </DatasourceContainer>\r\n    );\r\n  }\r\n}\r\n\r\nDatasourceEditor.defaultProps = defaultProps;\r\nDatasourceEditor.propTypes = propTypes;\r\n\r\nexport default withToasts(DatasourceEditor);\r\n"],"sourceRoot":""}