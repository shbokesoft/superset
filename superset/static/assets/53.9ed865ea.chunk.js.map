{"version":3,"sources":["webpack:///./src/filters/components/TimeColumn/TimeColumnFilterPlugin.tsx","webpack:///./src/filters/components/common.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;wSAAA;;;;;;;;;;;;;;;;;AAiBG;AACH;AAOA;AACA;;AAIA,MAAM,EAAE,MAAF,KAAa,4DAAnB;AAEc,SAAU,sBAAV,CACZ,KADY,EACsB;AAElC,QAAM,EACJ,IADI,EAEJ,QAFI,EAGJ,MAHI,EAIJ,KAJI,EAKJ,WALI,EAMJ,gBANI,EAOJ,kBAPI,EAQJ,WARI,KASF,KATJ;AAUA,QAAM,EAAE,YAAF,EAAgB,QAAhB,KAA6B,QAAnC;AAEA,QAAM,CAAC,KAAD,EAAQ,QAAR,IAAoB,sDAAQ,CAAW,YAAX,WAAW,YAAX,GAA2B,EAA3B,CAAlC;AAEA,QAAM,YAAY,GAAI,KAAD,IAAqC;AACxD,UAAM,WAAW,GAAa,iEAAa,CAAS,KAAT,CAA3C;AACA,YAAQ,CAAC,WAAD,CAAR;AACA,UAAM,aAAa,GAAkB,EAArC;AACA,QAAI,WAAW,CAAC,MAAhB,EAAwB;AACtB,mBAAa,CAAC,gBAAd,GAAiC,WAAW,CAAC,CAAD,CAA5C;AACD;AAED,eAAW,CAAC;AACV,mBADU;AAEV,iBAAW,EAAE;AACX,aAAK,EAAE,WAAW,CAAC,MAAZ,GAAqB,WAArB,GAAmC,IAD/B,EAFH,EAAD,CAAX;;;AAMD,GAdD;AAgBA,yDAAS,CAAC,MAAK;AACb,gBAAY,uBAAC,WAAW,CAAC,KAAb,iCAAsB,IAAtB,CAAZ;AACD,GAFQ,EAEN,CAAC,4FAAe,WAAW,CAAC,KAA3B,CAAD,CAFM,CAAT;AAIA,yDAAS,CAAC,MAAK;AACb,gBAAY,CAAC,YAAD,WAAC,YAAD,GAAiB,IAAjB,CAAZ;AACA;AACA;AACD,GAJQ,EAIN,CAAC,4FAAe,YAAf,CAAD,CAJM,CAAT;AAMA,QAAM,WAAW,GAAG,wGAAC,IAAI,IAAI,EAAT,iBAClB,GAAG,IAAI,GAAG,CAAC,KAAJ,KAAc,iEAAe,CAAC,QADnB,CAApB;AAIA,QAAM,eAAe,GACnB,WAAW,CAAC,MAAZ,KAAuB,CAAvB;AACI,6DAAC,CAAC,iBAAD,CADL;AAEI,8DAAE,CAAC,WAAD,EAAc,YAAd,EAA4B,WAAW,CAAC,MAAxC,EAAgD,WAAW,CAAC,MAA5D,CAHR;AAIA,SACE,4DAAC,8CAAD,IAAQ,MAAM,EAAE,MAAhB,EAAwB,KAAK,EAAE,KAA/B;AACE,8DAAC,oDAAD,IACE,UAAU,MADZ,EAEE,KAAK,EAAE,KAFT,EAGE,WAAW,EAAE;AACb;AAJF,MAKE,QAAQ,EAAE,YALZ,EAME,MAAM,EAAE,kBANV,EAOE,OAAO,EAAE,gBAPX,EAQE,GAAG,EAAE,QARP;AAUG,uGAAW,MAAX,YAAW,EACT,GAAD,IAA8D;AAC5D,UAAM,EAAE,WAAW,EAAE,UAAf,EAA2B,YAAY,EAAE,WAAzC,KAAyD,GAA/D;AACA,WACE,4DAAC,MAAD,IAAQ,GAAG,EAAE,UAAb,EAAyB,KAAK,EAAE,UAAhC;AACG,eADH,WACG,WADH,GACkB,UADlB,CADF;;AAKD,GARS,CAVd,CADF,CADF;;;AAyBD,C,cA5EuB,sB,gQAFhB,M,4KAEgB,sB;;;;;;;;;;;;;;;;;;wSChCxB;;;;;;;;;;;;;;;;;AAiBG;AACH;AACA;AAGO,MAAM,MAAM,GAAG,wDAAM,CAAC,GAA4B;YAC7C,CAAC,EAAE,MAAF,EAAD,KAAgB,MAAM;WACvB,CAAC,EAAE,KAAF,EAAD,KAAe,KAAK;AAC9B,CAHM;AAKA,MAAM,YAAY,GAAG,gEAAM,CAAC,4DAAD,CAAQ;;AAEzC,CAFM,C,iLALM,M,+IAKA,Y","file":"53.9ed865ea.chunk.js","sourcesContent":["/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport {\r\n  ensureIsArray,\r\n  ExtraFormData,\r\n  GenericDataType,\r\n  t,\r\n  tn,\r\n} from '@superset-ui/core';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Select } from 'src/common/components';\r\nimport { Styles, StyledSelect } from '../common';\r\nimport { PluginFilterTimeColumnProps } from './types';\r\n\r\nconst { Option } = Select;\r\n\r\nexport default function PluginFilterTimeColumn(\r\n  props: PluginFilterTimeColumnProps,\r\n) {\r\n  const {\r\n    data,\r\n    formData,\r\n    height,\r\n    width,\r\n    setDataMask,\r\n    setFocusedFilter,\r\n    unsetFocusedFilter,\r\n    filterState,\r\n  } = props;\r\n  const { defaultValue, inputRef } = formData;\r\n\r\n  const [value, setValue] = useState<string[]>(defaultValue ?? []);\r\n\r\n  const handleChange = (value?: string[] | string | null) => {\r\n    const resultValue: string[] = ensureIsArray<string>(value);\r\n    setValue(resultValue);\r\n    const extraFormData: ExtraFormData = {};\r\n    if (resultValue.length) {\r\n      extraFormData.granularity_sqla = resultValue[0];\r\n    }\r\n\r\n    setDataMask({\r\n      extraFormData,\r\n      filterState: {\r\n        value: resultValue.length ? resultValue : null,\r\n      },\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    handleChange(filterState.value ?? null);\r\n  }, [JSON.stringify(filterState.value)]);\r\n\r\n  useEffect(() => {\r\n    handleChange(defaultValue ?? null);\r\n    // I think after Config Modal update some filter it re-creates default value for all other filters\r\n    // so we can process it like this `JSON.stringify` or start to use `Immer`\r\n  }, [JSON.stringify(defaultValue)]);\r\n\r\n  const timeColumns = (data || []).filter(\r\n    row => row.dtype === GenericDataType.TEMPORAL,\r\n  );\r\n\r\n  const placeholderText =\r\n    timeColumns.length === 0\r\n      ? t('No time columns')\r\n      : tn('%s option', '%s options', timeColumns.length, timeColumns.length);\r\n  return (\r\n    <Styles height={height} width={width}>\r\n      <StyledSelect\r\n        allowClear\r\n        value={value}\r\n        placeholder={placeholderText}\r\n        // @ts-ignore\r\n        onChange={handleChange}\r\n        onBlur={unsetFocusedFilter}\r\n        onFocus={setFocusedFilter}\r\n        ref={inputRef}\r\n      >\r\n        {timeColumns.map(\r\n          (row: { column_name: string; verbose_name: string | null }) => {\r\n            const { column_name: columnName, verbose_name: verboseName } = row;\r\n            return (\r\n              <Option key={columnName} value={columnName}>\r\n                {verboseName ?? columnName}\r\n              </Option>\r\n            );\r\n          },\r\n        )}\r\n      </StyledSelect>\r\n    </Styles>\r\n  );\r\n}\r\n","/**\r\n * Licensed to the Apache Software Foundation (ASF) under one\r\n * or more contributor license agreements.  See the NOTICE file\r\n * distributed with this work for additional information\r\n * regarding copyright ownership.  The ASF licenses this file\r\n * to you under the Apache License, Version 2.0 (the\r\n * \"License\"); you may not use this file except in compliance\r\n * with the License.  You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing,\r\n * software distributed under the License is distributed on an\r\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n * KIND, either express or implied.  See the License for the\r\n * specific language governing permissions and limitations\r\n * under the License.\r\n */\r\nimport { styled } from '@superset-ui/core';\r\nimport { Select } from 'src/common/components';\r\nimport { PluginFilterStylesProps } from './types';\r\n\r\nexport const Styles = styled.div<PluginFilterStylesProps>`\r\n  height: ${({ height }) => height}px;\r\n  width: ${({ width }) => width}px;\r\n`;\r\n\r\nexport const StyledSelect = styled(Select)`\r\n  width: 100%;\r\n`;\r\n"],"sourceRoot":""}