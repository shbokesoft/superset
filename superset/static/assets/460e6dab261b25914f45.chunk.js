/*! For license information please see 460e6dab261b25914f45.chunk.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{3508:function(t,e,i){var s;!function(o,n,a){if(o){for(var r,l={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},h={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},u={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},c={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},p=1;p<20;++p)l[111+p]="f"+p;for(p=0;p<=9;++p)l[p+96]=p.toString();y.prototype.bind=function(t,e,i){return t=t instanceof Array?t:[t],this._bindMultiple.call(this,t,e,i),this},y.prototype.unbind=function(t,e){return this.bind.call(this,t,(function(){}),e)},y.prototype.trigger=function(t,e){return this._directMap[t+":"+e]&&this._directMap[t+":"+e]({},t),this},y.prototype.reset=function(){return this._callbacks={},this._directMap={},this},y.prototype.stopCallback=function(t,e){return!((" "+e.className+" ").indexOf(" mousetrap ")>-1)&&(!function t(e,i){return null!==e&&e!==n&&(e===i||t(e.parentNode,i))}(e,this.target)&&("INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable))},y.prototype.handleKey=function(){var t=this;return t._handleKey.apply(t,arguments)},y.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(l[e]=t[e]);r=null},y.init=function(){var t=y(n);for(var e in t)"_"!==e.charAt(0)&&(y[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},y.init(),o.Mousetrap=y,t.exports&&(t.exports=y),void 0===(s=function(){return y}.call(e,i,e,t))||(t.exports=s)}function d(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)}function g(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return l[t.which]?l[t.which]:h[t.which]?h[t.which]:String.fromCharCode(t.which).toLowerCase()}function m(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function f(t,e,i){return i||(i=function(){if(!r)for(var t in r={},l)t>95&&t<112||l.hasOwnProperty(t)&&(r[l[t]]=t);return r}()[t]?"keydown":"keypress"),"keypress"==i&&e.length&&(i="keydown"),i}function v(t,e){var i,s,o,n=[];for(i=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),o=0;o<i.length;++o)s=i[o],c[s]&&(s=c[s]),e&&"keypress"!=e&&u[s]&&(s=u[s],n.push("shift")),m(s)&&n.push(s);return{key:s,modifiers:n,action:e=f(s,n,e)}}function y(t){var e=this;if(t=t||n,!(e instanceof y))return new y(t);e.target=t,e._callbacks={},e._directMap={};var i,s={},o=!1,a=!1,r=!1;function l(t){t=t||{};var e,i=!1;for(e in s)t[e]?i=!0:s[e]=0;i||(r=!1)}function h(t,i,o,n,a,r){var l,h,u,c,p=[],d=o.type;if(!e._callbacks[t])return[];for("keyup"==d&&m(t)&&(i=[t]),l=0;l<e._callbacks[t].length;++l)if(h=e._callbacks[t][l],(n||!h.seq||s[h.seq]==h.level)&&d==h.action&&("keypress"==d&&!o.metaKey&&!o.ctrlKey||(u=i,c=h.modifiers,u.sort().join(",")===c.sort().join(",")))){var g=!n&&h.combo==a,f=n&&h.seq==n&&h.level==r;(g||f)&&e._callbacks[t].splice(l,1),p.push(h)}return p}function u(t,i,s,o){e.stopCallback(i,i.target||i.srcElement,s,o)||!1===t(i,s)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(i),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(i))}function c(t){"number"!=typeof t.which&&(t.which=t.keyCode);var i=g(t);i&&("keyup"!=t.type||o!==i?e.handleKey(i,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):o=!1)}function p(t,e,n,a){function h(e){return function(){r=e,++s[t],clearTimeout(i),i=setTimeout(l,1e3)}}function c(e){u(n,e,t),"keyup"!==a&&(o=g(e)),setTimeout(l,10)}s[t]=0;for(var p=0;p<e.length;++p){var d=p+1===e.length?c:h(a||v(e[p+1]).action);f(e[p],d,a,t,p)}}function f(t,i,s,o,n){e._directMap[t+":"+s]=i;var a,r=(t=t.replace(/\s+/g," ")).split(" ");r.length>1?p(t,r,i,s):(a=v(t,s),e._callbacks[a.key]=e._callbacks[a.key]||[],h(a.key,a.modifiers,{type:a.action},o,t,n),e._callbacks[a.key][o?"unshift":"push"]({callback:i,modifiers:a.modifiers,action:a.action,seq:o,level:n,combo:t}))}e._handleKey=function(t,e,i){var s,o=h(t,e,i),n={},c=0,p=!1;for(s=0;s<o.length;++s)o[s].seq&&(c=Math.max(c,o[s].level));for(s=0;s<o.length;++s)if(o[s].seq){if(o[s].level!=c)continue;p=!0,n[o[s].seq]=1,u(o[s].callback,i,o[s].combo,o[s].seq)}else p||u(o[s].callback,i,o[s].combo);var d="keypress"==i.type&&a;i.type!=r||m(t)||d||l(n),a=p&&"keydown"==i.type},e._bindMultiple=function(t,e,i){for(var s=0;s<t.length;++s)f(t[s],e,i)},d(t,"keypress",c),d(t,"keydown",c),d(t,"keyup",c)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},4285:function(t,e,i){"use strict";i.d(e,"a",(function(){return D}));var s=i(19),o=i(13),n=i(22),a=i(24),r=i(4307);function l(t,e){var i=r.c([],e,t);return r.b(i,i,1/i[3]),i}var h=i(4286),u=i(4280),c=i(4305);function p(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}var d=Math.PI,g=d/4,m=d/180,f=180/d;function v(t){return Math.pow(2,t)}function y(t){var e=Object(o.a)(t,2),i=e[0],s=e[1];p(Number.isFinite(i)),p(Number.isFinite(s)&&s>=-90&&s<=90,"invalid latitude");var n=s*m;return[512*(i*m+d)/(2*d),512*(d+Math.log(Math.tan(g+.5*n)))/(2*d)]}function b(t){var e=Object(o.a)(t,2),i=e[0],s=e[1],n=i/512*(2*d)-d,a=2*(Math.atan(Math.exp(s/512*(2*d)-d))-g);return[n*f,a*f]}function _(t){var e=t.latitude,i=t.longitude,s=t.highPrecision,o=void 0!==s&&s;p(Number.isFinite(e)&&Number.isFinite(i));var n={},a=Math.cos(e*m),r=512/360/a,l=512/4003e4/a;if(n.unitsPerMeter=[l,l,l],n.metersPerUnit=[1/l,1/l,1/l],n.unitsPerDegree=[512/360,r,l],n.degreesPerUnit=[.703125,1/r,1/l],o){var h=m*Math.tan(e*m)/a,u=512/360*h/2,c=512/4003e4*h,d=c/r*l;n.unitsPerDegree2=[0,u,c],n.unitsPerMeter2=[d,0,d]}return n}function k(t){var e=t.height,i=t.pitch,s=t.bearing,o=t.altitude,n=t.scale,a=t.center,r=void 0===a?null:a,l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return h.o(l,l,[0,0,-o]),h.k(l,l,-i*m),h.m(l,l,s*m),n/=e,h.n(l,l,[n,n,n]),r&&h.o(l,l,c.d([],r)),l}function x(t){var e=t.width,i=t.height,s=t.pitch,o=function(t){var e=t.width,i=t.height,s=t.altitude,o=void 0===s?1.5:s,n=t.pitch,a=void 0===n?0:n,r=t.nearZMultiplier,l=void 0===r?1:r,h=t.farZMultiplier,u=void 0===h?1:h,c=a*m,p=Math.atan(.5/o),d=Math.sin(p)*o/Math.sin(Math.min(Math.max(Math.PI/2-c-p,.01),Math.PI-.01));return{fov:2*p,aspect:e/i,focalDistance:o,near:l,far:(Math.sin(c)*d+o)*u}}({width:e,height:i,altitude:t.altitude,pitch:s,nearZMultiplier:t.nearZMultiplier,farZMultiplier:t.farZMultiplier}),n=o.fov,a=o.aspect,r=o.near,l=o.far;return h.i([],n,a,r,l)}function C(t,e){var i=Object(o.a)(t,3),s=i[0],n=i[1],a=i[2],r=void 0===a?0:a;return p(Number.isFinite(s)&&Number.isFinite(n)&&Number.isFinite(r)),l(e,[s,n,r,1])}function w(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=Object(o.a)(t,3),n=s[0],a=s[1],r=s[2];if(p(Number.isFinite(n)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(r)){var h=l(e,[n,a,r,1]);return h}var c=l(e,[n,a,0,1]),d=l(e,[n,a,1,1]),g=c[2],m=d[2],f=g===m?0:((i||0)-g)/(m-g);return u.d([],c,d,f)}function E(t){var e=t.width,i=t.height,s=t.bounds,n=t.minExtent,a=void 0===n?0:n,r=t.maxZoom,l=void 0===r?24:r,h=t.padding,u=void 0===h?0:h,c=t.offset,d=void 0===c?[0,0]:c,g=Object(o.a)(s,2),m=Object(o.a)(g[0],2),f=m[0],v=m[1],y=Object(o.a)(g[1],2),b=y[0],_=y[1];if(Number.isFinite(u)){u={top:u,bottom:u,left:u,right:u}}else p(Number.isFinite(u.top)&&Number.isFinite(u.bottom)&&Number.isFinite(u.left)&&Number.isFinite(u.right));var k=new j({width:e,height:i,longitude:0,latitude:0,zoom:0}),x=k.project([f,_]),C=k.project([b,v]),w=[Math.max(Math.abs(C[0]-x[0]),a),Math.max(Math.abs(C[1]-x[1]),a)],E=[e-u.left-u.right-2*Math.abs(d[0]),i-u.top-u.bottom-2*Math.abs(d[1])];p(E[0]>0&&E[1]>0);var M=E[0]/w[0],P=E[1]/w[1],S=(u.right-u.left)/2/M,L=(u.bottom-u.top)/2/P,O=[(C[0]+x[0])/2+S,(C[1]+x[1])/2+L],A=k.unproject(O),T=Math.min(l,k.zoom+Math.log2(Math.abs(Math.min(M,P))));return p(Number.isFinite(T)),{longitude:A[0],latitude:A[1],zoom:T}}var M=Math.PI/180;function P(t){var e,i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=t.width,n=t.height,a=t.unproject,r={targetZ:s},l=a([0,n],r),h=a([o,n],r),u=Math.atan(.5/t.altitude),c=(90-t.pitch)*M;return u>c-.01?(e=S(t,0,s),i=S(t,o,s)):(e=a([0,0],r),i=a([o,0],r)),[l,h,i,e]}function S(t,e,i){var s=t.pixelUnprojectionMatrix,o=l(s,[e,0,1,1]),n=l(s,[e,t.height,1,1]),a=(i*t.distanceScales.unitsPerMeter[2]-o[2])/(n[2]-o[2]),r=b(u.d([],o,n,a));return r[2]=i,r}var j=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1},i=e.width,s=e.height,o=e.latitude,a=void 0===o?0:o,r=e.longitude,l=void 0===r?0:r,h=e.zoom,u=void 0===h?0:h,c=e.pitch,p=void 0===c?0:c,d=e.bearing,g=void 0===d?0:d,m=e.altitude,f=void 0===m?1.5:m,b=e.nearZMultiplier,C=void 0===b?.02:b,w=e.farZMultiplier,E=void 0===w?1.01:w;Object(n.a)(this,t),i=i||1,s=s||1;var M=v(u);f=Math.max(.75,f);var P=y([l,a]);P[2]=0,this.projectionMatrix=x({width:i,height:s,pitch:p,altitude:f,nearZMultiplier:C,farZMultiplier:E}),this.viewMatrix=k({height:s,scale:M,center:P,pitch:p,bearing:g,altitude:f}),this.width=i,this.height=s,this.scale=M,this.latitude=a,this.longitude=l,this.zoom=u,this.pitch=p,this.bearing=g,this.altitude=f,this.center=P,this.distanceScales=_(this),this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}return Object(a.a)(t,[{key:"_initMatrices",value:function(){var t=this.width,e=this.height,i=this.projectionMatrix,s=this.viewMatrix,o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];h.g(o,o,i),h.g(o,o,s),this.viewProjectionMatrix=o;var n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];h.n(n,n,[t/2,-e/2,1]),h.o(n,n,[1,-1,0]),h.g(n,n,o);var a=h.e([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n);if(!a)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=n,this.pixelUnprojectionMatrix=a}},{key:"equals",value:function(e){return e instanceof t&&(e.width===this.width&&e.height===this.height&&h.b(e.projectionMatrix,this.projectionMatrix)&&h.b(e.viewMatrix,this.viewMatrix))}},{key:"project",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.topLeft,s=void 0===i||i,n=this.projectPosition(t),a=C(n,this.pixelProjectionMatrix),r=Object(o.a)(a,2),l=r[0],h=r[1],u=s?h:this.height-h;return 2===t.length?[l,u]:[l,u,a[2]]}},{key:"unproject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.topLeft,s=void 0===i||i,n=e.targetZ,a=void 0===n?void 0:n,r=Object(o.a)(t,3),l=r[0],h=r[1],u=r[2],c=s?h:this.height-h,p=a&&a*this.distanceScales.unitsPerMeter[2],d=w([l,c,u],this.pixelUnprojectionMatrix,p),g=this.unprojectPosition(d),m=Object(o.a)(g,3),f=m[0],v=m[1],y=m[2];return Number.isFinite(u)?[f,v,y]:Number.isFinite(a)?[f,v,a]:[f,v]}},{key:"projectPosition",value:function(t){var e=y(t),i=Object(o.a)(e,2);return[i[0],i[1],(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:"unprojectPosition",value:function(t){var e=b(t),i=Object(o.a)(e,2);return[i[0],i[1],(t[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:"projectFlat",value:function(t){return y(t)}},{key:"unprojectFlat",value:function(t){return b(t)}},{key:"getMapCenterByLngLatPosition",value:function(t){var e=t.lngLat,i=w(t.pos,this.pixelUnprojectionMatrix),s=y(e),o=u.a([],s,u.e([],i));return b(u.a([],this.center,o))}},{key:"getLocationAtPoint",value:function(t){var e=t.lngLat,i=t.pos;return this.getMapCenterByLngLatPosition({lngLat:e,pos:i})}},{key:"fitBounds",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.width,o=this.height,n=E(Object.assign({width:s,height:o,bounds:e},i)),a=n.longitude,r=n.latitude,l=n.zoom;return new t({width:s,height:o,longitude:a,latitude:r,zoom:l})}},{key:"getBounds",value:function(t){var e=this.getBoundingRegion(t),i=Math.min.apply(Math,Object(s.a)(e.map((function(t){return t[0]})))),o=Math.max.apply(Math,Object(s.a)(e.map((function(t){return t[0]}))));return[[i,Math.min.apply(Math,Object(s.a)(e.map((function(t){return t[1]}))))],[o,Math.max.apply(Math,Object(s.a)(e.map((function(t){return t[1]}))))]]}},{key:"getBoundingRegion",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return P(this,t.z||0)}}]),t}();var L=i(577);const O=[-90,90],A=[-180,180];function T(t,e,i){let[s,o]=t,[n,a]=e;return void 0===i&&(i=.25),s<o?[s,o]:[Math.max(n,s-i),Math.min(a,o+i)]}function V(){return(V=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function D(t,e){let{points:i,width:s,height:o,minExtent:n,maxZoom:a,offset:r,padding:l=20}=e;const{bearing:h,pitch:u}=t,c=function(t){const e=T(Object(L.extent)(t,t=>t[1]),O),i=T(Object(L.extent)(t,t=>t[0]),A);return[[i[0],e[0]],[i[1],e[1]]]}(i);try{return V({},E({bounds:c,width:s,height:o,minExtent:n,maxZoom:a,offset:r,padding:l}),{bearing:h,pitch:u})}catch(t){console.error("Could not fit viewport",t)}return t}},4291:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var s=i(12),o=i.n(s);const n=[1,0,1,0,0,0,0];function a(t,e){const i=parseInt(o()(e).format("x"),10);return parseInt(o()(e).add(t).format("x"),10)-i}function r(t,e){const i=o()(Math.min(...t)),s=o()(Math.max(...t));let r,l,h;if(e.includes("/")){const t=e.split("/",2);t[0].endsWith("Z")?(l=o()(t[0]),r=o.a.duration(t[1])):(l=o()(t[1]),r=o.a.duration(t[0]))}else r=o.a.duration(e),l=function(t,e){const i=o()(t).subtract(e),s=t.toArray(),a=i.toArray(),r=s.map((t,e)=>a[e]!==t).indexOf(!0),l=s.map((t,e)=>{if(e===r){const i=t-a[e];return t-(t-n[e])%i}return e<r||-1===r?t:n[e]});return o()(l)}(i,r);const u=i.valueOf();for(h=l.clone();h.valueOf()<u;)h.add(r);for(;h.valueOf()>u;)h.subtract(r);let c;const p=s.valueOf();for(c=l.clone();c.valueOf()>p;)c.subtract(r);for(;c.valueOf()<p;)c.add(r);const d=null!=e?[h,h.clone().add(r)]:[h,c],g=t.every(t=>null===t);return{start:parseInt(h.format("x"),10),end:parseInt(c.format("x"),10),getStep:a.bind(this,r),values:d.map(t=>parseInt(t.format("x"),10)),disabled:g}}},4292:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return r}));var s={SUM:1,MEAN:2,MIN:3,MAX:4};function o(t,e){return t+e}function n(t,e){return e>t?e:t}function a(t,e){return e<t?e:t}function r(t,e){switch(s[t.toUpperCase()]||s.SUM){case s.MIN:return function(t){return function(t,e){var i=t.map(e).filter(Number.isFinite);return i.length?i.reduce(a,1/0):null}(t,e)};case s.SUM:return function(t){return function(t,e){var i=t.map(e).filter(Number.isFinite);return i.length?i.reduce(o,0):null}(t,e)};case s.MEAN:return function(t){return function(t,e){var i=t.map(e).filter(Number.isFinite);return i.length?i.reduce(o,0)/i.length:null}(t,e)};case s.MAX:return function(t){return function(t,e){var i=t.map(e).filter(Number.isFinite);return i.length?i.reduce(n,-1/0):null}(t,e)};default:return null}}},4294:function(t,e,i){"use strict";i.d(e,"a",(function(){return y}));var s=i(0),o=i.n(s),n=i(5),a=i.n(n),r=i(4293),l=i(3508),h=i.n(l),u=i(18),c=i(4298),p=i.n(c);i(4300),i(4301);function d(t){return o.a.createElement("span",{className:"BootstrapSliderWrapper"},o.a.createElement(p.a,t))}i(4302);const g={start:a.a.number.isRequired,step:a.a.number.isRequired,end:a.a.number.isRequired,values:a.a.array.isRequired,onChange:a.a.func,loopDuration:a.a.number,maxFrames:a.a.number,orientation:a.a.oneOf(["horizontal","vertical"]),reversed:a.a.bool,disabled:a.a.bool,range:a.a.bool};class m extends o.a.PureComponent{constructor(t){super(t),this.state={intervalId:null};const e=t.end-t.start,i=Math.min(t.maxFrames,e/t.step),s=e/i;this.intervalMilliseconds=t.loopDuration/i,this.increment=s<t.step?t.step:s-s%t.step,this.onChange=this.onChange.bind(this),this.play=this.play.bind(this),this.pause=this.pause.bind(this),this.stepBackward=this.stepBackward.bind(this),this.stepForward=this.stepForward.bind(this),this.getPlayClass=this.getPlayClass.bind(this),this.formatter=this.formatter.bind(this)}componentDidMount(){h.a.bind(["space"],this.play)}componentWillUnmount(){h.a.unbind(["space"])}onChange(t){this.props.onChange(t.target.value),null!=this.state.intervalId&&this.pause()}getPlayClass(){return null==this.state.intervalId?"fa fa-play fa-lg slider-button":"fa fa-pause fa-lg slider-button"}play(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{const t=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:t})}}pause(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}stepForward(){const{start:t,end:e,step:i,values:s,disabled:o}=this.props;if(o)return;const n=(Array.isArray(s)?s:[s,s+i]).map(t=>t+this.increment),a=n[1]>e?n[0]-t:0;this.props.onChange(n.map(t=>t-a))}stepBackward(){const{start:t,end:e,step:i,values:s,disabled:o}=this.props;if(o)return;const n=(Array.isArray(s)?s:[s,s+i]).map(t=>t-this.increment),a=n[0]<t?e-n[1]:0;this.props.onChange(n.map(t=>t+a))}formatter(t){if(this.props.disabled)return Object(u.e)("Data has no time steps");let e=t;return Array.isArray(t)?t[0]===t[1]&&(e=[t[0]]):e=[t],e.map(t=>new Date(t).toUTCString()).join(" : ")}render(){const{start:t,end:e,step:i,orientation:s,reversed:n,disabled:a,range:r,values:l}=this.props;return o.a.createElement("div",{className:"play-slider"},o.a.createElement("div",{className:"play-slider-controls padded"},o.a.createElement("i",{className:"fa fa-step-backward fa-lg slider-button ",onClick:this.stepBackward}),o.a.createElement("i",{className:this.getPlayClass(),onClick:this.play}),o.a.createElement("i",{className:"fa fa-step-forward fa-lg slider-button ",onClick:this.stepForward})),o.a.createElement("div",{className:"play-slider-scrobbler padded"},o.a.createElement(d,{value:r?l:l[0],range:r,formatter:this.formatter,change:this.onChange,min:t,max:e,step:i,orientation:s,reversed:n,disabled:a?"disabled":"enabled"})))}}function f(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}m.propTypes=g,m.defaultProps={onChange:()=>{},loopDuration:15e3,maxFrames:100,orientation:"horizontal",reversed:!1,disabled:!1,range:!0};const v={getLayers:a.a.func.isRequired,start:a.a.number.isRequired,end:a.a.number.isRequired,getStep:a.a.func,values:a.a.array.isRequired,aggregation:a.a.bool,disabled:a.a.bool,viewport:a.a.object.isRequired,children:a.a.node,mapStyle:a.a.string,mapboxApiAccessToken:a.a.string.isRequired,setControlValue:a.a.func,onValuesChange:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired};class y extends o.a.PureComponent{constructor(){super(...arguments),f(this,"containerRef",o.a.createRef()),f(this,"setTooltip",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)})}render(){const{start:t,end:e,getStep:i,disabled:s,aggregation:n,children:a,getLayers:l,values:h,onValuesChange:u,viewport:c,setControlValue:p,mapStyle:d,mapboxApiAccessToken:g,height:f,width:v}=this.props,y=l(h);return o.a.createElement("div",null,o.a.createElement(r.a,{ref:this.containerRef,viewport:c,layers:y,setControlValue:p,mapStyle:d,mapboxApiAccessToken:g,bottomMargin:s?0:20,width:v,height:f}),!s&&o.a.createElement(m,{start:t,end:e,step:i(t),values:h,range:!n,onChange:u}),a)}}y.propTypes=v,y.defaultProps={aggregation:!1,disabled:!1,mapStyle:"light",setControlValue:()=>{},onValuesChange:()=>{}}},4298:function(t,e,i){var s,o,n;o=[e,i(131),i(329),i(431),i(415),i(416),i(0),i(5),i(4299)],void 0===(n="function"==typeof(s=function(t,e,i,s,o,n,a,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReactBootstrapSlider=void 0;var h=v(e),u=v(i),c=v(s),p=v(o),d=v(n),g=v(a),m=v(r),f=v(l);function v(t){return t&&t.__esModule?t:{default:t}}var y=t.ReactBootstrapSlider=function(t){function e(){var t,i,s,o;(0,u.default)(this,e);for(var n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];return i=s=(0,p.default)(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(a))),s.checkAndDoDisabled=function(){var t="disabled"!==s.props.disabled,e=s.mySlider.isEnabled();t?e||s.mySlider.enable():e&&s.mySlider.disable()},s.updateSliderValues=function(){void 0===s.props.min||void 0===s.mySlider.min&&void 0===s.mySlider.options.min||s.mySlider.setAttribute("min",s.props.min),void 0===s.props.max||void 0===s.mySlider.max&&void 0===s.mySlider.options.max||s.mySlider.setAttribute("max",s.props.max),void 0===s.props.step||void 0===s.mySlider.step&&void 0===s.mySlider.options.step||s.mySlider.setAttribute("step",s.props.step),s.mySlider.setValue(s.props.value),s.checkAndDoDisabled()},o=i,(0,p.default)(s,o)}return(0,d.default)(e,t),(0,c.default)(e,[{key:"componentDidMount",value:function(){var t=this,e=(0,h.default)({},this.props,{tooltip:this.props.tooltip||"show"});if(this.mySlider=new f.default(this.node,e),this.props.change||this.props.handleChange){var i=this.props.change||this.props.handleChange;this.mySlider.on("change",(function(t){var e={target:{}};e.target.value=t.newValue,i(e)}))}this.props.slideStop&&this.mySlider.on("slideStop",(function(e){var i={target:{}};i.target.value=e,t.props.slideStop(i)})),this.checkAndDoDisabled()}},{key:"componentDidUpdate",value:function(){this.updateSliderValues()}},{key:"componentWillUnmount",value:function(){this.mySlider.destroy()}},{key:"render",value:function(){var t=this;return g.default.createElement("div",{ref:function(e){return t.node=e}})}}]),e}(g.default.Component);y.propTypes={min:m.default.number,max:m.default.number,step:m.default.number,value:m.default.oneOfType([m.default.number,m.default.arrayOf(m.default.number.isRequired).isRequired]).isRequired,disabled:m.default.string,tooltip:m.default.string,change:m.default.func,handleChange:m.default.func,slideStop:m.default.func,labelledby:m.default.oneOfType([m.default.string,m.default.arrayOf(m.default.string)])},t.default=y})?s.apply(e,o):s)||(t.exports=n)},4299:function(t,e,i){"use strict";var s,o,n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r="object"===("undefined"==typeof window?"undefined":a(window));o=[i(138)],void 0===(n="function"==typeof(s=function(t){var e;return r&&!window.console&&(window.console={}),r&&!window.console.log&&(window.console.log=function(){}),r&&!window.console.warn&&(window.console.warn=function(){}),function(t){var e=Array.prototype.slice;function i(){}!function(t){if(t){var s="undefined"==typeof console?i:function(t){console.error(t)};t.bridget=function(i,o){!function(e){e.prototype.option||(e.prototype.option=function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))})}(o),function(i,o){t.fn[i]=function(n){if("string"==typeof n){for(var a=e.call(arguments,1),r=0,l=this.length;r<l;r++){var h=this[r],u=t.data(h,i);if(u)if(t.isFunction(u[n])&&"_"!==n.charAt(0)){var c=u[n].apply(u,a);if(void 0!==c&&c!==u)return c}else s("no such method '"+n+"' for "+i+" instance");else s("cannot call methods on "+i+" prior to initialization; attempted to call '"+n+"'")}return this}var p=this.map((function(){var e=t.data(this,i);return e?(e.option(n),e._init()):(e=new o(this,n),t.data(this,i,e)),t(this)}));return!p||p.length>1?p:p[0]}}(i,o)},t.bridget}}(t)}(t),function(t){var i=function(t){return"Invalid input value '"+t+"' passed in"},s={linear:{toValue:function(t){var e=t/100*(this.options.max-this.options.min),i=!0;if(this.options.ticks_positions.length>0){for(var s,o,n,a=0,r=1;r<this.options.ticks_positions.length;r++)if(t<=this.options.ticks_positions[r]){s=this.options.ticks[r-1],n=this.options.ticks_positions[r-1],o=this.options.ticks[r],a=this.options.ticks_positions[r];break}e=s+(t-n)/(a-n)*(o-s),i=!1}var l=(i?this.options.min:0)+Math.round(e/this.options.step)*this.options.step;return l<this.options.min?this.options.min:l>this.options.max?this.options.max:l},toPercentage:function(t){if(this.options.max===this.options.min)return 0;if(this.options.ticks_positions.length>0){for(var e,i,s,o=0,n=0;n<this.options.ticks.length;n++)if(t<=this.options.ticks[n]){e=n>0?this.options.ticks[n-1]:0,s=n>0?this.options.ticks_positions[n-1]:0,i=this.options.ticks[n],o=this.options.ticks_positions[n];break}if(n>0)return s+(t-e)/(i-e)*(o-s)}return 100*(t-this.options.min)/(this.options.max-this.options.min)}},logarithmic:{toValue:function(t){var e=0===this.options.min?0:Math.log(this.options.min),i=Math.log(this.options.max),s=Math.exp(e+(i-e)*t/100);return Math.round(s)===this.options.max?this.options.max:(s=this.options.min+Math.round((s-this.options.min)/this.options.step)*this.options.step)<this.options.min?this.options.min:s>this.options.max?this.options.max:s},toPercentage:function(t){if(this.options.max===this.options.min)return 0;var e=Math.log(this.options.max),i=0===this.options.min?0:Math.log(this.options.min);return 100*((0===t?0:Math.log(t))-i)/(e-i)}}};function o(e,i){this._state={value:null,enabled:null,offset:null,size:null,percentage:null,inDrag:!1,over:!1},this.ticksCallbackMap={},this.handleCallbackMap={},"string"==typeof e?this.element=document.querySelector(e):e instanceof HTMLElement&&(this.element=e),i=i||{};for(var o=Object.keys(this.defaultOptions),n=0;n<o.length;n++){var a=o[n],r=i[a];r=null!==(r=void 0!==r?r:l(this.element,a))?r:this.defaultOptions[a],this.options||(this.options={}),this.options[a]=r}function l(t,e){var i="data-slider-"+e.replace(/_/g,"-"),s=t.getAttribute(i);try{return JSON.parse(s)}catch(t){return s}}"auto"===this.options.rtl&&(this.options.rtl="rtl"===window.getComputedStyle(this.element).direction),"vertical"!==this.options.orientation||"top"!==this.options.tooltip_position&&"bottom"!==this.options.tooltip_position?"horizontal"!==this.options.orientation||"left"!==this.options.tooltip_position&&"right"!==this.options.tooltip_position||(this.options.tooltip_position="top"):this.options.rtl?this.options.tooltip_position="left":this.options.tooltip_position="right";var h,u,c,p,d,g=this.element.style.width,m=!1,f=this.element.parentNode;if(this.sliderElem)m=!0;else{this.sliderElem=document.createElement("div"),this.sliderElem.className="slider";var v=document.createElement("div");v.className="slider-track",(u=document.createElement("div")).className="slider-track-low",(h=document.createElement("div")).className="slider-selection",(c=document.createElement("div")).className="slider-track-high",(p=document.createElement("div")).className="slider-handle min-slider-handle",p.setAttribute("role","slider"),p.setAttribute("aria-valuemin",this.options.min),p.setAttribute("aria-valuemax",this.options.max),(d=document.createElement("div")).className="slider-handle max-slider-handle",d.setAttribute("role","slider"),d.setAttribute("aria-valuemin",this.options.min),d.setAttribute("aria-valuemax",this.options.max),v.appendChild(u),v.appendChild(h),v.appendChild(c),this.rangeHighlightElements=[];var y=this.options.rangeHighlights;if(Array.isArray(y)&&y.length>0)for(var b=0;b<y.length;b++){var _=document.createElement("div"),k=y[b].class||"";_.className="slider-rangeHighlight slider-selection "+k,this.rangeHighlightElements.push(_),v.appendChild(_)}var x=Array.isArray(this.options.labelledby);if(x&&this.options.labelledby[0]&&p.setAttribute("aria-labelledby",this.options.labelledby[0]),x&&this.options.labelledby[1]&&d.setAttribute("aria-labelledby",this.options.labelledby[1]),!x&&this.options.labelledby&&(p.setAttribute("aria-labelledby",this.options.labelledby),d.setAttribute("aria-labelledby",this.options.labelledby)),this.ticks=[],Array.isArray(this.options.ticks)&&this.options.ticks.length>0){for(this.ticksContainer=document.createElement("div"),this.ticksContainer.className="slider-tick-container",n=0;n<this.options.ticks.length;n++){var C=document.createElement("div");if(C.className="slider-tick",this.options.ticks_tooltip){var w=this._addTickListener(),E=w.addMouseEnter(this,C,n),M=w.addMouseLeave(this,C);this.ticksCallbackMap[n]={mouseEnter:E,mouseLeave:M}}this.ticks.push(C),this.ticksContainer.appendChild(C)}h.className+=" tick-slider-selection"}if(this.tickLabels=[],Array.isArray(this.options.ticks_labels)&&this.options.ticks_labels.length>0)for(this.tickLabelContainer=document.createElement("div"),this.tickLabelContainer.className="slider-tick-label-container",n=0;n<this.options.ticks_labels.length;n++){var P=document.createElement("div"),S=0===this.options.ticks_positions.length,j=this.options.reversed&&S?this.options.ticks_labels.length-(n+1):n;P.className="slider-tick-label",P.innerHTML=this.options.ticks_labels[j],this.tickLabels.push(P),this.tickLabelContainer.appendChild(P)}var L=function(t){var e=document.createElement("div");e.className="tooltip-arrow";var i=document.createElement("div");i.className="tooltip-inner",t.appendChild(e),t.appendChild(i)},O=document.createElement("div");O.className="tooltip tooltip-main",O.setAttribute("role","presentation"),L(O);var A=document.createElement("div");A.className="tooltip tooltip-min",A.setAttribute("role","presentation"),L(A);var T=document.createElement("div");T.className="tooltip tooltip-max",T.setAttribute("role","presentation"),L(T),this.sliderElem.appendChild(v),this.sliderElem.appendChild(O),this.sliderElem.appendChild(A),this.sliderElem.appendChild(T),this.tickLabelContainer&&this.sliderElem.appendChild(this.tickLabelContainer),this.ticksContainer&&this.sliderElem.appendChild(this.ticksContainer),this.sliderElem.appendChild(p),this.sliderElem.appendChild(d),f.insertBefore(this.sliderElem,this.element),this.element.style.display="none"}if(t&&(this.$element=t(this.element),this.$sliderElem=t(this.sliderElem)),this.eventToCallbackMap={},this.sliderElem.id=this.options.id,this.touchCapable="ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch,this.touchX=0,this.touchY=0,this.tooltip=this.sliderElem.querySelector(".tooltip-main"),this.tooltipInner=this.tooltip.querySelector(".tooltip-inner"),this.tooltip_min=this.sliderElem.querySelector(".tooltip-min"),this.tooltipInner_min=this.tooltip_min.querySelector(".tooltip-inner"),this.tooltip_max=this.sliderElem.querySelector(".tooltip-max"),this.tooltipInner_max=this.tooltip_max.querySelector(".tooltip-inner"),s[this.options.scale]&&(this.options.scale=s[this.options.scale]),!0===m&&(this._removeClass(this.sliderElem,"slider-horizontal"),this._removeClass(this.sliderElem,"slider-vertical"),this._removeClass(this.sliderElem,"slider-rtl"),this._removeClass(this.tooltip,"hide"),this._removeClass(this.tooltip_min,"hide"),this._removeClass(this.tooltip_max,"hide"),["left","right","top","width","height"].forEach((function(t){this._removeProperty(this.trackLow,t),this._removeProperty(this.trackSelection,t),this._removeProperty(this.trackHigh,t)}),this),[this.handle1,this.handle2].forEach((function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top")}),this),[this.tooltip,this.tooltip_min,this.tooltip_max].forEach((function(t){this._removeProperty(t,"left"),this._removeProperty(t,"right"),this._removeProperty(t,"top"),this._removeProperty(t,"margin-left"),this._removeProperty(t,"margin-right"),this._removeProperty(t,"margin-top"),this._removeClass(t,"right"),this._removeClass(t,"left"),this._removeClass(t,"top")}),this)),"vertical"===this.options.orientation?(this._addClass(this.sliderElem,"slider-vertical"),this.stylePos="top",this.mousePos="pageY",this.sizePos="offsetHeight"):(this._addClass(this.sliderElem,"slider-horizontal"),this.sliderElem.style.width=g,this.options.orientation="horizontal",this.options.rtl?this.stylePos="right":this.stylePos="left",this.mousePos="pageX",this.sizePos="offsetWidth"),this.options.rtl&&this._addClass(this.sliderElem,"slider-rtl"),this._setTooltipPosition(),Array.isArray(this.options.ticks)&&this.options.ticks.length>0&&(this.options.max=Math.max.apply(Math,this.options.ticks),this.options.min=Math.min.apply(Math,this.options.ticks)),Array.isArray(this.options.value)?(this.options.range=!0,this._state.value=this.options.value):this.options.range?this._state.value=[this.options.value,this.options.max]:this._state.value=this.options.value,this.trackLow=u||this.trackLow,this.trackSelection=h||this.trackSelection,this.trackHigh=c||this.trackHigh,"none"===this.options.selection?(this._addClass(this.trackLow,"hide"),this._addClass(this.trackSelection,"hide"),this._addClass(this.trackHigh,"hide")):"after"!==this.options.selection&&"before"!==this.options.selection||(this._removeClass(this.trackLow,"hide"),this._removeClass(this.trackSelection,"hide"),this._removeClass(this.trackHigh,"hide")),this.handle1=p||this.handle1,this.handle2=d||this.handle2,!0===m)for(this._removeClass(this.handle1,"round triangle"),this._removeClass(this.handle2,"round triangle hide"),n=0;n<this.ticks.length;n++)this._removeClass(this.ticks[n],"round triangle hide");if(-1!==["round","triangle","custom"].indexOf(this.options.handle))for(this._addClass(this.handle1,this.options.handle),this._addClass(this.handle2,this.options.handle),n=0;n<this.ticks.length;n++)this._addClass(this.ticks[n],this.options.handle);if(this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this.setValue(this._state.value),this.handle1Keydown=this._keydown.bind(this,0),this.handle1.addEventListener("keydown",this.handle1Keydown,!1),this.handle2Keydown=this._keydown.bind(this,1),this.handle2.addEventListener("keydown",this.handle2Keydown,!1),this.mousedown=this._mousedown.bind(this),this.touchstart=this._touchstart.bind(this),this.touchmove=this._touchmove.bind(this),this.touchCapable){var V=!1;try{var D=Object.defineProperty({},"passive",{get:function(){V=!0}});window.addEventListener("test",null,D)}catch(t){}var N=!!V&&{passive:!0};this.sliderElem.addEventListener("touchstart",this.touchstart,N),this.sliderElem.addEventListener("touchmove",this.touchmove,N)}if(this.sliderElem.addEventListener("mousedown",this.mousedown,!1),this.resize=this._resize.bind(this),window.addEventListener("resize",this.resize,!1),"hide"===this.options.tooltip)this._addClass(this.tooltip,"hide"),this._addClass(this.tooltip_min,"hide"),this._addClass(this.tooltip_max,"hide");else if("always"===this.options.tooltip)this._showTooltip(),this._alwaysShowTooltip=!0;else{if(this.showTooltip=this._showTooltip.bind(this),this.hideTooltip=this._hideTooltip.bind(this),this.options.ticks_tooltip){var F=this._addTickListener(),R=F.addMouseEnter(this,this.handle1),z=F.addMouseLeave(this,this.handle1);this.handleCallbackMap.handle1={mouseEnter:R,mouseLeave:z},R=F.addMouseEnter(this,this.handle2),z=F.addMouseLeave(this,this.handle2),this.handleCallbackMap.handle2={mouseEnter:R,mouseLeave:z}}else this.sliderElem.addEventListener("mouseenter",this.showTooltip,!1),this.sliderElem.addEventListener("mouseleave",this.hideTooltip,!1);this.handle1.addEventListener("focus",this.showTooltip,!1),this.handle1.addEventListener("blur",this.hideTooltip,!1),this.handle2.addEventListener("focus",this.showTooltip,!1),this.handle2.addEventListener("blur",this.hideTooltip,!1)}this.options.enabled?this.enable():this.disable()}if((e=function(t,e){return o.call(this,t,e),this}).prototype={_init:function(){},constructor:e,defaultOptions:{id:"",min:0,max:10,step:1,precision:0,orientation:"horizontal",value:5,range:!1,selection:"before",tooltip:"show",tooltip_split:!1,handle:"round",reversed:!1,rtl:"auto",enabled:!0,formatter:function(t){return Array.isArray(t)?t[0]+" : "+t[1]:t},natural_arrow_keys:!1,ticks:[],ticks_positions:[],ticks_labels:[],ticks_snap_bounds:0,ticks_tooltip:!1,scale:"linear",focus:!1,tooltip_position:null,labelledby:null,rangeHighlights:[]},getElement:function(){return this.sliderElem},getValue:function(){return this.options.range?this._state.value:this._state.value[0]},setValue:function(t,e,i){t||(t=0);var s=this.getValue();this._state.value=this._validateInputValue(t);var o=this._applyPrecision.bind(this);this.options.range?(this._state.value[0]=o(this._state.value[0]),this._state.value[1]=o(this._state.value[1]),this._state.value[0]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[0])),this._state.value[1]=Math.max(this.options.min,Math.min(this.options.max,this._state.value[1]))):(this._state.value=o(this._state.value),this._state.value=[Math.max(this.options.min,Math.min(this.options.max,this._state.value))],this._addClass(this.handle2,"hide"),"after"===this.options.selection?this._state.value[1]=this.options.max:this._state.value[1]=this.options.min),this.options.max>this.options.min?this._state.percentage=[this._toPercentage(this._state.value[0]),this._toPercentage(this._state.value[1]),100*this.options.step/(this.options.max-this.options.min)]:this._state.percentage=[0,0,100],this._layout();var n=this.options.range?this._state.value:this._state.value[0];return this._setDataVal(n),!0===e&&this._trigger("slide",n),s!==n&&!0===i&&this._trigger("change",{oldValue:s,newValue:n}),this},destroy:function(){this._removeSliderEventHandlers(),this.sliderElem.parentNode.removeChild(this.sliderElem),this.element.style.display="",this._cleanUpEventCallbacksMap(),this.element.removeAttribute("data"),t&&(this._unbindJQueryEventHandlers(),this.$element.removeData("slider"))},disable:function(){return this._state.enabled=!1,this.handle1.removeAttribute("tabindex"),this.handle2.removeAttribute("tabindex"),this._addClass(this.sliderElem,"slider-disabled"),this._trigger("slideDisabled"),this},enable:function(){return this._state.enabled=!0,this.handle1.setAttribute("tabindex",0),this.handle2.setAttribute("tabindex",0),this._removeClass(this.sliderElem,"slider-disabled"),this._trigger("slideEnabled"),this},toggle:function(){return this._state.enabled?this.disable():this.enable(),this},isEnabled:function(){return this._state.enabled},on:function(t,e){return this._bindNonQueryEventHandler(t,e),this},off:function(e,i){t?(this.$element.off(e,i),this.$sliderElem.off(e,i)):this._unbindNonQueryEventHandler(e,i)},getAttribute:function(t){return t?this.options[t]:this.options},setAttribute:function(t,e){return this.options[t]=e,this},refresh:function(){return this._removeSliderEventHandlers(),o.call(this,this.element,this.options),t&&t.data(this.element,"slider",this),this},relayout:function(){return this._resize(),this._layout(),this},_removeSliderEventHandlers:function(){if(this.handle1.removeEventListener("keydown",this.handle1Keydown,!1),this.handle2.removeEventListener("keydown",this.handle2Keydown,!1),this.options.ticks_tooltip){for(var t=this.ticksContainer.getElementsByClassName("slider-tick"),e=0;e<t.length;e++)t[e].removeEventListener("mouseenter",this.ticksCallbackMap[e].mouseEnter,!1),t[e].removeEventListener("mouseleave",this.ticksCallbackMap[e].mouseLeave,!1);this.handle1.removeEventListener("mouseenter",this.handleCallbackMap.handle1.mouseEnter,!1),this.handle2.removeEventListener("mouseenter",this.handleCallbackMap.handle2.mouseEnter,!1),this.handle1.removeEventListener("mouseleave",this.handleCallbackMap.handle1.mouseLeave,!1),this.handle2.removeEventListener("mouseleave",this.handleCallbackMap.handle2.mouseLeave,!1)}this.handleCallbackMap=null,this.ticksCallbackMap=null,this.showTooltip&&(this.handle1.removeEventListener("focus",this.showTooltip,!1),this.handle2.removeEventListener("focus",this.showTooltip,!1)),this.hideTooltip&&(this.handle1.removeEventListener("blur",this.hideTooltip,!1),this.handle2.removeEventListener("blur",this.hideTooltip,!1)),this.showTooltip&&this.sliderElem.removeEventListener("mouseenter",this.showTooltip,!1),this.hideTooltip&&this.sliderElem.removeEventListener("mouseleave",this.hideTooltip,!1),this.sliderElem.removeEventListener("touchstart",this.touchstart,!1),this.sliderElem.removeEventListener("touchmove",this.touchmove,!1),this.sliderElem.removeEventListener("mousedown",this.mousedown,!1),window.removeEventListener("resize",this.resize,!1)},_bindNonQueryEventHandler:function(t,e){void 0===this.eventToCallbackMap[t]&&(this.eventToCallbackMap[t]=[]),this.eventToCallbackMap[t].push(e)},_unbindNonQueryEventHandler:function(t,e){var i=this.eventToCallbackMap[t];if(void 0!==i)for(var s=0;s<i.length;s++)if(i[s]===e){i.splice(s,1);break}},_cleanUpEventCallbacksMap:function(){for(var t=Object.keys(this.eventToCallbackMap),e=0;e<t.length;e++){var i=t[e];delete this.eventToCallbackMap[i]}},_showTooltip:function(){!1===this.options.tooltip_split?(this._addClass(this.tooltip,"in"),this.tooltip_min.style.display="none",this.tooltip_max.style.display="none"):(this._addClass(this.tooltip_min,"in"),this._addClass(this.tooltip_max,"in"),this.tooltip.style.display="none"),this._state.over=!0},_hideTooltip:function(){!1===this._state.inDrag&&!0!==this.alwaysShowTooltip&&(this._removeClass(this.tooltip,"in"),this._removeClass(this.tooltip_min,"in"),this._removeClass(this.tooltip_max,"in")),this._state.over=!1},_setToolTipOnMouseOver:function(t){var e=this.options.formatter(t?t.value[0]:this._state.value[0]),i=s(t||this._state,this.options.reversed);function s(t,e){return e?[100-t.percentage[0],this.options.range?100-t.percentage[1]:t.percentage[1]]:[t.percentage[0],t.percentage[1]]}this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=i[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px")},_addTickListener:function(){return{addMouseEnter:function(t,e,i){var s=function(){var e=t._state,s=i>=0?i:this.attributes["aria-valuenow"].value,o=parseInt(s,10);e.value[0]=o,e.percentage[0]=t.options.ticks_positions[o],t._setToolTipOnMouseOver(e),t._showTooltip()};return e.addEventListener("mouseenter",s,!1),s},addMouseLeave:function(t,e){var i=function(){t._hideTooltip()};return e.addEventListener("mouseleave",i,!1),i}}},_layout:function(){var t,e;if(t=this.options.reversed?[100-this._state.percentage[0],this.options.range?100-this._state.percentage[1]:this._state.percentage[1]]:[this._state.percentage[0],this._state.percentage[1]],this.handle1.style[this.stylePos]=t[0]+"%",this.handle1.setAttribute("aria-valuenow",this._state.value[0]),isNaN(this.options.formatter(this._state.value[0]))&&this.handle1.setAttribute("aria-valuetext",this.options.formatter(this._state.value[0])),this.handle2.style[this.stylePos]=t[1]+"%",this.handle2.setAttribute("aria-valuenow",this._state.value[1]),isNaN(this.options.formatter(this._state.value[1]))&&this.handle2.setAttribute("aria-valuetext",this.options.formatter(this._state.value[1])),this.rangeHighlightElements.length>0&&Array.isArray(this.options.rangeHighlights)&&this.options.rangeHighlights.length>0)for(var i=0;i<this.options.rangeHighlights.length;i++){var s=this._toPercentage(this.options.rangeHighlights[i].start),o=this._toPercentage(this.options.rangeHighlights[i].end);if(this.options.reversed){var n=100-o;o=100-s,s=n}var a=this._createHighlightRange(s,o);a?"vertical"===this.options.orientation?(this.rangeHighlightElements[i].style.top=a.start+"%",this.rangeHighlightElements[i].style.height=a.size+"%"):(this.options.rtl?this.rangeHighlightElements[i].style.right=a.start+"%":this.rangeHighlightElements[i].style.left=a.start+"%",this.rangeHighlightElements[i].style.width=a.size+"%"):this.rangeHighlightElements[i].style.display="none"}if(Array.isArray(this.options.ticks)&&this.options.ticks.length>0){var r,l="vertical"===this.options.orientation?"height":"width";r="vertical"===this.options.orientation?"marginTop":this.options.rtl?"marginRight":"marginLeft";var h=this._state.size/(this.options.ticks.length-1);if(this.tickLabelContainer){var u=0;if(0===this.options.ticks_positions.length)"vertical"!==this.options.orientation&&(this.tickLabelContainer.style[r]=-h/2+"px"),u=this.tickLabelContainer.offsetHeight;else for(c=0;c<this.tickLabelContainer.childNodes.length;c++)this.tickLabelContainer.childNodes[c].offsetHeight>u&&(u=this.tickLabelContainer.childNodes[c].offsetHeight);"horizontal"===this.options.orientation&&(this.sliderElem.style.marginBottom=u+"px")}for(var c=0;c<this.options.ticks.length;c++){var p=this.options.ticks_positions[c]||this._toPercentage(this.options.ticks[c]);this.options.reversed&&(p=100-p),this.ticks[c].style[this.stylePos]=p+"%",this._removeClass(this.ticks[c],"in-selection"),this.options.range?p>=t[0]&&p<=t[1]&&this._addClass(this.ticks[c],"in-selection"):"after"===this.options.selection&&p>=t[0]?this._addClass(this.ticks[c],"in-selection"):"before"===this.options.selection&&p<=t[0]&&this._addClass(this.ticks[c],"in-selection"),this.tickLabels[c]&&(this.tickLabels[c].style[l]=h+"px","vertical"!==this.options.orientation&&void 0!==this.options.ticks_positions[c]?(this.tickLabels[c].style.position="absolute",this.tickLabels[c].style[this.stylePos]=p+"%",this.tickLabels[c].style[r]=-h/2+"px"):"vertical"===this.options.orientation&&(this.options.rtl?this.tickLabels[c].style.marginRight=this.sliderElem.offsetWidth+"px":this.tickLabels[c].style.marginLeft=this.sliderElem.offsetWidth+"px",this.tickLabelContainer.style[r]=this.sliderElem.offsetWidth/2*-1+"px"))}}if(this.options.range){e=this.options.formatter(this._state.value),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=(t[1]+t[0])/2+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px");var d=this.options.formatter(this._state.value[0]);this._setText(this.tooltipInner_min,d);var g=this.options.formatter(this._state.value[1]);this._setText(this.tooltipInner_max,g),this.tooltip_min.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip_min,"margin-"+this.stylePos,-this.tooltip_min.offsetHeight/2+"px"):this._css(this.tooltip_min,"margin-"+this.stylePos,-this.tooltip_min.offsetWidth/2+"px"),this.tooltip_max.style[this.stylePos]=t[1]+"%","vertical"===this.options.orientation?this._css(this.tooltip_max,"margin-"+this.stylePos,-this.tooltip_max.offsetHeight/2+"px"):this._css(this.tooltip_max,"margin-"+this.stylePos,-this.tooltip_max.offsetWidth/2+"px")}else e=this.options.formatter(this._state.value[0]),this._setText(this.tooltipInner,e),this.tooltip.style[this.stylePos]=t[0]+"%","vertical"===this.options.orientation?this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetHeight/2+"px"):this._css(this.tooltip,"margin-"+this.stylePos,-this.tooltip.offsetWidth/2+"px");if("vertical"===this.options.orientation)this.trackLow.style.top="0",this.trackLow.style.height=Math.min(t[0],t[1])+"%",this.trackSelection.style.top=Math.min(t[0],t[1])+"%",this.trackSelection.style.height=Math.abs(t[0]-t[1])+"%",this.trackHigh.style.bottom="0",this.trackHigh.style.height=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";else{"right"===this.stylePos?this.trackLow.style.right="0":this.trackLow.style.left="0",this.trackLow.style.width=Math.min(t[0],t[1])+"%","right"===this.stylePos?this.trackSelection.style.right=Math.min(t[0],t[1])+"%":this.trackSelection.style.left=Math.min(t[0],t[1])+"%",this.trackSelection.style.width=Math.abs(t[0]-t[1])+"%","right"===this.stylePos?this.trackHigh.style.left="0":this.trackHigh.style.right="0",this.trackHigh.style.width=100-Math.min(t[0],t[1])-Math.abs(t[0]-t[1])+"%";var m=this.tooltip_min.getBoundingClientRect(),f=this.tooltip_max.getBoundingClientRect();"bottom"===this.options.tooltip_position?m.right>f.left?(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top="",this.tooltip_max.style.bottom="22px"):(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top=this.tooltip_min.style.top,this.tooltip_max.style.bottom=""):m.right>f.left?(this._removeClass(this.tooltip_max,"top"),this._addClass(this.tooltip_max,"bottom"),this.tooltip_max.style.top="18px"):(this._removeClass(this.tooltip_max,"bottom"),this._addClass(this.tooltip_max,"top"),this.tooltip_max.style.top=this.tooltip_min.style.top)}},_createHighlightRange:function(t,e){return this._isHighlightRange(t,e)?t>e?{start:e,size:t-e}:{start:t,size:e-t}:null},_isHighlightRange:function(t,e){return 0<=t&&t<=100&&0<=e&&e<=100},_resize:function(t){this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos],this._layout()},_removeProperty:function(t,e){t.style.removeProperty?t.style.removeProperty(e):t.style.removeAttribute(e)},_mousedown:function(t){if(!this._state.enabled)return!1;this._state.offset=this._offset(this.sliderElem),this._state.size=this.sliderElem[this.sizePos];var e=this._getPercentage(t);if(this.options.range){var i=Math.abs(this._state.percentage[0]-e),s=Math.abs(this._state.percentage[1]-e);this._state.dragged=i<s?0:1,this._adjustPercentageForRangeSliders(e)}else this._state.dragged=0;this._state.percentage[this._state.dragged]=e,this._layout(),this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),this.mousemove&&document.removeEventListener("mousemove",this.mousemove,!1),this.mouseup&&document.removeEventListener("mouseup",this.mouseup,!1),this.mousemove=this._mousemove.bind(this),this.mouseup=this._mouseup.bind(this),this.touchCapable&&(document.addEventListener("touchmove",this.mousemove,!1),document.addEventListener("touchend",this.mouseup,!1)),document.addEventListener("mousemove",this.mousemove,!1),document.addEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!0;var o=this._calculateValue();return this._trigger("slideStart",o),this._setDataVal(o),this.setValue(o,!1,!0),t.returnValue=!1,this.options.focus&&this._triggerFocusOnHandle(this._state.dragged),!0},_touchstart:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0];this.touchX=e.pageX,this.touchY=e.pageY}else this._mousedown(t)},_triggerFocusOnHandle:function(t){0===t&&this.handle1.focus(),1===t&&this.handle2.focus()},_keydown:function(t,e){if(!this._state.enabled)return!1;var i;switch(e.keyCode){case 37:case 40:i=-1;break;case 39:case 38:i=1}if(i){if(this.options.natural_arrow_keys){var s="vertical"===this.options.orientation&&!this.options.reversed,o="horizontal"===this.options.orientation&&this.options.reversed;(s||o)&&(i=-i)}var n=this._state.value[t]+i*this.options.step,a=n/this.options.max*100;return this._state.keyCtrl=t,this.options.range&&(this._adjustPercentageForRangeSliders(a),n=[this._state.keyCtrl?this._state.value[0]:n,this._state.keyCtrl?n:this._state.value[1]]),this._trigger("slideStart",n),this._setDataVal(n),this.setValue(n,!0,!0),this._setDataVal(n),this._trigger("slideStop",n),this._layout(),this._pauseEvent(e),delete this._state.keyCtrl,!1}},_pauseEvent:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1},_mousemove:function(t){if(!this._state.enabled)return!1;var e=this._getPercentage(t);this._adjustPercentageForRangeSliders(e),this._state.percentage[this._state.dragged]=e,this._layout();var i=this._calculateValue(!0);return this.setValue(i,!0,!0),!1},_touchmove:function(t){if(void 0!==t.changedTouches){var e=t.changedTouches[0],i=e.pageX-this.touchX,s=e.pageY-this.touchY;this._state.inDrag||("vertical"===this.options.orientation&&i<=5&&i>=-5&&(s>=15||s<=-15)?this._mousedown(t):s<=5&&s>=-5&&(i>=15||i<=-15)&&this._mousedown(t))}},_adjustPercentageForRangeSliders:function(t){if(this.options.range){var e=this._getNumDigitsAfterDecimalPlace(t);e=e?e-1:0;var i=this._applyToFixedAndParseFloat(t,e);0===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[1],e)<i?(this._state.percentage[0]=this._state.percentage[1],this._state.dragged=1):1===this._state.dragged&&this._applyToFixedAndParseFloat(this._state.percentage[0],e)>i?(this._state.percentage[1]=this._state.percentage[0],this._state.dragged=0):0===this._state.keyCtrl&&this._state.value[1]/this.options.max*100<t?(this._state.percentage[0]=this._state.percentage[1],this._state.keyCtrl=1,this.handle2.focus()):1===this._state.keyCtrl&&this._state.value[0]/this.options.max*100>t&&(this._state.percentage[1]=this._state.percentage[0],this._state.keyCtrl=0,this.handle1.focus())}},_mouseup:function(){if(!this._state.enabled)return!1;this.touchCapable&&(document.removeEventListener("touchmove",this.mousemove,!1),document.removeEventListener("touchend",this.mouseup,!1)),document.removeEventListener("mousemove",this.mousemove,!1),document.removeEventListener("mouseup",this.mouseup,!1),this._state.inDrag=!1,!1===this._state.over&&this._hideTooltip();var t=this._calculateValue(!0);return this._layout(),this._setDataVal(t),this._trigger("slideStop",t),!1},_calculateValue:function(t){var e;if(this.options.range?(e=[this.options.min,this.options.max],0!==this._state.percentage[0]&&(e[0]=this._toValue(this._state.percentage[0]),e[0]=this._applyPrecision(e[0])),100!==this._state.percentage[1]&&(e[1]=this._toValue(this._state.percentage[1]),e[1]=this._applyPrecision(e[1]))):(e=this._toValue(this._state.percentage[0]),e=parseFloat(e),e=this._applyPrecision(e)),t){for(var i=[e,1/0],s=0;s<this.options.ticks.length;s++){var o=Math.abs(this.options.ticks[s]-e);o<=i[1]&&(i=[this.options.ticks[s],o])}if(i[1]<=this.options.ticks_snap_bounds)return i[0]}return e},_applyPrecision:function(t){var e=this.options.precision||this._getNumDigitsAfterDecimalPlace(this.options.step);return this._applyToFixedAndParseFloat(t,e)},_getNumDigitsAfterDecimalPlace:function(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0},_applyToFixedAndParseFloat:function(t,e){var i=t.toFixed(e);return parseFloat(i)},_getPercentage:function(t){!this.touchCapable||"touchstart"!==t.type&&"touchmove"!==t.type||(t=t.touches[0]);var e=t[this.mousePos]-this._state.offset[this.stylePos];"right"===this.stylePos&&(e=-e);var i=e/this._state.size*100;return i=Math.round(i/this._state.percentage[2])*this._state.percentage[2],this.options.reversed&&(i=100-i),Math.max(0,Math.min(100,i))},_validateInputValue:function(t){if(isNaN(+t)){if(Array.isArray(t))return this._validateArray(t),t;throw new Error(i(t))}return+t},_validateArray:function(t){for(var e=0;e<t.length;e++){var s=t[e];if("number"!=typeof s)throw new Error(i(s))}},_setDataVal:function(t){this.element.setAttribute("data-value",t),this.element.setAttribute("value",t),this.element.value=t},_trigger:function(e,i){i=i||0===i?i:void 0;var s=this.eventToCallbackMap[e];if(s&&s.length)for(var o=0;o<s.length;o++)(0,s[o])(i);t&&this._triggerJQueryEvent(e,i)},_triggerJQueryEvent:function(t,e){var i={type:t,value:e};this.$element.trigger(i),this.$sliderElem.trigger(i)},_unbindJQueryEventHandlers:function(){this.$element.off(),this.$sliderElem.off()},_setText:function(t,e){void 0!==t.textContent?t.textContent=e:void 0!==t.innerText&&(t.innerText=e)},_removeClass:function(t,e){for(var i=e.split(" "),s=t.className,o=0;o<i.length;o++){var n=i[o],a=new RegExp("(?:\\s|^)"+n+"(?:\\s|$)");s=s.replace(a," ")}t.className=s.trim()},_addClass:function(t,e){for(var i=e.split(" "),s=t.className,o=0;o<i.length;o++){var n=i[o];new RegExp("(?:\\s|^)"+n+"(?:\\s|$)").test(s)||(s+=" "+n)}t.className=s.trim()},_offsetLeft:function(t){return t.getBoundingClientRect().left},_offsetRight:function(t){return t.getBoundingClientRect().right},_offsetTop:function(t){for(var e=t.offsetTop;(t=t.offsetParent)&&!isNaN(t.offsetTop);)e+=t.offsetTop,"BODY"!==t.tagName&&(e-=t.scrollTop);return e},_offset:function(t){return{left:this._offsetLeft(t),right:this._offsetRight(t),top:this._offsetTop(t)}},_css:function(e,i,s){if(t)t.style(e,i,s);else{var o=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(t,e){return e.toUpperCase()}));e.style[o]=s}},_toValue:function(t){return this.options.scale.toValue.apply(this,[t])},_toPercentage:function(t){return this.options.scale.toPercentage.apply(this,[t])},_setTooltipPosition:function(){var t=[this.tooltip,this.tooltip_min,this.tooltip_max];if("vertical"===this.options.orientation){var e,i="left"===(e=this.options.tooltip_position?this.options.tooltip_position:this.options.rtl?"left":"right")?"right":"left";t.forEach(function(t){this._addClass(t,e),t.style[i]="100%"}.bind(this))}else"bottom"===this.options.tooltip_position?t.forEach(function(t){this._addClass(t,"bottom"),t.style.top="22px"}.bind(this)):t.forEach(function(t){this._addClass(t,"top"),t.style.top=-this.tooltip.outerHeight-14+"px"}.bind(this))}},t&&t.fn){var n=void 0;t.fn.slider?(r&&window.console.warn("bootstrap-slider.js - WARNING: $.fn.slider namespace is already bound. Use the $.fn.bootstrapSlider namespace instead."),n="bootstrapSlider"):(t.bridget("slider",e),n="slider"),t.bridget("bootstrapSlider",e),t((function(){t("input[data-provide=slider]")[n]()}))}}(t),e})?s.apply(e,o):s)||(t.exports=n)},4300:function(t,e,i){},4301:function(t,e,i){},4302:function(t,e,i){},4303:function(t,e,i){"use strict";i.d(e,"b",(function(){return E})),i.d(e,"a",(function(){return M}));var s=i(0),o=i.n(s),n=i(5),a=i.n(n),r=i(219),l=i(4293),h=i(1438),u=i(4294),c=i(4306),p=i(4311),d=i(4291),g=i(4290),m=i(4285);function f(){return(f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}const{getScale:y}=h.b;const b={formData:a.a.object.isRequired,mapboxApiKey:a.a.string.isRequired,setControlValue:a.a.func.isRequired,viewport:a.a.object.isRequired,getLayer:a.a.func.isRequired,getPoints:a.a.func.isRequired,payload:a.a.object.isRequired,onAddFilter:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired};class _ extends o.a.PureComponent{constructor(t){super(t),v(this,"containerRef",o.a.createRef()),v(this,"setTooltip",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)}),this.state=this.getStateFromProps(t),this.getLayers=this.getLayers.bind(this),this.onValuesChange=this.onValuesChange.bind(this),this.toggleCategory=this.toggleCategory.bind(this),this.showSingleCategory=this.showSingleCategory.bind(this)}UNSAFE_componentWillReceiveProps(t){t.payload.form_data!==this.state.formData&&this.setState(f({},this.getStateFromProps(t)))}onValuesChange(t){this.setState({values:Array.isArray(t)?t:[t,t+this.state.getStep(t)]})}getStateFromProps(t,e){const i=t.payload.data.features||[],s=i.map(t=>t.__timestamp),o=function(t,e){const i=t.color_picker||{r:0,g:0,b:0,a:1},s=[i.r,i.g,i.b,255*i.a],o=y(t.color_scheme),n={};return e.forEach(e=>{if(null!=e.cat_color&&!n.hasOwnProperty(e.cat_color)){let a;a=t.dimension?Object(p.hexToRGB)(o(e.cat_color),255*i.a):s,n[e.cat_color]={color:a,enabled:!0}}}),n}(t.formData,i);if(e&&t.payload.form_data===e.formData)return f({},e,{categories:o});const n=t.payload.form_data.time_grain_sqla||t.payload.form_data.granularity||"P1D",{start:a,end:r,getStep:l,values:h,disabled:u}=Object(d.a)(s,n),{width:c,height:g,formData:v}=t;let{viewport:b}=t;return v.autozoom&&(b=Object(m.a)(b,{width:c,height:g,points:t.getPoints(i)})),{start:a,end:r,getStep:l,values:h,disabled:u,viewport:b,selected:[],lastClick:0,formData:t.payload.form_data,categories:o}}getLayers(t){const{getLayer:e,payload:i,formData:s,onAddFilter:o}=this.props;let n=i.data.features?[...i.data.features]:[];if(n=this.addColor(n,s),s.js_data_mutator){n=Object(g.a)(s.js_data_mutator)(n)}n=t[0]===t[1]||t[1]===this.end?n.filter(e=>e.__timestamp>=t[0]&&e.__timestamp<=t[1]):n.filter(e=>e.__timestamp>=t[0]&&e.__timestamp<t[1]);const a=this.state.categories;return s.dimension&&(n=n.filter(t=>a[t.cat_color]&&a[t.cat_color].enabled)),[e(s,f({},i,{data:f({},i.data,{features:n})}),o,this.setTooltip)]}addColor(t,e){const i=e.color_picker||{r:0,g:0,b:0,a:1},s=y(e.color_scheme);return t.map(t=>{let o;return e.dimension?(o=Object(p.hexToRGB)(s(t.cat_color),255*i.a),f({},t,{color:o})):t})}toggleCategory(t){const e=this.state.categories[t],i=f({},this.state.categories,{[t]:f({},e,{enabled:!e.enabled})});Object.values(i).every(t=>!t.enabled)&&Object.values(i).forEach(t=>{t.enabled=!0}),this.setState({categories:i})}showSingleCategory(t){const e=f({},this.state.categories);Object.values(e).forEach(t=>{t.enabled=!1}),e[t].enabled=!0,this.setState({categories:e})}render(){return o.a.createElement("div",{style:{position:"relative"}},o.a.createElement(u.a,{ref:this.containerRef,getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,disabled:this.state.disabled,viewport:this.state.viewport,mapboxApiAccessToken:this.props.mapboxApiKey,mapStyle:this.props.formData.mapbox_style,setControlValue:this.props.setControlValue,width:this.props.width,height:this.props.height},o.a.createElement(c.a,{categories:this.state.categories,toggleCategory:this.toggleCategory,showSingleCategory:this.showSingleCategory,position:this.props.formData.legend_position,format:this.props.formData.legend_format})))}}function k(){return(k=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function x(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}_.propTypes=b;const C={formData:a.a.object.isRequired,payload:a.a.object.isRequired,setControlValue:a.a.func.isRequired,viewport:a.a.object.isRequired,onAddFilter:a.a.func,width:a.a.number.isRequired,height:a.a.number.isRequired},w={onAddFilter(){}};function E(t,e){class i extends o.a.PureComponent{constructor(t){super(t),x(this,"containerRef",o.a.createRef()),x(this,"setTooltip",t=>{const{current:e}=this.containerRef;e&&e.setTooltip(t)});const{width:i,height:s,formData:n}=t;let{viewport:a}=t;n.autozoom&&(a=Object(m.a)(a,{width:i,height:s,points:e(t.payload.data.features)})),this.state={viewport:a,layer:this.computeLayer(t)},this.onViewportChange=this.onViewportChange.bind(this)}UNSAFE_componentWillReceiveProps(t){const e=k({},t.formData,{viewport:null}),i=k({},this.props.formData,{viewport:null});Object(r.isEqual)(e,i)&&t.payload===this.props.payload||this.setState({layer:this.computeLayer(t)})}onViewportChange(t){this.setState({viewport:t})}computeLayer(e){const{formData:i,payload:s,onAddFilter:o}=e;return t(i,s,o,this.setTooltip)}render(){const{formData:t,payload:e,setControlValue:i,height:s,width:n}=this.props,{layer:a,viewport:r}=this.state;return o.a.createElement(l.a,{ref:this.containerRef,mapboxApiAccessToken:e.data.mapboxApiKey,viewport:r,layers:[a],mapStyle:t.mapbox_style,setControlValue:i,width:n,height:s,onViewportChange:this.onViewportChange})}}return i.propTypes=C,i.defaultProps=w,i}function M(t,e){function i(i){const{formData:s,payload:n,setControlValue:a,viewport:r,width:l,height:h}=i;return o.a.createElement(_,{formData:s,mapboxApiKey:n.data.mapboxApiKey,setControlValue:a,viewport:r,getLayer:t,payload:n,getPoints:e,width:l,height:h})}return i.propTypes=C,i.defaultProps=w,i}},4306:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(0),o=i.n(s),n=i(5),a=i.n(n),r=i(437);i(4308);const l={categories:a.a.object,toggleCategory:a.a.func,showSingleCategory:a.a.func,format:a.a.string,position:a.a.oneOf([null,"tl","tr","bl","br"])};class h extends o.a.PureComponent{format(t){if(!this.props.format)return t;const e=parseFloat(t);return Object(r.b)(this.props.format,e)}formatCategoryLabel(t){if(!this.props.format)return t;if(t.includes(" - ")){const e=t.split(" - ");return this.format(e[0])+" - "+this.format(e[1])}return this.format(t)}render(){if(0===Object.keys(this.props.categories).length||null===this.props.position)return null;const t=Object.entries(this.props.categories).map(t=>{let[e,i]=t;const s={color:"rgba("+i.color.join(", ")+")"},n=i.enabled?"◼":"◻";return o.a.createElement("li",{key:e},o.a.createElement("a",{href:"#",onClick:()=>this.props.toggleCategory(e),onDoubleClick:()=>this.props.showSingleCategory(e)},o.a.createElement("span",{style:s},n)," ",this.formatCategoryLabel(e)))}),e={position:"absolute",["t"===this.props.position.charAt(0)?"top":"bottom"]:"0px",["r"===this.props.position.charAt(1)?"right":"left"]:"10px"};return o.a.createElement("div",{className:"legend",style:e},o.a.createElement("ul",{className:"categories"},t))}}h.propTypes=l,h.defaultProps={categories:{},toggleCategory:()=>{},showSingleCategory:()=>{},format:null,position:"tr"}},4308:function(t,e,i){},4309:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return o}));var s=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function o(t,e,i){var s=new e(4*t.length);return t.forEach((function(t,e){var o=4*e;s[o]=t[0],s[o+1]=t[1],s[o+2]=t[2],s[o+3]=Number.isFinite(t[3])?t[3]:i})),s}},4337:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var s=i(22),o=i(24),n=i(290),a=i(106),r=i(328),l=i(29),h=i(4324),u=i(4287),c=i(4317),p=function(t){function e(){return Object(s.a)(this,e),Object(n.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(o.a)(e,[{key:"getSubLayers",value:function(){return this.internalState&&this.internalState.subLayers||[]}},{key:"initializeState",value:function(){}},{key:"setState",value:function(t){Object(r.a)(Object(a.a)(e.prototype),"setState",this).call(this,t),this.setLayerNeedsUpdate()}},{key:"getPickingInfo",value:function(t){return t.info}},{key:"renderLayers",value:function(){return null}},{key:"shouldRenderSubLayer",value:function(t,e){var i=this.props._subLayerProps;return e&&e.length||i&&i[t]}},{key:"getSubLayerClass",value:function(t,e){var i=this.props._subLayerProps;return i&&i[t]&&i[t].type||e}},{key:"getSubLayerProps",value:function(t){var e=this.props,i=e.opacity,s=e.pickable,o=e.visible,n=e.parameters,a=e.getPolygonOffset,r=e.highlightedObjectIndex,l=e.autoHighlight,h=e.highlightColor,u=e.coordinateSystem,c=e.coordinateOrigin,p=e.wrapLongitude,d=e.positionFormat,g=e.modelMatrix,m=e._subLayerProps,f={opacity:i,pickable:s,visible:o,parameters:n,getPolygonOffset:a,highlightedObjectIndex:r,autoHighlight:l,highlightColor:h,coordinateSystem:u,coordinateOrigin:c,wrapLongitude:p,positionFormat:d,modelMatrix:g};if(t){var v=m&&m[t.id],y=v&&v.updateTriggers;Object.assign(f,t,v,{id:"".concat(this.props.id,"-").concat(t.id),updateTriggers:Object.assign({all:this.props.updateTriggers.all},t.updateTriggers,y)})}return f}},{key:"_getAttributeManager",value:function(){return null}},{key:"_renderLayers",value:function(){var t=this.internalState.subLayers;t&&!this.needsUpdate()?u.a.log(3,"Composite layer reused subLayers ".concat(this),this.internalState.subLayers)():(t=this.renderLayers(),t=Object(c.b)(t,{filter:Boolean}),this.internalState.subLayers=t,u.a.log(2,"Composite layer rendered new subLayers ".concat(this),t)());var e=!0,i=!1,s=void 0;try{for(var o,n=t[Symbol.iterator]();!(e=(o=n.next()).done);e=!0){o.value.parent=this}}catch(t){i=!0,s=t}finally{try{e||null==n.return||n.return()}finally{if(i)throw s}}}},{key:"isComposite",get:function(){return!0}}]),e}(h.a);p.layerName="CompositeLayer"},4338:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var s=i(10),o=i(13),n=i(22),a=i(24),r=function(t){return t.length},l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;Object(n.a)(this,t),this.sortedBins=this.getSortedBins(e,i),this.maxCount=this.getMaxCount(),this.binMap=this.getBinMap()}return Object(a.a)(t,[{key:"getSortedBins",value:function(t,e){return t.reduce((function(t,i,s){var o=e(i.points);return null!=o&&t.push({i:Number.isFinite(i.index)?i.index:s,value:o,counts:i.points.length}),t}),[]).sort((function(t,e){return t.value-e.value}))}},{key:"getValueRange",value:function(t){var e=Object(o.a)(t,2),i=e[0],s=e[1],n=this.sortedBins.length;if(!n)return[0,0];var a=Math.ceil(i/100*(n-1)),r=Math.floor(s/100*(n-1));return[this.sortedBins[a].value,this.sortedBins[r].value]}},{key:"getMaxCount",value:function(){var t=0;return this.sortedBins.forEach((function(e){return t=t>e.counts?t:e.counts})),t}},{key:"getBinMap",value:function(){return this.sortedBins.reduce((function(t,e){return Object.assign(t,Object(s.a)({},e.i,e))}),{})}}]),t}()},4339:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return n}));var s=i(4287);function o(t,e){return function(i){return function(t,e,i){var o=t[1]-t[0];if(o<=0)return s.a.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];var n=o/e.length,a=Math.floor((i-t[0])/n);return e[Math.max(Math.min(a,e.length-1),0)]}(t,e,i)}}function n(t,e){return function(i){return(i-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}}},4375:function(t,e,i){"use strict";i.d(e,"a",(function(){return C}));var s=i(22),o=i(24),n=i(290),a=i(106),r=i(328),l=i(29),h=i(4363),u=i(4324),c=i(4760),p=i(4380),d=i(4498),g=i(553),m=i(4287),f=i(4711),v=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s.a)(this,e);var i=t.id,o=void 0===i?Object(f.c)("column-geometry"):i,r=y(t),l=r.indices,h=r.attributes;return Object(n.a)(this,Object(a.a)(e).call(this,Object(g.a)({},t,{id:o,indices:l,attributes:h})))}return Object(l.a)(e,t),e}(i(4405).a);function y(t){var e=t.radius,i=t.height,s=void 0===i?1:i,o=t.nradial,n=void 0===o?10:o,a=t.vertices;m.a.assert(!a||a.length>=n);for(var r=n+1,l=3*r,h=2*Math.PI/n,u=new Uint16Array(3*n*2),c=new Float32Array(3*l),p=new Float32Array(3*l),d=0,g=0;g<r;g++)for(var f=g*h,v=a&&a[g%n],y=a&&a[(g+1)%n],b=Math.sin(f),_=Math.cos(f),k=0;k<2;k++)c[d+0]=v?v[0]:_*e,c[d+1]=v?v[1]:b*e,c[d+2]=(.5-k)*s,p[d+0]=v?y[0]-v[0]:_,p[d+1]=v?y[1]-v[1]:b,d+=3;for(var x=0;x<r;x++){var C=Math.floor(x/2)*Math.sign(x%2-.5),w=C*h,E=a&&a[(C+n)%n],M=Math.sin(w),P=Math.cos(w);c[d+0]=E?E[0]:P*e,c[d+1]=E?E[1]:M*e,c[d+2]=s/2,p[d+2]=1,d+=3}for(var S=0,j=0;j<n;j++)u[S++]=2*j+0,u[S++]=2*j+2,u[S++]=2*j+0,u[S++]=2*j+1,u[S++]=2*j+1,u[S++]=2*j+3;return{indices:u,attributes:{POSITION:{size:3,value:c},NORMAL:{size:3,value:p}}}}var b=c.a.fp64LowPart,_=new p.a,k=[0,0,0,255],x={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,fp64:!1,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:function(t){return t.position}},getFillColor:{type:"accessor",value:k},getLineColor:{type:"accessor",value:k},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:_,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},C=function(t){function e(){return Object(s.a)(this,e),Object(n.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(l.a)(e,t),Object(o.a)(e,[{key:"getShaders",value:function(){return{vs:"\n#define SHADER_NAME column-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 normals;\n\nattribute vec3 instancePositions;\nattribute float instanceElevations;\nattribute vec2 instancePositions64xyLow;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute float instanceStrokeWidths;\n\nattribute vec3 instancePickingColors;\nuniform float opacity;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\nuniform bool extruded;\nuniform bool isStroke;\nuniform float coverage;\nuniform float elevationScale;\nuniform float edgeDistance;\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nvarying vec4 vColor;\n\nvoid main(void) {\n  \n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  float elevation = 0.0;\n  float strokeOffsetRatio = 1.0;\n\n  if (extruded) {\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\n  } else if (isStroke) {\n    float widthPixels = clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n      widthMinPixels, widthMaxPixels) / 2.0;\n    strokeOffsetRatio += sign(positions.z) * project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\n  }\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\n  float dotRadius = radius * coverage * shouldRender;\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\n  vec2 centroidPosition64xyLow = instancePositions64xyLow;\n  vec3 pos = vec3(project_size(rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius, 0.);\n\n  vec4 position_commonspace;\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64xyLow, pos, position_commonspace);\n\n  vec3 normals_commonspace = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\n\n  if (extruded && !isStroke) {\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, position_commonspace.xyz, normals_commonspace);\n    vColor = vec4(lightColor, color.a * opacity) / 255.0;\n  } else {\n    vColor = vec4(color.rgb, color.a * opacity) / 255.0;\n  }\n  picking_setPickingColor(instancePickingColors);\n}\n",fs:"#define SHADER_NAME column-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n}\n",modules:[this.use64bitProjection()?"project64":"project32","gouraud-lighting","picking"]}}},{key:"initializeState",value:function(){this.getAttributeManager().addInstanced({instancePositions:{size:3,transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instancePositions64xyLow:{size:2,accessor:"getPosition",update:this.calculateInstancePositions64xyLow},instanceFillColors:{size:4,type:5121,transition:!0,accessor:"getFillColor",defaultValue:k},instanceLineColors:{size:4,type:5121,transition:!0,accessor:"getLineColor",defaultValue:k},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}},{key:"updateState",value:function(t){var i=t.props,s=t.oldProps,o=t.changeFlags;Object(r.a)(Object(a.a)(e.prototype),"updateState",this).call(this,{props:i,oldProps:s,changeFlags:o});var n=i.fp64!==s.fp64;if(n){var l=this.context.gl;this.state.model&&this.state.model.delete(),this.setState({model:this._getModel(l)}),this.getAttributeManager().invalidateAll()}(n||i.diskResolution!==s.diskResolution||i.vertices!==s.vertices)&&this._updateGeometry(i)}},{key:"getGeometry",value:function(t,e){var i=new v({radius:1,height:2,vertices:e,nradial:t}),s=0;if(e)for(var o=0;o<t;o++){var n=e[o];s+=Math.sqrt(n[0]*n[0]+n[1]*n[1])/t}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*s}),i}},{key:"_getModel",value:function(t){return new d.a(t,Object.assign({},this.getShaders(),{id:this.props.id,isInstanced:!0,shaderCache:this.context.shaderCache}))}},{key:"_updateGeometry",value:function(t){var e=t.diskResolution,i=t.vertices,s=this.getGeometry(e,i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3,wireframeVertexCount:s.indices.value.length}),this.state.model.setProps({geometry:s})}},{key:"draw",value:function(t){var e=t.uniforms,i=this.context.viewport,s=this.props,o=s.lineWidthUnits,n=s.lineWidthScale,a=s.lineWidthMinPixels,r=s.lineWidthMaxPixels,l=s.elevationScale,h=s.extruded,u=s.filled,c=s.stroked,p=s.wireframe,d=s.offset,g=s.coverage,m=s.radius,f=s.angle,v=this.state,y=v.model,b=v.fillVertexCount,_=v.wireframeVertexCount,k=v.edgeDistance,x="pixels"===o?i.distanceScales.metersPerPixel[2]:1;y.setUniforms(Object.assign({},e,{radius:m,angle:f/180*Math.PI,offset:d,extruded:h,coverage:g,elevationScale:l,edgeDistance:k,widthScale:n*x,widthMinPixels:a,widthMaxPixels:r})),h&&p&&(y.setProps({isIndexed:!0}),y.setVertexCount(_).setDrawMode(1).setUniforms({isStroke:!0}).draw()),u&&(y.setProps({isIndexed:!1}),y.setVertexCount(b).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!h&&c&&(y.setProps({isIndexed:!1}),y.setVertexCount(2*b/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}},{key:"calculateInstancePositions64xyLow",value:function(t,e){var i=e.startRow,s=e.endRow,o=this.use64bitPositions();if(t.constant=!o,o){var n=this.props,a=n.data,r=n.getPosition,l=t.value,u=i*t.size,c=Object(h.a)(a,i,s),p=c.iterable,d=c.objectInfo,g=!0,m=!1,f=void 0;try{for(var v,y=p[Symbol.iterator]();!(g=(v=y.next()).done);g=!0){var _=v.value;d.index++;var k=r(_,d);l[u++]=b(k[0]),l[u++]=b(k[1])}}catch(t){m=!0,f=t}finally{try{g||null==y.return||y.return()}finally{if(m)throw f}}}else t.value=new Float32Array(2)}}]),e}(u.a);C.layerName="ColumnLayer",C.defaultProps=x},4380:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var s=i(22),o=i(290),n=i(106),a=i(21),r=i(29),l={ambient:.35,diffuse:.6,shininess:32,specularColor:[30,30,30]},h=function(t){function e(t){var i;return Object(s.a)(this,e),i=Object(o.a)(this,Object(n.a)(e).call(this,t)),t=Object.assign({},l,t),Object.assign(Object(a.a)(i),t),i}return Object(r.a)(e,t),e}((function t(){Object(s.a)(this,t)}))},4505:function(t,e,i){"use strict";i.r(e),i.d(e,"getLayer",(function(){return N}));var s=i(22),o=i(24),n=i(290),a=i(106),r=i(29),l=i(4380),h=i(4287),u=i(4337),c=i(4375),p=i(4338),d=i(4309),g=i(4339),m=i(4292),f=Math.PI/3,v=[0,f,2*f,3*f,4*f,5*f];function y(t){return t[0]}function b(t){return t[1]}var _=i(4363);function k(){}var x=new l.a,C={colorDomain:null,colorRange:d.b,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:function(t){return 1}},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},onSetColorDomain:k,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:function(t){return 1}},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},onSetElevationDomain:k,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:function(t,e){var i=t.data,s=t.radius,o=t.getPosition,n=function(t,e){var i=e.getDistanceScales().pixelsPerMeter;return t*i[0]}(s,e),a=[],r=Object(_.a)(i),l=r.iterable,h=r.objectInfo,u=!0,c=!1,p=void 0;try{for(var d,g=l[Symbol.iterator]();!(u=(d=g.next()).done);u=!0){var m=d.value;h.index++,a.push(Object.assign({screenCoord:e.projectFlat(o(m,h))},m))}}catch(t){c=!0,p=t}finally{try{u||null==g.return||g.return()}finally{if(c)throw p}}return{hexagons:function(){var t,e,i,s=0,o=0,n=1,a=1,r=y,l=b;function h(t){var s,o={},n=[],a=t.length;for(s=0;s<a;++s)if(!isNaN(u=+r.call(null,h=t[s],s,t))&&!isNaN(c=+l.call(null,h,s,t))){var h,u,c,p=Math.round(c/=i),d=Math.round(u=u/e-(1&p)/2),g=c-p;if(3*Math.abs(g)>1){var m=u-d,f=d+(u<d?-1:1)/2,v=p+(c<p?-1:1),y=u-f,b=c-v;m*m+g*g>y*y+b*b&&(d=f+(1&p?1:-1)/2,p=v)}var _=d+"-"+p,k=o[_];k?k.push(h):(n.push(k=o[_]=[h]),k.x=(d+(1&p)/2)*e,k.y=p*i)}return n}function u(t){var e=0,i=0;return v.map((function(s){var o=Math.sin(s)*t,n=-Math.cos(s)*t,a=o-e,r=n-i;return e=o,i=n,[a,r]}))}return h.hexagon=function(e){return"m"+u(null==e?t:+e).join("l")+"z"},h.centers=function(){for(var r=[],l=Math.round(o/i),h=Math.round(s/e),u=l*i;u<a+t;u+=i,++l)for(var c=h*e+(1&l)*e/2;c<n+e/2;c+=e)r.push([c,u]);return r},h.mesh=function(){var e=u(t).slice(0,4).join("l");return h.centers().map((function(t){return"M"+t+"m"+e})).join("")},h.x=function(t){return arguments.length?(r=t,h):r},h.y=function(t){return arguments.length?(l=t,h):l},h.radius=function(s){return arguments.length?(e=2*(t=+s)*Math.sin(f),i=1.5*t,h):t},h.size=function(t){return arguments.length?(s=o=0,n=+t[0],a=+t[1],h):[n-s,a-o]},h.extent=function(t){return arguments.length?(s=+t[0][0],o=+t[0][1],n=+t[1][0],a=+t[1][1],h):[[s,o],[n,a]]},h.radius(1)}().radius(n).x((function(t){return t.screenCoord[0]})).y((function(t){return t.screenCoord[1]}))(a).map((function(t,i){return{position:e.unprojectFlat([t.x,t.y]),points:t,index:i}}))}},getPosition:{type:"accessor",value:function(t){return t.position}},fp64:!1,material:x},w=["getColorValue","colorAggregation","getColorWeight"],E=["getElevationValue","elevationAggregation","getElevationWeight"],M=function(t){function e(){return Object(s.a)(this,e),Object(n.a)(this,Object(a.a)(e).apply(this,arguments))}return Object(r.a)(e,t),Object(o.a)(e,[{key:"initializeState",value:function(){this.state={hexagons:[],sortedColorBins:null,sortedElevationBins:null,colorValueDomain:null,elevationValueDomain:null,colorScaleFunc:k,elevationScaleFunc:k,dimensionUpdaters:this.getDimensionUpdaters()}}},{key:"updateState",value:function(t){var e=this,i=t.oldProps,s=t.props,o=t.changeFlags;this.updateGetValueFuncs(i,s);var n=this.getDimensionChanges(i,s);o.dataChanged||this.needsReProjectPoints(i,s)?this.getHexagons():n&&n.forEach((function(t){return"function"==typeof t&&t.apply(e)}))}},{key:"colorElevationPropsChanged",value:function(t,e){for(var i=!1,s=!1,o=0;o<w.length;o++){var n=w[o];t[n]!==e[n]&&(i=!0)}for(var a=0;a<E.length;a++){var r=E[a];t[r]!==e[r]&&(s=!0)}return{colorChanged:i,elevationChanged:s}}},{key:"updateGetValueFuncs",value:function(t,e){var i=e.getColorValue,s=e.getElevationValue,o=this.props,n=o.colorAggregation,a=o.getColorWeight,r=o.elevationAggregation,l=o.getElevationWeight,h=this.colorElevationPropsChanged(t,e),u=h.colorChanged,c=h.elevationChanged;u&&null===i&&(i=Object(m.b)(n,a)),c&&null===s&&(s=Object(m.b)(r,l)),i&&this.setState({getColorValue:i}),s&&this.setState({getElevationValue:s})}},{key:"needsReProjectPoints",value:function(t,e){return t.radius!==e.radius||t.hexagonAggregator!==e.hexagonAggregator}},{key:"getDimensionUpdaters",value:function(){return{getFillColor:[{id:"value",triggers:["getColorValue","getColorWeight","colorAggregation"],updater:this.getSortedColorBins},{id:"domain",triggers:["lowerPercentile","upperPercentile"],updater:this.getColorValueDomain},{id:"scaleFunc",triggers:["colorDomain","colorRange"],updater:this.getColorScale}],getElevation:[{id:"value",triggers:["getElevationValue","getElevationWeight","elevationAggregation"],updater:this.getSortedElevationBins},{id:"domain",triggers:["elevationLowerPercentile","elevationUpperPercentile"],updater:this.getElevationValueDomain},{id:"scaleFunc",triggers:["elevationDomain","elevationRange"],updater:this.getElevationScale}]}}},{key:"getDimensionChanges",value:function(t,e){var i=this.state.dimensionUpdaters,s=[];for(var o in i){var n=i[o].find((function(i){return i.triggers.some((function(i){return t[i]!==e[i]}))}));n&&s.push(n.updater)}return s.length?s:null}},{key:"getHexagons",value:function(){var t=this.props.hexagonAggregator,e=this.context.viewport,i=t(this.props,e),s=i.hexagons,o=i.hexagonVertices;this.updateRadiusAngle(o),this.setState({hexagons:s}),this.getSortedBins()}},{key:"getPickingInfo",value:function(t){var e=t.info,i=this.state,s=i.sortedColorBins,o=i.sortedElevationBins,n=null;if(e.picked&&e.index>-1){var a=this.state.hexagons[e.index],r=s.binMap[a.index]&&s.binMap[a.index].value,l=o.binMap[a.index]&&o.binMap[a.index].value;n=Object.assign({colorValue:r,elevationValue:l},a)}return Object.assign(e,{picked:Boolean(n),object:n})}},{key:"getUpdateTriggers",value:function(){var t=this,e=this.state.dimensionUpdaters,i={},s=function(s){i[s]={};var o=!0,n=!1,a=void 0;try{for(var r,l=e[s][Symbol.iterator]();!(o=(r=l.next()).done);o=!0){r.value.triggers.forEach((function(e){i[s][e]=t.props[e]}))}}catch(t){n=!0,a=t}finally{try{o||null==l.return||l.return()}finally{if(n)throw a}}};for(var o in e)s(o);return i}},{key:"updateRadiusAngle",value:function(t){var e=this.props.radius,i=90;if(Array.isArray(t)){t.length<6&&h.a.error("HexagonCellLayer: hexagonVertices needs to be an array of 6 points")();var s=t[0],o=t[3],n=this.context.viewport.getDistanceScales().pixelsPerMeter,a=this.projectFlat(s),r=this.projectFlat(o),l=a[0]-r[0],u=a[1]-r[1],c=Math.sqrt(l*l+u*u);i=Math.acos(l/c)*-Math.sign(u)/Math.PI*180+90,e=c/2/n[0]}this.setState({angle:i,radius:e})}},{key:"getValueDomain",value:function(){this.getColorValueDomain(),this.getElevationValueDomain()}},{key:"getSortedBins",value:function(){this.getSortedColorBins(),this.getSortedElevationBins()}},{key:"getSortedColorBins",value:function(){var t=this.state.getColorValue,e=new p.a(this.state.hexagons||[],t);this.setState({sortedColorBins:e}),this.getColorValueDomain()}},{key:"getSortedElevationBins",value:function(){var t=this.state.getElevationValue,e=new p.a(this.state.hexagons||[],t);this.setState({sortedElevationBins:e}),this.getElevationValueDomain()}},{key:"getColorValueDomain",value:function(){var t=this.props,e=t.lowerPercentile,i=t.upperPercentile,s=t.onSetColorDomain;e>i&&h.a.warn("HexagonLayer: lowerPercentile is bigger than upperPercentile")(),this.state.colorValueDomain=this.state.sortedColorBins.getValueRange([e,i]),"function"==typeof s&&s(this.state.colorValueDomain),this.getColorScale()}},{key:"getElevationValueDomain",value:function(){var t=this.props,e=t.elevationLowerPercentile,i=t.elevationUpperPercentile,s=t.onSetElevationDomain;this.state.elevationValueDomain=this.state.sortedElevationBins.getValueRange([e,i]),"function"==typeof s&&s(this.state.elevationValueDomain),this.getElevationScale()}},{key:"getColorScale",value:function(){var t=this.props.colorRange,e=this.props.colorDomain||this.state.colorValueDomain;this.state.colorScaleFunc=Object(g.b)(e,t)}},{key:"getElevationScale",value:function(){var t=this.props.elevationRange,e=this.props.elevationDomain||this.state.elevationValueDomain;this.state.elevationScaleFunc=Object(g.a)(e,t)}},{key:"_onGetSublayerColor",value:function(t){var e=this.state,i=e.sortedColorBins,s=e.colorScaleFunc,o=e.colorValueDomain,n=i.binMap[t.index]&&i.binMap[t.index].value,a=this.props.colorDomain||o,r=n>=a[0]&&n<=a[a.length-1]?s(n):[0,0,0,0];return r[3]=Number.isFinite(r[3])?r[3]:255,r}},{key:"_onGetSublayerElevation",value:function(t){var e=this.state,i=e.sortedElevationBins,s=e.elevationScaleFunc,o=e.elevationValueDomain,n=i.binMap[t.index]&&i.binMap[t.index].value,a=this.props.elevationDomain||o;return n>=a[0]&&n<=a[a.length-1]?s(n):-1}},{key:"renderLayers",value:function(){var t=this.props,e=t.elevationScale,i=t.extruded,s=t.coverage,o=t.material,n=t.fp64,a=t.transitions,r=this.state,l=r.angle,h=r.radius;return new(this.getSubLayerClass("hexagon-cell",c.a))({fp64:n,radius:h,diskResolution:6,elevationScale:e,angle:l,extruded:i,coverage:s,material:o,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:a&&{getFillColor:a.getColorValue||a.getColorWeight,getElevation:a.getElevationValue||a.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:this.getUpdateTriggers()}),{data:this.state.hexagons})}}]),e}(u.a);M.layerName="HexagonLayer",M.defaultProps=C;var P=i(0),S=i.n(P),j=i(18),L=i(4296),O=i(4290),A=i(4303),T=i(4297);function V(){return(V=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t}).apply(this,arguments)}function D(t){return S.a.createElement("div",{className:"deckgl-tooltip"},S.a.createElement(T.a,{label:Object(j.e)("Centroid (Longitude and Latitude)")+": ",value:"("+t.coordinate[0]+", "+t.coordinate[1]+")"}),S.a.createElement(T.a,{label:Object(j.e)("Height")+": ",value:""+t.object.elevationValue}))}function N(t,e,i,s){const o=t,n=o.color_picker;let a=e.data.features.map(t=>V({},t,{color:[n.r,n.g,n.b,255*n.a]}));if(o.js_data_mutator){a=Object(O.a)(o.js_data_mutator)(a)}const r=Object(L.b)(o.js_agg_function,t=>t.weight);return new M(V({id:"hex-layer-"+o.slice_id,data:a,pickable:!0,radius:o.grid_size,minColor:[0,0,0,0],extruded:o.extruded,maxColor:[n.r,n.g,n.b,255*n.a],outline:!1,getElevationValue:r,getColorValue:r},Object(L.a)(o,s,D)))}e.default=Object(A.b)(N,(function(t){return t.map(t=>t.position)}))}}]);